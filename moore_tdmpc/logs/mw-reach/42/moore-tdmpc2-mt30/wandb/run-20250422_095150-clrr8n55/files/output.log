[34m[1mLogs will be synced with wandb.
Config(env_type='MooreMultiTask', n_contexts=1, obs_dim=39, action_dim=4, hidden_dim=256, n_experts=4, moore_temperature=1.0, use_softmax=True, use_checkpoint=True, use_mixed_precision=True, gamma=0.99, stddev=0.1, actor_updates=1, use_ema=True, ensemble_size=5, update_freq=2, seed=42, device=device(type='cuda', index=0), task='mw-reach', obs='state', multitask=False, steps=10000, batch_size=256, reward_coef=0.1, value_coef=0.1, consistency_coef=20, rho=0.5, lr=0.0003, enc_lr_scale=0.3, grad_clip_norm=20, tau=0.01, discount_denom=5, discount_min=0.95, discount_max=0.995, buffer_size=100000, exp_name='moore-tdmpc2-mt30', eval_freq=50000, eval_episodes=10, moore={'n_experts': 4, 'temperature': 1.0, 'use_softmax': True, 'debug_task_emb': False}, mpc=True, iterations=6, num_samples=512, num_elites=64, num_pi_trajs=24, horizon=3, min_std=0.05, max_std=2, temperature=0.5, log_std_min=-10, log_std_max=2, entropy_coef=0.0001, model_size=5, num_enc_layers=2, enc_dim=256, num_channels=32, mlp_dim=512, latent_dim=512, task_dim=0, num_q=5, dropout=0.01, simnorm_dim=8, num_bins=101, vmin=-10, vmax=10, wandb_project='moore-tdmpc2', wandb_entity='OA-MBRL', wandb_silent=False, enable_wandb=True, save_csv=True, save_video=False, save_agent=True, compile=False, work_dir=PosixPath('/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/logs/mw-reach/42/moore-tdmpc2-mt30'), task_title='Mw Reach', tasks=['mw-reach'], obs_shape={'state': (39,)}, episode_length=100, obs_shapes='???', episode_lengths='???', seed_steps=1000, bin_size=0.2, data_dir='/media/levi/Singe4linux/Moore-TDMPC/TDMPC2/data/mt30')
Architecture: TD-MPC2 Moore World Model
Task Encoder: MooreTaskEncoder(obs_dim=39, latent_dim=512, hidden_dim=256, n_experts=4, temperature=1.0, use_softmax=True)
Dynamics: MoEDynamicsModel(latent_dim=512, action_dim=4, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, use_mixed_precision=True)
Reward: MoERewardModel(latent_dim=512, action_dim=4, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, reward_dim=101, top_k=1)
Policy prior: Sequential(
  (0): Linear(in_features=512, out_features=256, bias=True)
  (1): ReLU()
  (2): Linear(in_features=256, out_features=256, bias=True)
  (3): ReLU()
  (4): Linear(in_features=256, out_features=8, bias=True)
)
Q-functions: Ensemble(n_models=5)
Learnable parameters: 5,217,221
[32m[1mÂºÄÂßãMoore-TDMPC2ËÆ≠ÁªÉ...
[36mPROFILER STATUS: Enabled=True, Functions=3, Total Calls=7
[32mOnlineTrainer: Starting training loop with profiling enabled
[36mPROFILER STATUS: Enabled=True, Functions=3, Total Calls=7
[36mPROFILER: forward executed in 1.08ms (call 3)
 [32meval[39m    [34mE:[39m 0            [34mI:[39m 0            [34mR:[39m 242.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 0            [34mI:[39m 100          [34mR:[39m 364.9        [34mS:[39m 0.0          [34mT:[39m 0:00:01
Buffer capacity: 10,000
Storage required: 0.00 GB
Using CUDA:0 memory for storage.
 [34mtrain[39m   [34mE:[39m 1            [34mI:[39m 200          [34mR:[39m 315.7        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 2            [34mI:[39m 300          [34mR:[39m 605.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 3            [34mI:[39m 400          [34mR:[39m 347.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 4            [34mI:[39m 500          [34mR:[39m 319.2        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 5            [34mI:[39m 600          [34mR:[39m 274.8        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 6            [34mI:[39m 700          [34mR:[39m 276.7        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 7            [34mI:[39m 800          [34mR:[39m 190.2        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 8            [34mI:[39m 900          [34mR:[39m 547.0        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 9            [34mI:[39m 1,000        [34mR:[39m 361.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
Pretraining agent on seed data...
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:   10.04 ms
[36mPROFILER: _td_target executed in 0.07ms (call 1)
[TIME] td_target:    8.79 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:  695.65 ms
[TIME] compute Q:   10.57 ms
[TIME] reward loss:   10.31 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   23.22 ms
[TIME] grad clipping:   22.68 ms
[TIME] optim.step:    0.11 ms
[TIME] _update total:  782.61 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         0.65%       4.970ms        86.45%     665.307ms      55.442ms       0.000us         0.00%      22.090ms       1.841ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      14.854ms        97.45%      14.854ms       7.427ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.275ms        67.41%      10.275ms      10.275ms             1
                             MooreExpertsModule_forward         0.03%     195.986us         1.95%      15.015ms       7.508ms       0.000us         0.00%       8.997ms       4.498ms             2
                                              aten::bmm         1.37%      10.557ms         9.04%      69.581ms       1.243ms       6.774ms        44.44%       6.794ms     121.316us            56
                                            aten::copy_         0.07%     535.940us         0.91%       7.013ms      43.832us       4.622ms        30.32%       4.622ms      28.886us           160
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.427ms        29.04%       4.427ms     340.511us            13
                                           aten::repeat         0.91%       7.028ms         2.10%      16.176ms     673.989us       0.000us         0.00%       4.391ms     182.948us            24
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.153ms        27.25%       4.153ms       2.077ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.027ms        19.86%       3.027ms       1.009ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 769.585ms
Self CUDA time total: 15.244ms
----------------------------------------------
[36mPROFILER: _update executed in 1357.89ms (call 1)
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:   10.90 ms
[36mPROFILER: _td_target executed in 0.07ms (call 2)
[TIME] td_target:    5.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.30 ms
[TIME] compute Q:   10.56 ms
[TIME] reward loss:    3.86 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.12 ms
[TIME] grad clipping:    1.44 ms
[TIME] optim.step:    0.05 ms
[TIME] _update total:   55.93 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.98%       3.701ms        73.30%      38.888ms       3.241ms       0.000us         0.00%      24.744ms       2.062ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      12.688ms        76.53%      12.688ms       6.344ms             2
                             MooreExpertsModule_forward         0.36%     189.187us        24.35%      12.920ms       6.460ms       0.000us         0.00%      10.320ms       5.160ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.257ms        61.87%      10.257ms      10.257ms             1
                                              aten::bmm         0.34%     182.094us        20.29%      10.762ms     672.636us       7.967ms        48.06%       7.986ms     499.131us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       5.333ms        32.17%       5.333ms       2.666ms             2
                                            aten::copy_         0.57%     303.169us        12.95%       6.871ms      56.316us       4.765ms        28.74%       4.765ms      39.056us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.571ms        27.57%       4.571ms     351.612us            13
                                           aten::repeat         0.05%      24.332us         8.97%       4.758ms       1.190ms       0.000us         0.00%       4.537ms       1.134ms             4
                             Torch-Compiled Region: 3/0         0.15%      79.003us        10.63%       5.641ms       1.880ms       0.000us         0.00%       2.822ms     940.703us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.052ms
Self CUDA time total: 16.578ms
----------------------------------------------
[36mPROFILER: _update executed in 266.28ms (call 2)
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.16 ms
[36mPROFILER: _td_target executed in 0.06ms (call 3)
[TIME] td_target:    6.87 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.25 ms
[TIME] compute Q:    7.67 ms
[TIME] reward loss:    4.48 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.53 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    0.05 ms
[TIME] _update total:   54.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.23%       3.247ms        71.70%      37.356ms       3.113ms       0.000us         0.00%      21.602ms       1.800ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.871ms        79.09%      11.871ms       5.936ms             2
                             MooreExpertsModule_forward         0.30%     154.769us        23.05%      12.011ms       6.006ms       0.000us         0.00%       8.742ms       4.371ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.396ms        49.28%       7.396ms       7.396ms             1
                                              aten::bmm         0.33%     174.400us        16.29%       8.487ms     530.459us       6.729ms        44.83%       6.748ms     421.764us            16
                                            aten::copy_         0.58%     302.658us        11.31%       5.893ms      48.303us       4.421ms        29.45%       4.421ms      36.236us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.228ms        28.17%       4.228ms     325.202us            13
                                           aten::repeat         0.04%      20.991us         8.82%       4.594ms       1.148ms       0.000us         0.00%       4.194ms       1.048ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.136ms        27.55%       4.136ms       2.068ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.344ms        22.28%       3.344ms       1.115ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.100ms
Self CUDA time total: 15.010ms
----------------------------------------------
[36mPROFILER: _update executed in 254.85ms (call 3)
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.78 ms
[TIME] td_target:    7.66 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.06 ms
[TIME] compute Q:    8.36 ms
[TIME] reward loss:    3.64 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.24 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:   26.64 ms
[TIME] _update total:   80.28 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                               Optimizer.step#Adam.step         0.00%       0.000us         0.00%       0.000us       0.000us      26.259ms       170.78%      26.259ms      26.259ms             1
                                     CheckpointFunction         4.12%       3.194ms        46.12%      35.797ms       2.983ms       0.000us         0.00%      21.783ms       1.815ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.745ms        76.38%      11.745ms       5.872ms             2
                             MooreExpertsModule_forward         0.18%     138.736us        15.30%      11.872ms       5.936ms       0.000us         0.00%       8.837ms       4.419ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.098ms        52.67%       8.098ms       8.098ms             1
                                              aten::bmm         0.21%     164.537us         9.31%       7.227ms     451.662us       6.831ms        44.43%       6.851ms     428.176us            16
                                            aten::copy_         0.38%     296.652us         9.05%       7.027ms      57.595us       4.415ms        28.71%       4.415ms      36.187us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.220ms        27.45%       4.220ms     324.651us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.187ms        27.23%       4.187ms       2.094ms             2
                                           aten::repeat         0.03%      21.037us         5.49%       4.263ms       1.066ms       0.000us         0.00%       4.165ms       1.041ms             4
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 77.610ms
Self CUDA time total: 15.376ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.91 ms
[TIME] td_target:    7.67 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.41 ms
[TIME] compute Q:    8.94 ms
[TIME] reward loss:    3.71 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.28 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   54.84 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.94%       2.567ms        67.39%      35.042ms       2.920ms       0.000us         0.00%      21.667ms       1.806ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.685ms        76.58%      11.685ms       5.843ms             2
                             MooreExpertsModule_forward         0.28%     147.227us        22.72%      11.816ms       5.908ms       0.000us         0.00%       8.795ms       4.398ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.649ms        56.68%       8.649ms       8.649ms             1
                                              aten::bmm         0.33%     169.464us        16.18%       8.412ms     525.732us       6.831ms        44.77%       6.851ms     428.202us            16
                                            aten::copy_         0.60%     312.320us        12.50%       6.499ms      53.272us       4.377ms        28.68%       4.377ms      35.877us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.197ms        27.50%       4.197ms       2.099ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.179ms        27.39%       4.179ms     321.470us            13
                                           aten::repeat         0.05%      23.599us         8.16%       4.246ms       1.061ms       0.000us         0.00%       4.146ms       1.036ms             4
                             Torch-Compiled Region: 3/0         0.13%      67.588us         9.35%       4.860ms       1.620ms       0.000us         0.00%       2.801ms     933.620us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.001ms
Self CUDA time total: 15.259ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.92 ms
[TIME] td_target:    7.65 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.54 ms
[TIME] compute Q:    8.29 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   12.99 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   53.88 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.87%       2.502ms        67.83%      34.813ms       2.901ms       0.000us         0.00%      21.854ms       1.821ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.214ms        73.07%      11.214ms       5.607ms             2
                             MooreExpertsModule_forward         0.26%     135.333us        22.09%      11.336ms       5.668ms       0.000us         0.00%       8.896ms       4.448ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.031ms        52.33%       8.031ms       8.031ms             1
                                              aten::bmm         0.32%     163.409us        16.51%       8.473ms     529.544us       6.751ms        43.99%       6.770ms     423.134us            16
                                            aten::copy_         0.58%     298.819us        12.85%       6.597ms      54.075us       4.560ms        29.71%       4.560ms      37.378us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.365ms        28.44%       4.365ms     335.757us            13
                                           aten::repeat         0.04%      20.007us         8.62%       4.424ms       1.106ms       0.000us         0.00%       4.331ms       1.083ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.129ms        26.91%       4.129ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.13%      66.978us        10.19%       5.230ms       1.743ms       0.000us         0.00%       2.786ms     928.531us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.325ms
Self CUDA time total: 15.346ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.75 ms
[TIME] td_target:    4.88 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   14.07 ms
[TIME] compute Q:    7.64 ms
[TIME] reward loss:    4.49 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.37 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   55.01 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.79%       2.515ms        67.10%      35.241ms       2.937ms       0.000us         0.00%      21.560ms       1.797ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.038ms        66.03%      10.038ms       5.019ms             2
                             MooreExpertsModule_forward         0.27%     141.552us        19.36%      10.167ms       5.083ms       0.000us         0.00%       8.748ms       4.374ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.386ms        48.59%       7.386ms       7.386ms             1
                                              aten::bmm         0.32%     168.363us        14.03%       7.370ms     460.645us       6.776ms        44.57%       6.795ms     424.670us            16
                                            aten::copy_         0.57%     297.204us        11.09%       5.822ms      47.725us       4.372ms        28.76%       4.372ms      35.836us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.179ms        27.49%       4.179ms     321.500us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.153ms        27.32%       4.153ms       2.076ms             2
                                           aten::repeat         0.04%      19.979us         8.69%       4.565ms       1.141ms       0.000us         0.00%       4.146ms       1.037ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.464ms        22.79%       3.464ms       1.155ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.524ms
Self CUDA time total: 15.202ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.26 ms
[TIME] td_target:    5.28 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.17 ms
[TIME] compute Q:    8.63 ms
[TIME] reward loss:    3.63 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.86 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   51.70 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.12%       2.505ms        65.21%      31.924ms       2.660ms       0.000us         0.00%      21.980ms       1.832ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.673ms        62.75%       9.673ms       4.837ms             2
                             MooreExpertsModule_forward         0.29%     144.316us        20.03%       9.804ms       4.902ms       0.000us         0.00%       8.955ms       4.478ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.374ms        54.32%       8.374ms       8.374ms             1
                                              aten::bmm         0.33%     162.357us        15.82%       7.746ms     484.099us       6.759ms        43.84%       6.777ms     423.570us            16
                                            aten::copy_         0.61%     296.907us        11.67%       5.712ms      46.817us       4.602ms        29.85%       4.602ms      37.719us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.407ms        28.59%       4.407ms     339.029us            13
                                           aten::repeat         0.05%      22.627us         9.14%       4.473ms       1.118ms       0.000us         0.00%       4.374ms       1.093ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.132ms        26.81%       4.132ms       2.066ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.957us        12.03%       5.888ms       1.963ms       0.000us         0.00%       2.791ms     930.493us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.957ms
Self CUDA time total: 15.415ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.85 ms
[TIME] td_target:    6.01 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.39 ms
[TIME] compute Q:    8.46 ms
[TIME] reward loss:    3.55 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.94 ms
[TIME] grad clipping:    0.73 ms
[TIME] optim.step:    1.02 ms
[TIME] _update total:   49.98 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.482ms        67.42%      32.024ms       2.669ms       0.000us         0.00%      21.694ms       1.808ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.306ms        67.43%      10.306ms       5.153ms             2
                             MooreExpertsModule_forward         0.29%     136.852us        21.96%      10.431ms       5.216ms       0.000us         0.00%       8.786ms       4.393ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.197ms        53.63%       8.197ms       8.197ms             1
                                              aten::bmm         0.35%     166.734us        15.89%       7.548ms     471.766us       6.786ms        44.40%       6.805ms     425.304us            16
                                            aten::copy_         0.63%     299.941us        14.17%       6.732ms      55.184us       4.407ms        28.83%       4.407ms      36.120us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.212ms        27.56%       4.212ms     323.972us            13
                                           aten::repeat         0.04%      21.171us         9.00%       4.273ms       1.068ms       0.000us         0.00%       4.177ms       1.044ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.156ms        27.19%       4.156ms       2.078ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.210us        10.72%       5.094ms       1.698ms       0.000us         0.00%       2.845ms     948.415us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.499ms
Self CUDA time total: 15.284ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.34 ms
[TIME] td_target:    5.15 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.15 ms
[TIME] compute Q:    7.68 ms
[TIME] reward loss:    4.40 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.21 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.81 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.19%       2.505ms        70.49%      34.019ms       2.835ms       0.000us         0.00%      23.578ms       1.965ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.675ms        65.74%      10.675ms       5.338ms             2
                             MooreExpertsModule_forward         0.31%     150.299us        22.40%      10.809ms       5.404ms       0.000us         0.00%       9.715ms       4.857ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.434ms        45.78%       7.434ms       7.434ms             1
                                              aten::bmm         0.34%     163.404us        18.42%       8.890ms     555.606us       7.294ms        44.92%       7.313ms     457.085us            16
                                            aten::copy_         0.61%     295.839us        14.24%       6.870ms      56.312us       4.863ms        29.95%       4.863ms      39.859us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.668ms        28.74%       4.668ms     359.044us            13
                                           aten::repeat         0.04%      20.206us         9.79%       4.726ms       1.181ms       0.000us         0.00%       4.634ms       1.158ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.631ms        28.52%       4.631ms       2.316ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.388ms        20.86%       3.388ms       1.129ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.261ms
Self CUDA time total: 16.238ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.39 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.33 ms
[TIME] compute Q:    7.79 ms
[TIME] reward loss:    3.60 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.52 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   51.45 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.02%       2.456ms        67.62%      33.079ms       2.757ms       0.000us         0.00%      23.651ms       1.971ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.790ms        66.50%      10.790ms       5.395ms             2
                             MooreExpertsModule_forward         0.29%     140.167us        22.33%      10.923ms       5.462ms       0.000us         0.00%       9.797ms       4.899ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.518ms        46.33%       7.518ms       7.518ms             1
                                              aten::bmm         0.32%     158.027us        16.32%       7.982ms     498.892us       7.400ms        45.61%       7.420ms     463.759us            16
                                            aten::copy_         0.63%     307.979us        13.51%       6.609ms      54.170us       4.806ms        29.62%       4.806ms      39.397us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.767ms        29.38%       4.767ms       2.384ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.610ms        28.41%       4.610ms     354.610us            13
                                           aten::repeat         0.05%      22.694us         9.56%       4.676ms       1.169ms       0.000us         0.00%       4.577ms       1.144ms             4
                             Torch-Compiled Region: 3/0         0.13%      63.973us        10.50%       5.134ms       1.711ms       0.000us         0.00%       2.778ms     926.036us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.922ms
Self CUDA time total: 16.225ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.85 ms
[TIME] td_target:    4.81 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.03 ms
[TIME] compute Q:    8.37 ms
[TIME] reward loss:    3.60 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.01 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   49.47 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.25%       2.466ms        64.66%      30.353ms       2.529ms       0.000us         0.00%      21.643ms       1.804ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.130ms        59.87%       9.130ms       4.565ms             2
                             MooreExpertsModule_forward         0.28%     132.849us        19.71%       9.253ms       4.627ms       0.000us         0.00%       8.769ms       4.384ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.114ms        53.21%       8.114ms       8.114ms             1
                                              aten::bmm         0.35%     164.890us        15.58%       7.314ms     457.121us       6.774ms        44.42%       6.794ms     424.606us            16
                                            aten::copy_         0.65%     304.410us        13.14%       6.167ms      50.547us       4.409ms        28.91%       4.409ms      36.139us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.212ms        27.62%       4.212ms     324.026us            13
                                           aten::repeat         0.04%      20.596us         9.10%       4.274ms       1.068ms       0.000us         0.00%       4.179ms       1.045ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.143ms        27.17%       4.143ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.13%      63.113us        12.24%       5.744ms       1.915ms       0.000us         0.00%       2.831ms     943.743us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.944ms
Self CUDA time total: 15.250ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.91 ms
[TIME] td_target:    4.94 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.34 ms
[TIME] compute Q:    8.55 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.16 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   50.28 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.21%       2.490ms        64.84%      30.966ms       2.581ms       0.000us         0.00%      21.687ms       1.807ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.283ms        60.76%       9.283ms       4.641ms             2
                             MooreExpertsModule_forward         0.28%     135.897us        19.70%       9.407ms       4.704ms       0.000us         0.00%       8.796ms       4.398ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.299ms        54.32%       8.299ms       8.299ms             1
                                              aten::bmm         0.35%     165.980us        15.35%       7.330ms     458.097us       6.745ms        44.15%       6.764ms     422.726us            16
                                            aten::copy_         0.63%     299.438us        13.21%       6.309ms      51.716us       4.467ms        29.24%       4.467ms      36.616us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.272ms        27.96%       4.272ms     328.602us            13
                                           aten::repeat         0.04%      20.123us         9.07%       4.332ms       1.083ms       0.000us         0.00%       4.238ms       1.060ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.142ms        27.11%       4.142ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.14%      64.605us        12.62%       6.029ms       2.010ms       0.000us         0.00%       2.823ms     940.927us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.759ms
Self CUDA time total: 15.278ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.97 ms
[TIME] td_target:    5.85 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.87 ms
[TIME] compute Q:    8.71 ms
[TIME] reward loss:    3.72 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.71 ms
[TIME] grad clipping:    0.88 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   51.84 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.27%       2.581ms        65.26%      31.967ms       2.664ms       0.000us         0.00%      21.767ms       1.814ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.843ms        64.23%       9.843ms       4.922ms             2
                             MooreExpertsModule_forward         0.32%     155.814us        20.37%       9.977ms       4.988ms       0.000us         0.00%       8.821ms       4.411ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.397ms        54.79%       8.397ms       8.397ms             1
                                              aten::bmm         0.35%     173.571us        14.71%       7.206ms     450.372us       6.793ms        44.32%       6.813ms     425.794us            16
                                            aten::copy_         0.65%     316.128us        14.37%       7.040ms      57.704us       4.475ms        29.20%       4.475ms      36.684us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.279ms        27.92%       4.279ms     329.187us            13
                                           aten::repeat         0.05%      24.480us         8.89%       4.353ms       1.088ms       0.000us         0.00%       4.246ms       1.061ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.157ms        27.12%       4.157ms       2.079ms             2
                             Torch-Compiled Region: 3/0         0.14%      69.182us        10.98%       5.378ms       1.793ms       0.000us         0.00%       2.851ms     950.441us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.984ms
Self CUDA time total: 15.326ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.14 ms
[TIME] td_target:    5.03 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.47 ms
[TIME] compute Q:    7.75 ms
[TIME] reward loss:    4.45 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.39 ms
[TIME] grad clipping:    0.73 ms
[TIME] optim.step:    1.03 ms
[TIME] _update total:   51.05 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.567ms        69.52%      33.748ms       2.812ms       0.000us         0.00%      23.175ms       1.931ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.530ms        65.60%      10.530ms       5.265ms             2
                             MooreExpertsModule_forward         0.31%     148.673us        21.96%      10.662ms       5.331ms       0.000us         0.00%       9.496ms       4.748ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.498ms        46.71%       7.498ms       7.498ms             1
                                              aten::bmm         0.36%     174.716us        18.25%       8.861ms     553.836us       7.330ms        45.66%       7.349ms     459.315us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.647ms        28.95%       4.647ms       2.324ms             2
                                            aten::copy_         0.61%     296.062us        11.54%       5.601ms      45.907us       4.628ms        28.83%       4.628ms      37.932us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.432ms        27.61%       4.432ms     340.941us            13
                                           aten::repeat         0.04%      21.616us         9.26%       4.496ms       1.124ms       0.000us         0.00%       4.399ms       1.100ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.381ms        21.06%       3.381ms       1.127ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.548ms
Self CUDA time total: 16.053ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.88 ms
[TIME] td_target:    5.05 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.36 ms
[TIME] compute Q:    8.61 ms
[TIME] reward loss:    3.91 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.77 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.11 ms
[TIME] _update total:   51.63 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.39%       2.633ms        63.76%      31.160ms       2.597ms       0.000us         0.00%      21.634ms       1.803ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.270ms        60.79%       9.270ms       4.635ms             2
                             MooreExpertsModule_forward         0.30%     146.040us        19.24%       9.401ms       4.701ms       0.000us         0.00%       8.761ms       4.380ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.325ms        54.59%       8.325ms       8.325ms             1
                                              aten::bmm         0.37%     182.058us        15.68%       7.663ms     478.968us       6.798ms        44.58%       6.817ms     426.038us            16
                                            aten::copy_         0.68%     330.952us        12.85%       6.282ms      51.488us       4.375ms        28.69%       4.375ms      35.863us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.180ms        27.41%       4.180ms     321.571us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.163ms        27.30%       4.163ms       2.081ms             2
                                           aten::repeat         0.05%      24.487us         8.70%       4.250ms       1.062ms       0.000us         0.00%       4.147ms       1.037ms             4
                             Torch-Compiled Region: 3/0         0.14%      70.436us        11.99%       5.861ms       1.954ms       0.000us         0.00%       2.834ms     944.511us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.872ms
Self CUDA time total: 15.250ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.32 ms
[TIME] td_target:    5.05 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.20 ms
[TIME] compute Q:    7.64 ms
[TIME] reward loss:    4.57 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.31 ms
[TIME] grad clipping:    0.73 ms
[TIME] optim.step:    1.02 ms
[TIME] _update total:   49.86 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.35%       2.533ms        68.58%      32.461ms       2.705ms       0.000us         0.00%      21.880ms       1.823ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.378ms        61.07%       9.378ms       4.689ms             2
                             MooreExpertsModule_forward         0.31%     144.393us        20.09%       9.507ms       4.754ms       0.000us         0.00%       8.891ms       4.445ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.385ms        48.09%       7.385ms       7.385ms             1
                                              aten::bmm         0.34%     162.404us        17.92%       8.483ms     530.202us       6.835ms        44.51%       6.854ms     428.360us            16
                                            aten::copy_         0.61%     288.201us        12.82%       6.066ms      49.721us       4.524ms        29.46%       4.524ms      37.085us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.332ms        28.21%       4.332ms     333.224us            13
                                           aten::repeat         0.04%      19.889us         9.28%       4.393ms       1.098ms       0.000us         0.00%       4.299ms       1.075ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.156ms        27.07%       4.156ms       2.078ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.527ms        22.96%       3.527ms       1.176ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.333ms
Self CUDA time total: 15.357ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.92 ms
[TIME] td_target:    6.35 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.97 ms
[TIME] compute Q:    7.59 ms
[TIME] reward loss:    3.60 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.92 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   50.13 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.14%       2.448ms        66.00%      31.448ms       2.621ms       0.000us         0.00%      21.968ms       1.831ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.772ms        63.41%       9.772ms       4.886ms             2
                             MooreExpertsModule_forward         0.29%     139.472us        20.77%       9.897ms       4.949ms       0.000us         0.00%       8.934ms       4.467ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.335ms        47.59%       7.335ms       7.335ms             1
                                              aten::bmm         0.34%     162.173us        15.77%       7.516ms     469.748us       6.786ms        44.03%       6.805ms     425.312us            16
                                            aten::copy_         0.60%     287.776us        11.91%       5.677ms      46.534us       4.576ms        29.69%       4.576ms      37.509us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.382ms        28.44%       4.382ms     337.086us            13
                                           aten::repeat         0.04%      20.609us         9.32%       4.440ms       1.110ms       0.000us         0.00%       4.348ms       1.087ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.145ms        26.90%       4.145ms       2.072ms             2
                             Torch-Compiled Region: 3/0         0.13%      63.794us         9.94%       4.735ms       1.578ms       0.000us         0.00%       2.816ms     938.655us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.648ms
Self CUDA time total: 15.411ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.89 ms
[TIME] td_target:    5.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.54 ms
[TIME] compute Q:    8.45 ms
[TIME] reward loss:    3.83 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.56 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   50.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.516ms        66.29%      31.859ms       2.655ms       0.000us         0.00%      21.591ms       1.799ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.010ms        65.81%      10.010ms       5.005ms             2
                             MooreExpertsModule_forward         0.29%     141.509us        21.09%      10.138ms       5.069ms       0.000us         0.00%       8.759ms       4.379ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.166ms        53.69%       8.166ms       8.166ms             1
                                              aten::bmm         0.34%     165.721us        15.26%       7.336ms     458.504us       6.771ms        44.52%       6.790ms     424.402us            16
                                            aten::copy_         0.65%     313.341us        12.89%       6.196ms      50.790us       4.403ms        28.95%       4.403ms      36.093us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.208ms        27.67%       4.208ms     323.705us            13
                                           aten::repeat         0.04%      21.533us         8.91%       4.284ms       1.071ms       0.000us         0.00%       4.174ms       1.043ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.134ms        27.18%       4.134ms       2.067ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.194us        10.93%       5.252ms       1.751ms       0.000us         0.00%       2.799ms     932.853us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.063ms
Self CUDA time total: 15.211ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.89 ms
[TIME] td_target:    5.01 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.95 ms
[TIME] compute Q:    8.13 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.38 ms
[TIME] grad clipping:    1.35 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   49.39 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.40%       2.532ms        65.53%      30.708ms       2.559ms       0.000us         0.00%      21.646ms       1.804ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.256ms        60.66%       9.256ms       4.628ms             2
                             MooreExpertsModule_forward         0.33%     154.055us        20.06%       9.399ms       4.699ms       0.000us         0.00%       8.759ms       4.380ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.876ms        51.61%       7.876ms       7.876ms             1
                                              aten::bmm         0.35%     166.065us        15.68%       7.349ms     459.296us       6.809ms        44.62%       6.828ms     426.754us            16
                                            aten::copy_         0.63%     295.236us        11.37%       5.330ms      43.691us       4.365ms        28.61%       4.365ms      35.779us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.174ms        27.36%       4.174ms       2.087ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.172ms        27.34%       4.172ms     320.916us            13
                                           aten::repeat         0.04%      20.498us         9.03%       4.232ms       1.058ms       0.000us         0.00%       4.138ms       1.035ms             4
                             Torch-Compiled Region: 3/0         0.14%      66.410us        12.13%       5.686ms       1.895ms       0.000us         0.00%       2.852ms     950.751us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.864ms
Self CUDA time total: 15.259ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.08 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.49 ms
[TIME] compute Q:    7.62 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.42 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   50.99 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.11%       2.479ms        67.18%      32.575ms       2.715ms       0.000us         0.00%      22.739ms       1.895ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.487ms        66.48%      10.487ms       5.243ms             2
                             MooreExpertsModule_forward         0.30%     144.108us        21.89%      10.616ms       5.308ms       0.000us         0.00%       9.338ms       4.669ms             2
                                              aten::bmm         0.34%     164.547us        16.62%       8.057ms     503.592us       7.372ms        46.73%       7.390ms     461.895us            16
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.359ms        46.65%       7.359ms       7.359ms             1
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.751ms        30.12%       4.751ms       2.375ms             2
                                            aten::copy_         0.61%     297.371us        11.34%       5.497ms      45.058us       4.362ms        27.65%       4.362ms      35.753us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.168ms        26.42%       4.168ms     320.597us            13
                                           aten::repeat         0.04%      19.792us         8.71%       4.226ms       1.056ms       0.000us         0.00%       4.134ms       1.034ms             4
                             Torch-Compiled Region: 3/0         0.15%      71.551us        10.84%       5.255ms       1.752ms       0.000us         0.00%       2.796ms     931.860us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.487ms
Self CUDA time total: 15.775ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.35 ms
[TIME] td_target:    5.04 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.50 ms
[TIME] compute Q:    7.90 ms
[TIME] reward loss:    4.54 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.91 ms
[TIME] grad clipping:    0.85 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   52.25 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.15%       2.546ms        68.88%      34.054ms       2.838ms       0.000us         0.00%      23.268ms       1.939ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.686ms        66.51%      10.686ms       5.343ms             2
                             MooreExpertsModule_forward         0.30%     150.174us        21.89%      10.823ms       5.411ms       0.000us         0.00%       9.570ms       4.785ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.587ms        47.22%       7.587ms       7.587ms             1
                                              aten::bmm         0.35%     172.720us        17.58%       8.689ms     543.058us       7.352ms        45.76%       7.371ms     460.658us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.710ms        29.31%       4.710ms       2.355ms             2
                                            aten::copy_         0.64%     318.509us        13.93%       6.889ms      56.465us       4.638ms        28.87%       4.638ms      38.015us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.443ms        27.65%       4.443ms     341.778us            13
                                           aten::repeat         0.05%      24.530us         9.13%       4.514ms       1.128ms       0.000us         0.00%       4.409ms       1.102ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.053ms        19.00%       3.053ms       1.018ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.437ms
Self CUDA time total: 16.067ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.10 ms
[TIME] td_target:    5.14 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.93 ms
[TIME] compute Q:    7.64 ms
[TIME] reward loss:    3.61 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.36 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.72 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.510ms        67.74%      32.520ms       2.710ms       0.000us         0.00%      22.395ms       1.866ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.650ms        68.12%      10.650ms       5.325ms             2
                             MooreExpertsModule_forward         0.31%     148.353us        22.46%      10.782ms       5.391ms       0.000us         0.00%       9.150ms       4.575ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.382ms        47.22%       7.382ms       7.382ms             1
                                              aten::bmm         0.34%     163.296us        16.19%       7.770ms     485.647us       7.073ms        45.24%       7.092ms     443.263us            16
                                            aten::copy_         0.61%     295.116us        13.57%       6.514ms      53.395us       4.499ms        28.78%       4.499ms      36.874us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.442ms        28.42%       4.442ms       2.221ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.304ms        27.53%       4.304ms     331.061us            13
                                           aten::repeat         0.04%      21.181us         9.09%       4.364ms       1.091ms       0.000us         0.00%       4.269ms       1.067ms             4
                             Torch-Compiled Region: 3/0         0.15%      70.284us         9.97%       4.787ms       1.596ms       0.000us         0.00%       2.815ms     938.292us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.005ms
Self CUDA time total: 15.634ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.02 ms
[TIME] td_target:    5.47 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.38 ms
[TIME] compute Q:    7.66 ms
[TIME] reward loss:    6.12 ms
[TIME] value loss:    0.33 ms
[TIME] backward:   11.71 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.45 ms
[TIME] _update total:   53.93 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.62%       2.870ms        67.09%      34.246ms       2.854ms       0.000us         0.00%      21.933ms       1.828ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.807ms        63.71%       9.807ms       4.904ms             2
                             MooreExpertsModule_forward         0.28%     142.513us        19.46%       9.935ms       4.967ms       0.000us         0.00%       8.925ms       4.463ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.372ms        47.89%       7.372ms       7.372ms             1
                                              aten::bmm         0.43%     219.538us        14.56%       7.435ms     464.677us       6.793ms        44.13%       6.812ms     425.772us            16
                                            aten::copy_         0.64%     324.309us        11.24%       5.740ms      47.047us       4.565ms        29.66%       4.565ms      37.421us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.372ms        28.40%       4.372ms     336.279us            13
                                           aten::repeat         0.05%      23.027us         8.69%       4.438ms       1.110ms       0.000us         0.00%       4.338ms       1.085ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       4.251ms        27.61%       4.251ms       1.417ms             3
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.142ms        26.91%       4.142ms       2.071ms             2
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.046ms
Self CUDA time total: 15.394ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.07 ms
[TIME] td_target:    5.24 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.93 ms
[TIME] compute Q:    7.79 ms
[TIME] reward loss:    3.65 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.18 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.78 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.21%       2.514ms        67.79%      32.706ms       2.725ms       0.000us         0.00%      23.147ms       1.929ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.747ms        67.21%      10.747ms       5.373ms             2
                             MooreExpertsModule_forward         0.29%     139.591us        22.54%      10.874ms       5.437ms       0.000us         0.00%       9.532ms       4.766ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.526ms        47.07%       7.526ms       7.526ms             1
                                              aten::bmm         0.35%     167.565us        17.32%       8.354ms     522.124us       7.228ms        45.21%       7.247ms     452.923us            16
                                            aten::copy_         0.64%     310.103us        11.86%       5.724ms      46.916us       4.724ms        29.54%       4.724ms      38.718us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.598ms        28.76%       4.598ms       2.299ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.529ms        28.33%       4.529ms     348.400us            13
                                           aten::repeat         0.04%      20.373us         9.52%       4.592ms       1.148ms       0.000us         0.00%       4.496ms       1.124ms             4
                             Torch-Compiled Region: 3/0         0.14%      66.381us         9.91%       4.781ms       1.594ms       0.000us         0.00%       2.808ms     936.052us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.247ms
Self CUDA time total: 15.989ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.32 ms
[TIME] td_target:    5.03 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.84 ms
[TIME] compute Q:    8.48 ms
[TIME] reward loss:    3.73 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.41 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   51.67 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.16%       2.481ms        64.99%      31.246ms       2.604ms       0.000us         0.00%      21.696ms       1.808ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.366ms        61.33%       9.366ms       4.683ms             2
                             MooreExpertsModule_forward         0.29%     140.032us        19.74%       9.489ms       4.744ms       0.000us         0.00%       8.812ms       4.406ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.198ms        53.68%       8.198ms       8.198ms             1
                                              aten::bmm         0.35%     165.873us        15.00%       7.211ms     450.716us       6.807ms        44.57%       6.826ms     426.632us            16
                                            aten::copy_         0.62%     295.865us        11.79%       5.670ms      46.475us       4.419ms        28.94%       4.419ms      36.223us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.222ms        27.65%       4.222ms     324.774us            13
                                           aten::repeat         0.04%      20.347us         8.90%       4.280ms       1.070ms       0.000us         0.00%       4.189ms       1.047ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.173ms        27.32%       4.173ms       2.086ms             2
                             Torch-Compiled Region: 3/0         0.13%      64.023us        11.35%       5.459ms       1.820ms       0.000us         0.00%       2.793ms     931.061us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.079ms
Self CUDA time total: 15.272ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.94 ms
[TIME] td_target:    5.56 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.53 ms
[TIME] compute Q:    8.28 ms
[TIME] reward loss:    3.95 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.47 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   50.61 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.17%       2.476ms        66.36%      31.759ms       2.647ms       0.000us         0.00%      22.057ms       1.838ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.974ms        64.45%       9.974ms       4.987ms             2
                             MooreExpertsModule_forward         0.29%     139.559us        21.10%      10.099ms       5.050ms       0.000us         0.00%       8.971ms       4.485ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.016ms        51.80%       8.016ms       8.016ms             1
                                              aten::bmm         0.34%     164.763us        15.75%       7.537ms     471.082us       6.805ms        43.97%       6.824ms     426.470us            16
                                            aten::copy_         0.64%     305.438us        12.35%       5.909ms      48.435us       4.622ms        29.87%       4.622ms      37.888us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.427ms        28.61%       4.427ms     340.516us            13
                                           aten::repeat         0.05%      22.215us         9.39%       4.492ms       1.123ms       0.000us         0.00%       4.393ms       1.098ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.127ms        26.67%       4.127ms       2.063ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.052us        10.79%       5.166ms       1.722ms       0.000us         0.00%       2.834ms     944.702us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.856ms
Self CUDA time total: 15.475ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.96 ms
[TIME] td_target:    6.33 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.04 ms
[TIME] compute Q:    8.42 ms
[TIME] reward loss:    3.58 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   12.22 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   51.35 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.09%       2.485ms        66.81%      32.602ms       2.717ms       0.000us         0.00%      22.073ms       1.839ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.708ms        69.27%      10.708ms       5.354ms             2
                             MooreExpertsModule_forward         0.30%     145.994us        22.22%      10.843ms       5.422ms       0.000us         0.00%       8.992ms       4.496ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.177ms        52.89%       8.177ms       8.177ms             1
                                              aten::bmm         0.34%     164.522us        15.17%       7.405ms     462.793us       6.774ms        43.82%       6.793ms     424.533us            16
                                            aten::copy_         0.63%     305.374us        14.29%       6.974ms      57.164us       4.636ms        29.99%       4.636ms      37.997us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.439ms        28.72%       4.439ms     341.493us            13
                                           aten::repeat         0.04%      21.019us         9.22%       4.501ms       1.125ms       0.000us         0.00%       4.406ms       1.101ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.132ms        26.73%       4.132ms       2.066ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.101us         9.83%       4.799ms       1.600ms       0.000us         0.00%       2.810ms     936.736us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.800ms
Self CUDA time total: 15.459ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.83 ms
[TIME] td_target:    5.28 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.92 ms
[TIME] compute Q:    8.35 ms
[TIME] reward loss:    3.58 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.50 ms
[TIME] grad clipping:    1.61 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.16 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.25%       2.498ms        65.35%      31.103ms       2.592ms       0.000us         0.00%      21.579ms       1.798ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.530ms        62.64%       9.530ms       4.765ms             2
                             MooreExpertsModule_forward         0.30%     142.068us        20.29%       9.658ms       4.829ms       0.000us         0.00%       8.745ms       4.373ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.091ms        53.18%       8.091ms       8.091ms             1
                                              aten::bmm         0.35%     166.566us        15.57%       7.413ms     463.302us       6.717ms        44.15%       6.736ms     421.022us            16
                                            aten::copy_         0.63%     298.452us        11.64%       5.538ms      45.395us       4.409ms        28.98%       4.409ms      36.140us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.216ms        27.71%       4.216ms     324.286us            13
                                           aten::repeat         0.04%      20.494us         8.98%       4.274ms       1.068ms       0.000us         0.00%       4.182ms       1.046ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.128ms        27.13%       4.128ms       2.064ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.594us        11.89%       5.658ms       1.886ms       0.000us         0.00%       2.818ms     939.168us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.597ms
Self CUDA time total: 15.215ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.34 ms
[TIME] td_target:    5.06 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.39 ms
[TIME] compute Q:    7.79 ms
[TIME] reward loss:    4.45 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.04 ms
[TIME] grad clipping:    0.85 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   52.01 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.20%       2.559ms        69.05%      33.972ms       2.831ms       0.000us         0.00%      23.428ms       1.952ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.693ms        66.32%      10.693ms       5.347ms             2
                             MooreExpertsModule_forward         0.30%     147.420us        22.00%      10.822ms       5.411ms       0.000us         0.00%       9.678ms       4.839ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.525ms        46.67%       7.525ms       7.525ms             1
                                              aten::bmm         0.37%     179.989us        16.79%       8.262ms     516.345us       7.287ms        45.20%       7.306ms     456.652us            16
                                            aten::copy_         0.66%     323.817us        12.09%       5.947ms      48.746us       4.827ms        29.94%       4.827ms      39.566us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.639ms        28.78%       4.639ms       2.320ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.632ms        28.73%       4.632ms     356.341us            13
                                           aten::repeat         0.05%      23.709us         9.55%       4.701ms       1.175ms       0.000us         0.00%       4.599ms       1.150ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.953ms        18.31%       2.953ms     984.276us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.196ms
Self CUDA time total: 16.123ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.05 ms
[TIME] td_target:    4.97 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.97 ms
[TIME] compute Q:    7.69 ms
[TIME] reward loss:    4.14 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.19 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   49.86 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.22%       2.471ms        68.77%      32.547ms       2.712ms       0.000us         0.00%      23.168ms       1.931ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.472ms        65.46%      10.472ms       5.236ms             2
                             MooreExpertsModule_forward         0.30%     141.285us        22.40%      10.600ms       5.300ms       0.000us         0.00%       9.545ms       4.772ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.446ms        46.54%       7.446ms       7.446ms             1
                                              aten::bmm         0.35%     166.946us        17.02%       8.055ms     503.451us       7.219ms        45.13%       7.238ms     452.372us            16
                                            aten::copy_         0.61%     289.649us        13.66%       6.465ms      52.991us       4.713ms        29.46%       4.713ms      38.632us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.616ms        28.86%       4.616ms       2.308ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.518ms        28.24%       4.518ms     347.509us            13
                                           aten::repeat         0.04%      19.890us         9.68%       4.579ms       1.145ms       0.000us         0.00%       4.484ms       1.121ms             4
                             Torch-Compiled Region: 3/0         0.14%      65.087us        10.68%       5.056ms       1.685ms       0.000us         0.00%       2.795ms     931.561us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.325ms
Self CUDA time total: 15.998ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.03 ms
[TIME] td_target:    6.04 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.06 ms
[TIME] compute Q:    8.46 ms
[TIME] reward loss:    3.58 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.29 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.31 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.27%       2.522ms        67.04%      32.047ms       2.671ms       0.000us         0.00%      22.086ms       1.841ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.406ms        67.30%      10.406ms       5.203ms             2
                             MooreExpertsModule_forward         0.30%     144.165us        22.04%      10.534ms       5.267ms       0.000us         0.00%       9.003ms       4.502ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.205ms        53.07%       8.205ms       8.205ms             1
                                              aten::bmm         0.34%     164.880us        15.31%       7.320ms     457.498us       6.769ms        43.78%       6.788ms     424.274us            16
                                            aten::copy_         0.62%     294.620us        13.69%       6.545ms      53.650us       4.647ms        30.05%       4.647ms      38.092us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.452ms        28.79%       4.452ms     342.468us            13
                                           aten::repeat         0.04%      20.367us         9.44%       4.513ms       1.128ms       0.000us         0.00%       4.418ms       1.105ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.131ms        26.71%       4.131ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.316us         9.96%       4.762ms       1.587ms       0.000us         0.00%       2.799ms     933.128us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.804ms
Self CUDA time total: 15.462ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.94 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.80 ms
[TIME] compute Q:    8.34 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.80 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   51.46 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.568ms        64.07%      31.081ms       2.590ms       0.000us         0.00%      21.627ms       1.802ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.258ms        60.69%       9.258ms       4.629ms             2
                             MooreExpertsModule_forward         0.28%     137.625us        19.34%       9.382ms       4.691ms       0.000us         0.00%       8.758ms       4.379ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.057ms        52.82%       8.057ms       8.057ms             1
                                              aten::bmm         0.35%     170.016us        15.74%       7.634ms     477.135us       6.786ms        44.48%       6.805ms     425.288us            16
                                            aten::copy_         0.63%     305.903us        12.05%       5.847ms      47.930us       4.387ms        28.76%       4.387ms      35.959us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.192ms        27.48%       4.192ms     322.484us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.159ms        27.26%       4.159ms       2.079ms             2
                                           aten::repeat         0.05%      24.973us         8.78%       4.261ms       1.065ms       0.000us         0.00%       4.159ms       1.040ms             4
                             Torch-Compiled Region: 3/0         0.14%      70.323us        12.28%       5.960ms       1.987ms       0.000us         0.00%       2.834ms     944.616us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.511ms
Self CUDA time total: 15.256ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.94 ms
[TIME] td_target:    6.39 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   10.96 ms
[TIME] compute Q:    8.56 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.54 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.16%       2.494ms        66.55%      32.156ms       2.680ms       0.000us         0.00%      21.756ms       1.813ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.262ms        67.06%      10.262ms       5.131ms             2
                             MooreExpertsModule_forward         0.29%     140.800us        21.51%      10.391ms       5.196ms       0.000us         0.00%       8.838ms       4.419ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.317ms        54.35%       8.317ms       8.317ms             1
                                              aten::bmm         0.33%     160.916us        15.33%       7.409ms     463.051us       6.751ms        44.12%       6.770ms     423.138us            16
                                            aten::copy_         0.61%     295.922us        14.38%       6.950ms      56.969us       4.501ms        29.42%       4.501ms      36.895us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.305ms        28.14%       4.305ms     331.174us            13
                                           aten::repeat         0.04%      20.107us         9.03%       4.363ms       1.091ms       0.000us         0.00%       4.269ms       1.067ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.152ms        27.13%       4.152ms       2.076ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.816us         9.86%       4.763ms       1.588ms       0.000us         0.00%       2.805ms     935.114us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.317ms
Self CUDA time total: 15.302ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.93 ms
[TIME] td_target:    7.84 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.24 ms
[TIME] compute Q:    8.76 ms
[TIME] reward loss:    3.87 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.52 ms
[TIME] grad clipping:    0.92 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   55.23 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.81%       2.522ms        64.43%      33.773ms       2.814ms       0.000us         0.00%      21.602ms       1.800ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.890ms        71.46%      10.890ms       5.445ms             2
                             MooreExpertsModule_forward         0.28%     148.154us        21.04%      11.029ms       5.515ms       0.000us         0.00%       8.749ms       4.374ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.468ms        55.56%       8.468ms       8.468ms             1
                                              aten::bmm         0.33%     171.635us        13.78%       7.223ms     451.445us       6.796ms        44.59%       6.815ms     425.940us            16
                                            aten::copy_         0.62%     326.845us        12.98%       6.807ms      55.791us       4.368ms        28.66%       4.368ms      35.800us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.171ms        27.37%       4.171ms     320.867us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.166ms        27.34%       4.166ms       2.083ms             2
                                           aten::repeat         0.05%      26.219us         8.10%       4.244ms       1.061ms       0.000us         0.00%       4.138ms       1.034ms             4
                             Torch-Compiled Region: 3/0         0.14%      74.554us         9.19%       4.819ms       1.606ms       0.000us         0.00%       2.824ms     941.438us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.421ms
Self CUDA time total: 15.241ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.83 ms
[TIME] td_target:    5.58 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.54 ms
[TIME] compute Q:    8.34 ms
[TIME] reward loss:    3.65 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.33 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.03 ms
[TIME] _update total:   50.10 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.22%       2.483ms        65.90%      31.323ms       2.610ms       0.000us         0.00%      21.656ms       1.805ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.895ms        64.92%       9.895ms       4.947ms             2
                             MooreExpertsModule_forward         0.29%     135.983us        21.08%      10.019ms       5.009ms       0.000us         0.00%       8.798ms       4.399ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.080ms        53.01%       8.080ms       8.080ms             1
                                              aten::bmm         0.34%     162.940us        15.82%       7.518ms     469.891us       6.776ms        44.46%       6.794ms     424.633us            16
                                            aten::copy_         0.62%     294.597us        12.48%       5.931ms      48.614us       4.430ms        29.07%       4.430ms      36.314us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.235ms        27.78%       4.235ms     325.751us            13
                                           aten::repeat         0.04%      20.428us         9.04%       4.297ms       1.074ms       0.000us         0.00%       4.201ms       1.050ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.144ms        27.19%       4.144ms       2.072ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.215us        10.89%       5.175ms       1.725ms       0.000us         0.00%       2.786ms     928.694us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.533ms
Self CUDA time total: 15.242ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.82 ms
[TIME] td_target:    4.95 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.02 ms
[TIME] compute Q:    8.57 ms
[TIME] reward loss:    3.60 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.30 ms
[TIME] grad clipping:    0.72 ms
[TIME] optim.step:    1.83 ms
[TIME] _update total:   49.81 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.25%       2.487ms        64.57%      30.567ms       2.547ms       0.000us         0.00%      21.530ms       1.794ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.231ms        60.89%       9.231ms       4.616ms             2
                             MooreExpertsModule_forward         0.31%     144.530us        19.77%       9.359ms       4.679ms       0.000us         0.00%       8.738ms       4.369ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.314ms        54.84%       8.314ms       8.314ms             1
                                              aten::bmm         0.35%     165.897us        16.92%       8.012ms     500.754us       6.780ms        44.72%       6.799ms     424.966us            16
                                            aten::copy_         0.61%     288.831us        13.59%       6.435ms      52.746us       4.375ms        28.86%       4.375ms      35.862us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.181ms        27.58%       4.181ms     321.593us            13
                                           aten::repeat         0.04%      20.885us         8.96%       4.240ms       1.060ms       0.000us         0.00%       4.147ms       1.037ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.142ms        27.32%       4.142ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.14%      64.457us        12.12%       5.737ms       1.912ms       0.000us         0.00%       2.780ms     926.559us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.341ms
Self CUDA time total: 15.160ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    9.57 ms
[TIME] td_target:    4.90 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.89 ms
[TIME] compute Q:    9.72 ms
[TIME] reward loss:    4.43 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.00 ms
[TIME] grad clipping:    0.74 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   53.34 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.05%       2.554ms        66.50%      33.597ms       2.800ms       0.000us         0.00%      21.696ms       1.808ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.608ms        62.99%       9.608ms       4.804ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.442ms        61.90%       9.442ms       9.442ms             1
                             MooreExpertsModule_forward         0.29%     145.968us        19.57%       9.888ms       4.944ms       0.000us         0.00%       8.809ms       4.405ms             2
                                              aten::bmm         0.34%     170.951us        14.22%       7.185ms     449.074us       6.775ms        44.42%       6.794ms     424.632us            16
                                            aten::copy_         0.63%     316.298us        16.30%       8.233ms      67.487us       4.420ms        28.98%       4.420ms      36.233us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.224ms        27.69%       4.224ms     324.931us            13
                                           aten::repeat         0.05%      24.580us         9.31%       4.703ms       1.176ms       0.000us         0.00%       4.183ms       1.046ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.167ms        27.32%       4.167ms       2.084ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.275ms        21.47%       3.275ms       1.092ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.526ms
Self CUDA time total: 15.253ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    9.05 ms
[TIME] td_target:    5.86 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.13 ms
[TIME] compute Q:    8.33 ms
[TIME] reward loss:    5.37 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.09 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   53.71 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.91%       2.507ms        73.59%      37.603ms       3.134ms       0.000us         0.00%      24.457ms       2.038ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      12.271ms        73.78%      12.271ms       6.136ms             2
                             MooreExpertsModule_forward         0.28%     142.215us        24.27%      12.401ms       6.200ms       0.000us         0.00%      10.203ms       5.101ms             2
                                              aten::bmm         0.32%     163.060us        18.13%       9.264ms     578.995us       8.055ms        48.43%       8.074ms     504.613us            16
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.069ms        48.52%       8.069ms       8.069ms             1
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       5.469ms        32.88%       5.469ms       2.734ms             2
                                            aten::copy_         0.58%     296.918us        12.69%       6.487ms      53.168us       4.515ms        27.15%       4.515ms      37.005us           122
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       4.332ms        26.05%       4.332ms       1.444ms             3
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.319ms        25.97%       4.319ms     332.247us            13
                                           aten::repeat         0.04%      21.410us         8.58%       4.384ms       1.096ms       0.000us         0.00%       4.286ms       1.071ms             4
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.097ms
Self CUDA time total: 16.631ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.83 ms
[TIME] td_target:    4.80 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.44 ms
[TIME] compute Q:    8.64 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.20 ms
[TIME] backward:   10.60 ms
[TIME] grad clipping:    0.73 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.92 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.16%       2.501ms        62.36%      30.214ms       2.518ms       0.000us         0.00%      21.625ms       1.802ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.119ms        59.88%       9.119ms       4.560ms             2
                             MooreExpertsModule_forward         0.28%     136.060us        19.07%       9.242ms       4.621ms       0.000us         0.00%       8.770ms       4.385ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.317ms        54.62%       8.317ms       8.317ms             1
                                              aten::bmm         0.34%     166.947us        14.91%       7.226ms     451.615us       6.823ms        44.80%       6.842ms     427.604us            16
                                            aten::copy_         0.62%     299.828us        11.31%       5.480ms      44.920us       4.373ms        28.72%       4.373ms      35.845us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.177ms        27.43%       4.177ms     321.286us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.175ms        27.42%       4.175ms       2.088ms             2
                                           aten::repeat         0.04%      20.060us         8.74%       4.237ms       1.059ms       0.000us         0.00%       4.143ms       1.036ms             4
                             Torch-Compiled Region: 3/0         0.14%      65.945us        11.45%       5.546ms       1.849ms       0.000us         0.00%       2.810ms     936.619us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.449ms
Self CUDA time total: 15.229ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.83 ms
[TIME] td_target:    7.49 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.34 ms
[TIME] compute Q:    7.78 ms
[TIME] reward loss:    3.76 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.53 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   54.66 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.84%       2.510ms        66.32%      34.404ms       2.867ms       0.000us         0.00%      21.570ms       1.797ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.954ms        72.02%      10.954ms       5.477ms             2
                             MooreExpertsModule_forward         0.28%     143.543us        21.37%      11.083ms       5.541ms       0.000us         0.00%       8.744ms       4.372ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.501ms        49.32%       7.501ms       7.501ms             1
                                              aten::bmm         0.33%     173.062us        16.40%       8.508ms     531.776us       6.731ms        44.25%       6.750ms     421.903us            16
                                            aten::copy_         0.61%     317.846us        12.00%       6.227ms      51.040us       4.383ms        28.81%       4.383ms      35.923us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.187ms        27.53%       4.187ms     322.093us            13
                                           aten::repeat         0.04%      23.229us         8.20%       4.254ms       1.064ms       0.000us         0.00%       4.154ms       1.038ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.139ms        27.21%       4.139ms       2.069ms             2
                             Torch-Compiled Region: 3/0         0.13%      66.571us         9.96%       5.165ms       1.722ms       0.000us         0.00%       2.818ms     939.178us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.872ms
Self CUDA time total: 15.210ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.93 ms
[TIME] td_target:    7.02 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.40 ms
[TIME] compute Q:    8.16 ms
[TIME] reward loss:    3.60 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.30 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   53.34 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.90%       2.484ms        67.59%      34.287ms       2.857ms       0.000us         0.00%      22.019ms       1.835ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.366ms        73.55%      11.366ms       5.683ms             2
                             MooreExpertsModule_forward         0.28%     140.372us        22.66%      11.494ms       5.747ms       0.000us         0.00%       8.960ms       4.480ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.900ms        51.12%       7.900ms       7.900ms             1
                                              aten::bmm         0.32%     164.732us        16.44%       8.340ms     521.264us       6.776ms        43.85%       6.795ms     424.696us            16
                                            aten::copy_         0.58%     294.638us        12.45%       6.316ms      51.769us       4.605ms        29.80%       4.605ms      37.745us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.410ms        28.54%       4.410ms     339.203us            13
                                           aten::repeat         0.04%      21.061us         8.81%       4.471ms       1.118ms       0.000us         0.00%       4.376ms       1.094ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.131ms        26.73%       4.131ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.13%      66.671us        10.17%       5.160ms       1.720ms       0.000us         0.00%       2.821ms     940.469us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.724ms
Self CUDA time total: 15.453ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.86 ms
[TIME] td_target:    6.89 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.02 ms
[TIME] compute Q:    8.32 ms
[TIME] reward loss:    3.56 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.18 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   53.64 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.79%       2.449ms        66.79%      34.165ms       2.847ms       0.000us         0.00%      21.637ms       1.803ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.879ms        71.28%      10.879ms       5.440ms             2
                             MooreExpertsModule_forward         0.27%     138.694us        21.51%      11.002ms       5.501ms       0.000us         0.00%       8.758ms       4.379ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.070ms        52.87%       8.070ms       8.070ms             1
                                              aten::bmm         0.31%     161.044us        14.98%       7.664ms     478.998us       6.801ms        44.56%       6.820ms     426.248us            16
                                            aten::copy_         0.57%     292.721us        14.37%       7.350ms      60.242us       4.370ms        28.63%       4.370ms      35.823us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.177ms        27.37%       4.177ms     321.298us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.165ms        27.29%       4.165ms       2.083ms             2
                                           aten::repeat         0.04%      20.312us         8.28%       4.235ms       1.059ms       0.000us         0.00%       4.143ms       1.036ms             4
                             Torch-Compiled Region: 3/0         0.13%      65.183us        11.51%       5.888ms       1.963ms       0.000us         0.00%       2.842ms     947.327us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.154ms
Self CUDA time total: 15.262ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.97 ms
[TIME] td_target:    7.11 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.19 ms
[TIME] compute Q:    7.74 ms
[TIME] reward loss:    4.49 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.25 ms
[TIME] grad clipping:    1.80 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   56.67 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.71%       2.534ms        68.86%      37.063ms       3.089ms       0.000us         0.00%      23.156ms       1.930ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      12.464ms        77.70%      12.464ms       6.232ms             2
                             MooreExpertsModule_forward         0.27%     147.005us        23.39%      12.591ms       6.296ms       0.000us         0.00%       9.507ms       4.753ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.442ms        46.40%       7.442ms       7.442ms             1
                                              aten::bmm         0.32%     170.383us        17.27%       9.297ms     581.063us       7.262ms        45.27%       7.281ms     455.053us            16
                                            aten::copy_         0.58%     311.958us        14.33%       7.714ms      63.229us       4.672ms        29.13%       4.672ms      38.293us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.639ms        28.92%       4.639ms       2.320ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.477ms        27.91%       4.477ms     344.395us            13
                                           aten::repeat         0.05%      24.996us         8.45%       4.548ms       1.137ms       0.000us         0.00%       4.444ms       1.111ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.379ms        21.07%       3.379ms       1.126ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.827ms
Self CUDA time total: 16.040ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.82 ms
[TIME] td_target:    5.86 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.37 ms
[TIME] compute Q:    7.58 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.16 ms
[TIME] backward:   11.20 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.32 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.19%       2.481ms        66.78%      31.900ms       2.658ms       0.000us         0.00%      21.532ms       1.794ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.224ms        60.74%       9.224ms       4.612ms             2
                             MooreExpertsModule_forward         0.30%     141.241us        19.58%       9.353ms       4.677ms       0.000us         0.00%       8.731ms       4.365ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.316ms        48.18%       7.316ms       7.316ms             1
                                              aten::bmm         0.34%     163.189us        16.06%       7.673ms     479.567us       6.759ms        44.51%       6.777ms     423.576us            16
                                            aten::copy_         0.62%     297.964us        11.57%       5.528ms      45.310us       4.369ms        28.77%       4.369ms      35.809us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.175ms        27.49%       4.175ms     321.136us            13
                                           aten::repeat         0.05%      21.814us         8.87%       4.237ms       1.059ms       0.000us         0.00%       4.141ms       1.035ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.140ms        27.26%       4.140ms       2.070ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.433us        11.06%       5.284ms       1.761ms       0.000us         0.00%       2.799ms     932.915us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.768ms
Self CUDA time total: 15.185ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.92 ms
[TIME] td_target:    6.09 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   10.97 ms
[TIME] compute Q:    8.36 ms
[TIME] reward loss:    3.62 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.26 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   50.06 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.488ms        67.44%      32.057ms       2.671ms       0.000us         0.00%      22.023ms       1.835ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.461ms        67.80%      10.461ms       5.231ms             2
                             MooreExpertsModule_forward         0.29%     139.550us        22.27%      10.588ms       5.294ms       0.000us         0.00%       8.969ms       4.484ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.115ms        52.60%       8.115ms       8.115ms             1
                                              aten::bmm         0.35%     167.066us        16.25%       7.724ms     482.762us       6.762ms        43.83%       6.781ms     423.802us            16
                                            aten::copy_         0.62%     295.243us        12.90%       6.132ms      50.259us       4.625ms        29.98%       4.625ms      37.910us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.431ms        28.72%       4.431ms     340.818us            13
                                           aten::repeat         0.04%      20.886us         9.45%       4.492ms       1.123ms       0.000us         0.00%       4.397ms       1.099ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.123ms        26.72%       4.123ms       2.062ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.308us        10.02%       4.764ms       1.588ms       0.000us         0.00%       2.808ms     935.915us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.537ms
Self CUDA time total: 15.429ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.93 ms
[TIME] td_target:    4.95 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.08 ms
[TIME] compute Q:    7.82 ms
[TIME] reward loss:    3.84 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.44 ms
[TIME] grad clipping:    0.84 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.98 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.16%       2.486ms        67.06%      32.300ms       2.692ms       0.000us         0.00%      22.095ms       1.841ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.328ms        66.83%      10.328ms       5.164ms             2
                             MooreExpertsModule_forward         0.29%     139.634us        21.70%      10.454ms       5.227ms       0.000us         0.00%       9.019ms       4.510ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.521ms        48.66%       7.521ms       7.521ms             1
                                              aten::bmm         0.36%     173.013us        16.17%       7.786ms     486.655us       7.070ms        45.75%       7.090ms     443.107us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.435ms        28.69%       4.435ms       2.217ms             2
                                            aten::copy_         0.65%     314.944us        11.81%       5.690ms      46.641us       4.361ms        28.22%       4.361ms      35.745us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.166ms        26.96%       4.166ms     320.493us            13
                                           aten::repeat         0.05%      23.735us         8.79%       4.233ms       1.058ms       0.000us         0.00%       4.132ms       1.033ms             4
                             Torch-Compiled Region: 3/0         0.14%      69.809us        10.65%       5.130ms       1.710ms       0.000us         0.00%       2.776ms     925.405us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.168ms
Self CUDA time total: 15.455ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.94 ms
[TIME] td_target:    5.61 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.08 ms
[TIME] compute Q:    7.76 ms
[TIME] reward loss:    4.36 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.79 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   51.68 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.63%       2.743ms        68.06%      33.177ms       2.765ms       0.000us         0.00%      22.927ms       1.911ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.667ms        67.10%      10.667ms       5.334ms             2
                             MooreExpertsModule_forward         0.38%     185.015us        22.21%      10.827ms       5.414ms       0.000us         0.00%       9.408ms       4.704ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.474ms        47.01%       7.474ms       7.474ms             1
                                              aten::bmm         0.36%     175.135us        16.00%       7.801ms     487.552us       6.798ms        42.76%       6.818ms     426.096us            16
                                            aten::copy_         0.63%     306.994us        14.01%       6.830ms      55.982us       5.055ms        31.80%       5.055ms      41.436us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.859ms        30.57%       4.859ms     373.771us            13
                                           aten::repeat         0.05%      23.136us        10.11%       4.926ms       1.232ms       0.000us         0.00%       4.825ms       1.206ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.135ms        26.01%       4.135ms       2.067ms             2
                             Torch-Compiled Region: 3/0         0.17%      81.268us        10.19%       4.968ms       1.656ms       0.000us         0.00%       2.827ms     942.411us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.744ms
Self CUDA time total: 15.897ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.90 ms
[TIME] td_target:    4.97 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.30 ms
[TIME] compute Q:    8.29 ms
[TIME] reward loss:    3.73 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.66 ms
[TIME] grad clipping:    1.56 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   50.53 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.28%       2.527ms        64.69%      30.978ms       2.581ms       0.000us         0.00%      21.699ms       1.808ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.302ms        60.90%       9.302ms       4.651ms             2
                             MooreExpertsModule_forward         0.30%     142.259us        19.69%       9.430ms       4.715ms       0.000us         0.00%       8.800ms       4.400ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.005ms        52.41%       8.005ms       8.005ms             1
                                              aten::bmm         0.35%     169.334us        15.61%       7.475ms     467.198us       6.799ms        44.51%       6.817ms     426.082us            16
                                            aten::copy_         0.66%     315.093us        13.17%       6.307ms      51.701us       4.419ms        28.93%       4.419ms      36.223us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.226ms        27.67%       4.226ms     325.086us            13
                                           aten::repeat         0.05%      21.672us         8.96%       4.291ms       1.073ms       0.000us         0.00%       4.193ms       1.048ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.160ms        27.24%       4.160ms       2.080ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.559us        12.26%       5.869ms       1.956ms       0.000us         0.00%       2.821ms     940.489us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.889ms
Self CUDA time total: 15.274ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.94 ms
[TIME] td_target:    5.29 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.18 ms
[TIME] compute Q:    8.75 ms
[TIME] reward loss:    3.61 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.67 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   53.33 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.98%       2.518ms        62.32%      31.523ms       2.627ms       0.000us         0.00%      21.999ms       1.833ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.644ms        62.49%       9.644ms       4.822ms             2
                             MooreExpertsModule_forward         0.28%     142.159us        19.32%       9.772ms       4.886ms       0.000us         0.00%       8.959ms       4.480ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.481ms        54.96%       8.481ms       8.481ms             1
                                              aten::bmm         0.33%     164.607us        14.47%       7.319ms     457.439us       6.783ms        43.96%       6.803ms     425.170us            16
                                            aten::copy_         0.67%     340.026us        12.58%       6.361ms      52.143us       4.596ms        29.78%       4.596ms      37.668us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.400ms        28.51%       4.400ms     338.482us            13
                                           aten::repeat         0.05%      23.028us         8.83%       4.466ms       1.116ms       0.000us         0.00%       4.367ms       1.092ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.141ms        26.84%       4.141ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.635us        11.52%       5.827ms       1.942ms       0.000us         0.00%       2.806ms     935.275us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.582ms
Self CUDA time total: 15.432ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.50 ms
[TIME] td_target:    5.06 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.26 ms
[TIME] compute Q:    7.68 ms
[TIME] reward loss:    4.31 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.53 ms
[TIME] grad clipping:    0.72 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   50.14 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.520ms        68.03%      32.415ms       2.701ms       0.000us         0.00%      21.605ms       1.800ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.234ms        60.63%       9.234ms       4.617ms             2
                             MooreExpertsModule_forward         0.30%     143.267us        19.65%       9.366ms       4.683ms       0.000us         0.00%       8.743ms       4.371ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.428ms        48.78%       7.428ms       7.428ms             1
                                              aten::bmm         0.35%     167.430us        17.68%       8.425ms     526.570us       6.786ms        44.56%       6.804ms     425.221us            16
                                            aten::copy_         0.62%     294.583us        12.20%       5.814ms      47.657us       4.363ms        28.65%       4.363ms      35.762us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.172ms        27.39%       4.172ms     320.929us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.153ms        27.27%       4.153ms       2.077ms             2
                                           aten::repeat         0.04%      20.459us         8.88%       4.232ms       1.058ms       0.000us         0.00%       4.139ms       1.035ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.275ms        21.51%       3.275ms       1.092ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.651ms
Self CUDA time total: 15.230ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.87 ms
[TIME] td_target:    5.88 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.55 ms
[TIME] compute Q:    8.45 ms
[TIME] reward loss:    3.86 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.73 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   51.23 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.564ms        66.08%      32.022ms       2.669ms       0.000us         0.00%      21.739ms       1.812ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.147ms        66.31%      10.147ms       5.074ms             2
                             MooreExpertsModule_forward         0.31%     149.225us        21.22%      10.283ms       5.142ms       0.000us         0.00%       8.823ms       4.411ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.161ms        53.33%       8.161ms       8.161ms             1
                                              aten::bmm         0.36%     174.734us        15.25%       7.390ms     461.885us       6.803ms        44.45%       6.822ms     426.377us            16
                                            aten::copy_         0.66%     318.924us        13.22%       6.406ms      52.508us       4.428ms        28.93%       4.428ms      36.294us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.231ms        27.65%       4.231ms     325.453us            13
                                           aten::repeat         0.05%      23.183us         8.89%       4.306ms       1.076ms       0.000us         0.00%       4.197ms       1.049ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.171ms        27.26%       4.171ms       2.086ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.452us        10.47%       5.076ms       1.692ms       0.000us         0.00%       2.815ms     938.421us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.457ms
Self CUDA time total: 15.304ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.97 ms
[TIME] td_target:    5.51 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.84 ms
[TIME] compute Q:    7.60 ms
[TIME] reward loss:    4.02 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.33 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.13 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.31%       2.525ms        71.34%      33.920ms       2.827ms       0.000us         0.00%      21.990ms       1.832ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.672ms        62.69%       9.672ms       4.836ms             2
                             MooreExpertsModule_forward         0.30%     144.101us        20.62%       9.806ms       4.903ms       0.000us         0.00%       8.937ms       4.468ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.342ms        47.59%       7.342ms       7.342ms             1
                                              aten::bmm         0.35%     166.098us        15.32%       7.285ms     455.308us       6.754ms        43.77%       6.773ms     423.304us            16
                                            aten::copy_         0.61%     289.840us        11.97%       5.693ms      46.662us       4.581ms        29.69%       4.581ms      37.548us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.387ms        28.44%       4.387ms     337.488us            13
                                           aten::repeat         0.04%      21.038us         9.36%       4.451ms       1.113ms       0.000us         0.00%       4.354ms       1.088ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.132ms        26.78%       4.132ms       2.066ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.119us        11.66%       5.543ms       1.848ms       0.000us         0.00%       2.835ms     945.119us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.549ms
Self CUDA time total: 15.428ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.21 ms
[TIME] td_target:    6.41 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.81 ms
[TIME] compute Q:    7.54 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.21 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.03 ms
[TIME] _update total:   50.60 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.517ms        67.94%      32.687ms       2.724ms       0.000us         0.00%      21.982ms       1.832ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.756ms        63.27%       9.756ms       4.878ms             2
                             MooreExpertsModule_forward         0.30%     146.392us        20.56%       9.890ms       4.945ms       0.000us         0.00%       8.944ms       4.472ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.298ms        47.33%       7.298ms       7.298ms             1
                                              aten::bmm         0.34%     164.121us        15.16%       7.295ms     455.915us       6.766ms        43.88%       6.785ms     424.072us            16
                                            aten::copy_         0.61%     293.552us        13.46%       6.476ms      53.083us       4.590ms        29.77%       4.590ms      37.626us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.397ms        28.51%       4.397ms     338.231us            13
                                           aten::repeat         0.04%      21.491us         9.27%       4.458ms       1.114ms       0.000us         0.00%       4.363ms       1.091ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.131ms        26.79%       4.131ms       2.066ms             2
                             Torch-Compiled Region: 3/0         0.14%      67.299us         9.93%       4.779ms       1.593ms       0.000us         0.00%       2.817ms     938.999us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.109ms
Self CUDA time total: 15.420ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.28 ms
[TIME] td_target:    6.10 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.70 ms
[TIME] compute Q:    8.41 ms
[TIME] reward loss:    3.74 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.63 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.16 ms
[TIME] _update total:   53.81 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.34%       2.602ms        66.20%      32.271ms       2.689ms       0.000us         0.00%      21.837ms       1.820ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.141ms        66.13%      10.141ms       5.071ms             2
                             MooreExpertsModule_forward         0.29%     141.492us        21.09%      10.280ms       5.140ms       0.000us         0.00%       8.885ms       4.442ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.113ms        52.90%       8.113ms       8.113ms             1
                                              aten::bmm         0.34%     165.199us        15.05%       7.334ms     458.387us       6.792ms        44.29%       6.811ms     425.706us            16
                                            aten::copy_         0.64%     309.826us        14.90%       7.265ms      59.553us       4.507ms        29.39%       4.507ms      36.943us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.312ms        28.11%       4.312ms     331.661us            13
                                           aten::repeat         0.05%      22.390us         8.99%       4.382ms       1.096ms       0.000us         0.00%       4.278ms       1.070ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.155ms        27.09%       4.155ms       2.078ms             2
                             Torch-Compiled Region: 3/0         0.15%      74.248us         9.81%       4.783ms       1.594ms       0.000us         0.00%       2.792ms     930.720us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.745ms
Self CUDA time total: 15.336ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.57 ms
[TIME] td_target:    5.15 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.93 ms
[TIME] compute Q:    8.34 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.13 ms
[TIME] grad clipping:    0.87 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.65 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.61%       3.173ms        65.79%      31.587ms       2.632ms       0.000us         0.00%      21.620ms       1.802ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.306ms        61.11%       9.306ms       4.653ms             2
                             MooreExpertsModule_forward         0.29%     141.129us        19.65%       9.434ms       4.717ms       0.000us         0.00%       8.778ms       4.389ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.088ms        53.11%       8.088ms       8.088ms             1
                                              aten::bmm         0.34%     164.823us        16.78%       8.059ms     503.698us       6.765ms        44.42%       6.783ms     423.964us            16
                                            aten::copy_         0.62%     298.666us        12.78%       6.138ms      50.310us       4.422ms        29.04%       4.422ms      36.247us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.228ms        27.76%       4.228ms     325.207us            13
                                           aten::repeat         0.04%      20.756us         8.94%       4.291ms       1.073ms       0.000us         0.00%       4.194ms       1.049ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.136ms        27.16%       4.136ms       2.068ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.060us        11.75%       5.640ms       1.880ms       0.000us         0.00%       2.794ms     931.294us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.015ms
Self CUDA time total: 15.229ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.59 ms
[TIME] td_target:    5.01 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.14 ms
[TIME] compute Q:    7.49 ms
[TIME] reward loss:    4.28 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.31 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   49.67 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.73%       3.173ms        68.59%      32.354ms       2.696ms       0.000us         0.00%      21.689ms       1.807ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.279ms        60.79%       9.279ms       4.640ms             2
                             MooreExpertsModule_forward         0.31%     144.536us        19.94%       9.407ms       4.703ms       0.000us         0.00%       8.794ms       4.397ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.240ms        47.43%       7.240ms       7.240ms             1
                                              aten::bmm         0.34%     161.106us        16.50%       7.785ms     486.536us       6.808ms        44.60%       6.827ms     426.707us            16
                                            aten::copy_         0.61%     289.955us        11.77%       5.551ms      45.498us       4.415ms        28.92%       4.415ms      36.187us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.221ms        27.65%       4.221ms     324.720us            13
                                           aten::repeat         0.04%      20.328us         9.07%       4.279ms       1.070ms       0.000us         0.00%       4.188ms       1.047ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.158ms        27.24%       4.158ms       2.079ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.267ms        21.40%       3.267ms       1.089ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.171ms
Self CUDA time total: 15.265ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.85 ms
[TIME] td_target:    4.97 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.03 ms
[TIME] compute Q:    8.57 ms
[TIME] reward loss:    3.81 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.87 ms
[TIME] grad clipping:    0.91 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   51.05 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.21%       2.507ms        63.72%      30.692ms       2.558ms       0.000us         0.00%      21.596ms       1.800ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.259ms        60.82%       9.259ms       4.630ms             2
                             MooreExpertsModule_forward         0.29%     138.712us        19.49%       9.387ms       4.693ms       0.000us         0.00%       8.755ms       4.378ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.292ms        54.47%       8.292ms       8.292ms             1
                                              aten::bmm         0.35%     169.941us        15.67%       7.548ms     471.775us       6.795ms        44.64%       6.814ms     425.891us            16
                                            aten::copy_         0.63%     303.048us        12.61%       6.076ms      49.806us       4.371ms        28.71%       4.371ms      35.829us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.177ms        27.44%       4.177ms     321.328us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.163ms        27.34%       4.163ms       2.081ms             2
                                           aten::repeat         0.05%      23.311us         8.82%       4.247ms       1.062ms       0.000us         0.00%       4.144ms       1.036ms             4
                             Torch-Compiled Region: 3/0         0.14%      68.717us        11.75%       5.658ms       1.886ms       0.000us         0.00%       2.814ms     937.952us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.169ms
Self CUDA time total: 15.224ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.86 ms
[TIME] td_target:    6.16 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.14 ms
[TIME] compute Q:    8.49 ms
[TIME] reward loss:    3.73 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.43 ms
[TIME] grad clipping:    0.88 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.75 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.21%       2.509ms        66.78%      32.130ms       2.678ms       0.000us         0.00%      21.643ms       1.804ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.458ms        68.58%      10.458ms       5.229ms             2
                             MooreExpertsModule_forward         0.29%     138.383us        22.00%      10.584ms       5.292ms       0.000us         0.00%       8.788ms       4.394ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.232ms        53.98%       8.232ms       8.232ms             1
                                              aten::bmm         0.35%     167.443us        15.68%       7.543ms     471.434us       6.767ms        44.38%       6.787ms     424.162us            16
                                            aten::copy_         0.64%     308.316us        12.59%       6.058ms      49.655us       4.442ms        29.13%       4.442ms      36.406us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.245ms        27.84%       4.245ms     326.526us            13
                                           aten::repeat         0.04%      20.997us         8.95%       4.308ms       1.077ms       0.000us         0.00%       4.211ms       1.053ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.126ms        27.06%       4.126ms       2.063ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.462us         9.85%       4.741ms       1.580ms       0.000us         0.00%       2.786ms     928.820us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.115ms
Self CUDA time total: 15.250ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.02 ms
[TIME] td_target:    5.02 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.27 ms
[TIME] compute Q:    7.74 ms
[TIME] reward loss:    4.49 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.72 ms
[TIME] grad clipping:    0.88 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   51.24 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.27%       2.550ms        68.71%      33.264ms       2.772ms       0.000us         0.00%      22.708ms       1.892ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.364ms        65.84%      10.364ms       5.182ms             2
                             MooreExpertsModule_forward         0.30%     147.110us        21.68%      10.497ms       5.249ms       0.000us         0.00%       9.334ms       4.667ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.453ms        47.35%       7.453ms       7.453ms             1
                                              aten::bmm         0.35%     171.320us        18.00%       8.715ms     544.662us       6.762ms        42.95%       6.781ms     423.809us            16
                                            aten::copy_         0.67%     322.134us        14.42%       6.982ms      57.228us       4.976ms        31.61%       4.976ms      40.785us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.781ms        30.37%       4.781ms     367.746us            13
                                           aten::repeat         0.05%      22.660us        10.02%       4.850ms       1.212ms       0.000us         0.00%       4.747ms       1.187ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.137ms        26.28%       4.137ms       2.068ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.396ms        21.57%       3.396ms       1.132ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.410ms
Self CUDA time total: 15.742ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.04 ms
[TIME] td_target:    6.19 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.05 ms
[TIME] compute Q:    8.53 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.16 ms
[TIME] backward:   11.18 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   50.46 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.532ms        67.62%      32.384ms       2.699ms       0.000us         0.00%      22.097ms       1.841ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.562ms        68.24%      10.562ms       5.281ms             2
                             MooreExpertsModule_forward         0.31%     146.093us        22.33%      10.693ms       5.347ms       0.000us         0.00%       9.000ms       4.500ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.273ms        53.45%       8.273ms       8.273ms             1
                                              aten::bmm         0.33%     160.435us        16.15%       7.733ms     483.309us       6.776ms        43.78%       6.795ms     424.706us            16
                                            aten::copy_         0.62%     298.792us        12.97%       6.210ms      50.905us       4.652ms        30.05%       4.652ms      38.128us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.456ms        28.79%       4.456ms     342.793us            13
                                           aten::repeat         0.04%      20.321us         9.44%       4.522ms       1.130ms       0.000us         0.00%       4.423ms       1.106ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.127ms        26.66%       4.127ms       2.063ms             2
                             Torch-Compiled Region: 3/0         0.14%      69.404us         9.97%       4.774ms       1.591ms       0.000us         0.00%       2.817ms     938.910us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.892ms
Self CUDA time total: 15.478ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.48 ms
[TIME] td_target:    5.01 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.13 ms
[TIME] compute Q:    8.43 ms
[TIME] reward loss:    3.56 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.14 ms
[TIME] grad clipping:    0.74 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   50.58 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.52%       3.129ms        65.37%      31.365ms       2.614ms       0.000us         0.00%      21.518ms       1.793ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.288ms        61.21%       9.288ms       4.644ms             2
                             MooreExpertsModule_forward         0.29%     138.615us        19.62%       9.414ms       4.707ms       0.000us         0.00%       8.725ms       4.362ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.175ms        53.87%       8.175ms       8.175ms             1
                                              aten::bmm         0.35%     167.539us        15.61%       7.488ms     468.024us       6.755ms        44.52%       6.774ms     423.392us            16
                                            aten::copy_         0.61%     291.895us        11.96%       5.737ms      47.023us       4.363ms        28.75%       4.363ms      35.764us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.170ms        27.48%       4.170ms     320.744us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.137ms        27.26%       4.137ms       2.068ms             2
                                           aten::repeat         0.04%      20.636us         8.82%       4.230ms       1.057ms       0.000us         0.00%       4.136ms       1.034ms             4
                             Torch-Compiled Region: 3/0         0.14%      67.257us        12.08%       5.798ms       1.933ms       0.000us         0.00%       2.796ms     931.998us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.983ms
Self CUDA time total: 15.175ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.14 ms
[TIME] td_target:    6.06 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.11 ms
[TIME] compute Q:    8.40 ms
[TIME] reward loss:    3.62 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.29 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   50.57 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.19%       2.480ms        67.57%      32.266ms       2.689ms       0.000us         0.00%      22.006ms       1.834ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.427ms        67.61%      10.427ms       5.213ms             2
                             MooreExpertsModule_forward         0.31%     149.830us        22.12%      10.561ms       5.281ms       0.000us         0.00%       8.961ms       4.481ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.148ms        52.84%       8.148ms       8.148ms             1
                                              aten::bmm         0.34%     162.458us        15.98%       7.631ms     476.914us       6.745ms        43.73%       6.763ms     422.709us            16
                                            aten::copy_         0.62%     298.153us        12.29%       5.869ms      48.103us       4.615ms        29.93%       4.615ms      37.830us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.420ms        28.66%       4.420ms     339.967us            13
                                           aten::repeat         0.05%      23.180us         9.40%       4.488ms       1.122ms       0.000us         0.00%       4.386ms       1.096ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.125ms        26.75%       4.125ms       2.063ms             2
                             Torch-Compiled Region: 3/0         0.19%      90.371us        10.14%       4.842ms       1.614ms       0.000us         0.00%       2.812ms     937.173us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.754ms
Self CUDA time total: 15.422ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.89 ms
[TIME] td_target:    4.97 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.22 ms
[TIME] compute Q:    8.32 ms
[TIME] reward loss:    3.63 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.41 ms
[TIME] grad clipping:    1.56 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   50.07 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.25%       2.496ms        65.14%      30.971ms       2.581ms       0.000us         0.00%      21.679ms       1.807ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.282ms        60.84%       9.282ms       4.641ms             2
                             MooreExpertsModule_forward         0.28%     134.882us        19.78%       9.406ms       4.703ms       0.000us         0.00%       8.798ms       4.399ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.066ms        52.87%       8.066ms       8.066ms             1
                                              aten::bmm         0.35%     164.746us        16.22%       7.711ms     481.929us       6.795ms        44.54%       6.814ms     425.884us            16
                                            aten::copy_         0.62%     294.197us        13.17%       6.262ms      51.329us       4.413ms        28.93%       4.413ms      36.175us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.218ms        27.65%       4.218ms     324.478us            13
                                           aten::repeat         0.04%      20.590us         9.00%       4.279ms       1.070ms       0.000us         0.00%       4.185ms       1.046ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.164ms        27.29%       4.164ms       2.082ms             2
                             Torch-Compiled Region: 3/0         0.13%      63.455us        12.59%       5.985ms       1.995ms       0.000us         0.00%       2.809ms     936.169us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.544ms
Self CUDA time total: 15.257ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.53 ms
[TIME] td_target:    5.11 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.77 ms
[TIME] compute Q:    7.63 ms
[TIME] reward loss:    4.38 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.41 ms
[TIME] grad clipping:    0.89 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   49.88 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.35%       2.531ms        68.61%      32.466ms       2.705ms       0.000us         0.00%      21.527ms       1.794ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.376ms        61.75%       9.376ms       4.688ms             2
                             MooreExpertsModule_forward         0.30%     140.138us        20.08%       9.502ms       4.751ms       0.000us         0.00%       8.713ms       4.356ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.376ms        48.58%       7.376ms       7.376ms             1
                                              aten::bmm         0.35%     164.904us        16.47%       7.795ms     487.214us       6.747ms        44.44%       6.766ms     422.889us            16
                                            aten::copy_         0.63%     296.396us        12.24%       5.791ms      47.464us       4.373ms        28.80%       4.373ms      35.843us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.178ms        27.51%       4.178ms     321.365us            13
                                           aten::repeat         0.04%      20.499us         8.96%       4.238ms       1.059ms       0.000us         0.00%       4.144ms       1.036ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.130ms        27.20%       4.130ms       2.065ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.305ms        21.77%       3.305ms       1.102ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.322ms
Self CUDA time total: 15.184ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.88 ms
[TIME] td_target:    5.23 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.97 ms
[TIME] compute Q:    7.87 ms
[TIME] reward loss:    3.89 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   10.84 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.97 ms
[TIME] _update total:   50.48 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.39%       2.567ms        65.49%      31.172ms       2.598ms       0.000us         0.00%      21.588ms       1.799ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.439ms        62.08%       9.439ms       4.719ms             2
                             MooreExpertsModule_forward         0.33%     158.271us        20.12%       9.577ms       4.788ms       0.000us         0.00%       8.750ms       4.375ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.570ms        49.79%       7.570ms       7.570ms             1
                                              aten::bmm         0.36%     169.890us        16.05%       7.638ms     477.345us       6.767ms        44.51%       6.786ms     424.138us            16
                                            aten::copy_         0.64%     306.738us        11.31%       5.383ms      44.120us       4.395ms        28.91%       4.395ms      36.028us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.203ms        27.64%       4.203ms     323.270us            13
                                           aten::repeat         0.05%      24.297us         8.98%       4.273ms       1.068ms       0.000us         0.00%       4.169ms       1.042ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.132ms        27.18%       4.132ms       2.066ms             2
                             Torch-Compiled Region: 3/0         0.15%      71.581us        11.66%       5.549ms       1.850ms       0.000us         0.00%       2.815ms     938.196us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.598ms
Self CUDA time total: 15.204ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.88 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.20 ms
[TIME] compute Q:    7.57 ms
[TIME] reward loss:    4.40 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.62 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.55 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.508ms        68.65%      32.890ms       2.741ms       0.000us         0.00%      22.573ms       1.881ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.261ms        65.38%      10.261ms       5.130ms             2
                             MooreExpertsModule_forward         0.29%     138.435us        21.68%      10.385ms       5.193ms       0.000us         0.00%       9.256ms       4.628ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.312ms        46.59%       7.312ms       7.312ms             1
                                              aten::bmm         0.35%     165.859us        16.33%       7.822ms     488.906us       6.777ms        43.18%       6.796ms     424.758us            16
                                            aten::copy_         0.62%     299.302us        13.05%       6.255ms      51.268us       4.899ms        31.21%       4.899ms      40.152us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.702ms        29.96%       4.702ms     361.722us            13
                                           aten::repeat         0.04%      20.672us         9.94%       4.765ms       1.191ms       0.000us         0.00%       4.669ms       1.167ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.136ms        26.36%       4.136ms       2.068ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.342ms        21.30%       3.342ms       1.114ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.913ms
Self CUDA time total: 15.693ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.09 ms
[TIME] td_target:    5.24 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.71 ms
[TIME] compute Q:    7.60 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.99 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   50.11 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.14%       2.444ms        68.56%      32.619ms       2.718ms       0.000us         0.00%      23.034ms       1.920ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.756ms        67.50%      10.756ms       5.378ms             2
                             MooreExpertsModule_forward         0.28%     135.379us        22.86%      10.879ms       5.439ms       0.000us         0.00%       9.471ms       4.735ms             2
                                              aten::bmm         0.34%     162.479us        16.92%       8.049ms     503.032us       7.378ms        46.30%       7.397ms     462.329us            16
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.355ms        46.16%       7.355ms       7.355ms             1
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.743ms        29.76%       4.743ms       2.371ms             2
                                            aten::copy_         0.61%     289.034us        11.95%       5.685ms      46.595us       4.515ms        28.33%       4.515ms      37.004us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.319ms        27.10%       4.319ms     332.218us            13
                                           aten::repeat         0.04%      19.909us         9.20%       4.376ms       1.094ms       0.000us         0.00%       4.285ms       1.071ms             4
                             Torch-Compiled Region: 3/0         0.14%      65.754us         9.97%       4.742ms       1.581ms       0.000us         0.00%       2.817ms     938.889us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.581ms
Self CUDA time total: 15.935ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.90 ms
[TIME] td_target:    5.00 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.69 ms
[TIME] compute Q:    8.64 ms
[TIME] reward loss:    3.86 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.25 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   51.30 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.34%       2.582ms        65.01%      31.442ms       2.620ms       0.000us         0.00%      21.558ms       1.797ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.261ms        60.96%       9.261ms       4.631ms             2
                             MooreExpertsModule_forward         0.30%     146.470us        19.42%       9.393ms       4.696ms       0.000us         0.00%       8.749ms       4.375ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.321ms        54.78%       8.321ms       8.321ms             1
                                              aten::bmm         0.36%     174.796us        15.23%       7.364ms     460.241us       6.778ms        44.62%       6.797ms     424.806us            16
                                            aten::copy_         0.64%     307.824us        11.94%       5.775ms      47.337us       4.384ms        28.86%       4.384ms      35.933us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.189ms        27.57%       4.189ms     322.224us            13
                                           aten::repeat         0.05%      24.462us         8.81%       4.260ms       1.065ms       0.000us         0.00%       4.155ms       1.039ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.143ms        27.27%       4.143ms       2.072ms             2
                             Torch-Compiled Region: 3/0         0.15%      70.620us        12.88%       6.231ms       2.077ms       0.000us         0.00%       2.784ms     927.978us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.365ms
Self CUDA time total: 15.192ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.95 ms
[TIME] td_target:    5.09 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.93 ms
[TIME] compute Q:    8.26 ms
[TIME] reward loss:    3.62 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.52 ms
[TIME] grad clipping:    1.57 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   49.99 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.26%       2.493ms        65.28%      30.936ms       2.578ms       0.000us         0.00%      22.007ms       1.834ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.437ms        61.18%       9.437ms       4.718ms             2
                             MooreExpertsModule_forward         0.30%     142.291us        20.19%       9.567ms       4.783ms       0.000us         0.00%       8.955ms       4.477ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.004ms        51.89%       8.004ms       8.004ms             1
                                              aten::bmm         0.34%     163.379us        15.12%       7.165ms     447.833us       6.775ms        43.93%       6.794ms     424.614us            16
                                            aten::copy_         0.64%     302.252us        13.03%       6.175ms      50.612us       4.590ms        29.76%       4.590ms      37.627us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.397ms        28.51%       4.397ms     338.246us            13
                                           aten::repeat         0.04%      20.801us         9.41%       4.460ms       1.115ms       0.000us         0.00%       4.364ms       1.091ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.140ms        26.85%       4.140ms       2.070ms             2
                             Torch-Compiled Region: 3/0         0.14%      64.832us        11.86%       5.621ms       1.874ms       0.000us         0.00%       2.825ms     941.504us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.390ms
Self CUDA time total: 15.423ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.93 ms
[TIME] td_target:    4.99 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.47 ms
[TIME] compute Q:    7.86 ms
[TIME] reward loss:    3.84 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.68 ms
[TIME] grad clipping:    0.85 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   51.73 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.25%       2.573ms        66.46%      32.547ms       2.712ms       0.000us         0.00%      22.139ms       1.845ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.316ms        66.67%      10.316ms       5.158ms             2
                             MooreExpertsModule_forward         0.29%     142.159us        21.33%      10.444ms       5.222ms       0.000us         0.00%       9.042ms       4.521ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.581ms        48.99%       7.581ms       7.581ms             1
                                              aten::bmm         0.36%     177.428us        16.44%       8.053ms     503.282us       7.043ms        45.51%       7.062ms     441.349us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.457ms        28.80%       4.457ms       2.228ms             2
                                            aten::copy_         0.63%     306.823us        12.56%       6.149ms      50.400us       4.363ms        28.19%       4.363ms      35.759us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.168ms        26.94%       4.168ms     320.624us            13
                                           aten::repeat         0.05%      22.974us         8.65%       4.234ms       1.059ms       0.000us         0.00%       4.133ms       1.033ms             4
                             Torch-Compiled Region: 3/0         0.14%      66.823us        10.77%       5.276ms       1.759ms       0.000us         0.00%       2.792ms     930.774us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.974ms
Self CUDA time total: 15.474ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.84 ms
[TIME] td_target:    5.98 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.07 ms
[TIME] compute Q:    8.40 ms
[TIME] reward loss:    3.66 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.88 ms
[TIME] grad clipping:    0.88 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   49.83 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.27%       2.487ms        67.01%      31.629ms       2.636ms       0.000us         0.00%      21.624ms       1.802ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.192ms        66.94%      10.192ms       5.096ms             2
                             MooreExpertsModule_forward         0.29%     136.383us        21.86%      10.317ms       5.158ms       0.000us         0.00%       8.776ms       4.388ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.133ms        53.41%       8.133ms       8.133ms             1
                                              aten::bmm         0.35%     163.385us        15.67%       7.399ms     462.414us       6.800ms        44.66%       6.819ms     426.174us            16
                                            aten::copy_         0.62%     293.584us        14.49%       6.841ms      56.073us       4.394ms        28.86%       4.394ms      36.017us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.199ms        27.58%       4.199ms     323.014us            13
                                           aten::repeat         0.04%      20.769us         9.03%       4.260ms       1.065ms       0.000us         0.00%       4.164ms       1.041ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.159ms        27.32%       4.159ms       2.080ms             2
                             Torch-Compiled Region: 3/0         0.14%      67.251us        10.09%       4.763ms       1.588ms       0.000us         0.00%       2.796ms     931.967us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.202ms
Self CUDA time total: 15.227ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.43 ms
[TIME] td_target:    4.99 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.54 ms
[TIME] compute Q:    7.56 ms
[TIME] reward loss:    4.43 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.13 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   49.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.33%       2.522ms        67.23%      31.806ms       2.651ms       0.000us         0.00%      21.658ms       1.805ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.240ms        60.46%       9.240ms       4.620ms             2
                             MooreExpertsModule_forward         0.30%     141.361us        19.80%       9.369ms       4.685ms       0.000us         0.00%       8.754ms       4.377ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.288ms        47.69%       7.288ms       7.288ms             1
                                              aten::bmm         0.35%     163.933us        16.31%       7.718ms     482.378us       6.771ms        44.31%       6.790ms     424.384us            16
                                            aten::copy_         0.62%     291.723us        12.78%       6.049ms      49.579us       4.402ms        28.81%       4.402ms      36.085us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.209ms        27.54%       4.209ms     323.752us            13
                                           aten::repeat         0.04%      20.684us         9.02%       4.269ms       1.067ms       0.000us         0.00%       4.175ms       1.044ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.140ms        27.09%       4.140ms       2.070ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.994us        13.13%       6.212ms       2.071ms       0.000us         0.00%       2.867ms     955.669us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.312ms
Self CUDA time total: 15.283ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.91 ms
[TIME] td_target:    5.68 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.52 ms
[TIME] compute Q:    8.61 ms
[TIME] reward loss:    3.85 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.42 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   50.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.33%       2.566ms        65.94%      31.728ms       2.644ms       0.000us         0.00%      21.657ms       1.805ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.989ms        65.49%       9.989ms       4.994ms             2
                             MooreExpertsModule_forward         0.29%     137.468us        21.02%      10.114ms       5.057ms       0.000us         0.00%       8.787ms       4.393ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.322ms        54.56%       8.322ms       8.322ms             1
                                              aten::bmm         0.36%     173.528us        15.49%       7.451ms     465.707us       6.746ms        44.23%       6.764ms     422.781us            16
                                            aten::copy_         0.62%     300.584us        12.83%       6.172ms      50.587us       4.420ms        28.98%       4.420ms      36.230us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.225ms        27.70%       4.225ms     325.037us            13
                                           aten::repeat         0.05%      23.198us         8.92%       4.294ms       1.073ms       0.000us         0.00%       4.191ms       1.048ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.143ms        27.17%       4.143ms       2.072ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.939us        10.68%       5.137ms       1.712ms       0.000us         0.00%       2.817ms     938.922us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.115ms
Self CUDA time total: 15.253ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.85 ms
[TIME] td_target:    4.99 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.58 ms
[TIME] compute Q:    8.37 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.22 ms
[TIME] grad clipping:    1.69 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   49.39 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.34%       2.496ms        64.70%      30.234ms       2.520ms       0.000us         0.00%      21.541ms       1.795ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.247ms        60.84%       9.247ms       4.623ms             2
                             MooreExpertsModule_forward         0.31%     144.332us        20.07%       9.376ms       4.688ms       0.000us         0.00%       8.716ms       4.358ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.115ms        53.39%       8.115ms       8.115ms             1
                                              aten::bmm         0.35%     165.406us        15.74%       7.357ms     459.788us       6.792ms        44.69%       6.811ms     425.716us            16
                                            aten::copy_         0.64%     299.106us        13.74%       6.420ms      52.620us       4.364ms        28.72%       4.364ms      35.773us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.169ms        27.43%       4.169ms     320.722us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.139ms        27.23%       4.139ms       2.070ms             2
                                           aten::repeat         0.04%      20.339us         9.06%       4.232ms       1.058ms       0.000us         0.00%       4.136ms       1.034ms             4
                             Torch-Compiled Region: 3/0         0.14%      65.378us        11.41%       5.330ms       1.777ms       0.000us         0.00%       2.838ms     945.855us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.728ms
Self CUDA time total: 15.199ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.61 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.39 ms
[TIME] compute Q:    7.60 ms
[TIME] reward loss:    4.23 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.57 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   50.20 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.19%       2.470ms        69.67%      33.173ms       2.764ms       0.000us         0.00%      21.720ms       1.810ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.289ms        60.76%       9.289ms       4.644ms             2
                             MooreExpertsModule_forward         0.29%     139.184us        19.78%       9.419ms       4.709ms       0.000us         0.00%       8.804ms       4.402ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.342ms        48.03%       7.342ms       7.342ms             1
                                              aten::bmm         0.34%     161.766us        15.94%       7.590ms     474.350us       6.837ms        44.72%       6.857ms     428.537us            16
                                            aten::copy_         0.62%     294.045us        11.30%       5.382ms      44.113us       4.418ms        28.90%       4.418ms      36.217us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.224ms        27.63%       4.224ms     324.892us            13
                                           aten::repeat         0.04%      20.658us         9.00%       4.284ms       1.071ms       0.000us         0.00%       4.190ms       1.048ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.165ms        27.25%       4.165ms       2.083ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.185ms        20.83%       3.185ms       1.062ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.616ms
Self CUDA time total: 15.288ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.92 ms
[TIME] td_target:    4.95 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.56 ms
[TIME] compute Q:    8.51 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.59 ms
[TIME] grad clipping:    0.85 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   51.27 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.531ms        64.43%      31.202ms       2.600ms       0.000us         0.00%      21.587ms       1.799ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.257ms        60.81%       9.257ms       4.628ms             2
                             MooreExpertsModule_forward         0.29%     140.072us        19.38%       9.383ms       4.691ms       0.000us         0.00%       8.749ms       4.375ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.208ms        53.92%       8.208ms       8.208ms             1
                                              aten::bmm         0.35%     171.425us        17.05%       8.255ms     515.936us       6.762ms        44.42%       6.780ms     423.771us            16
                                            aten::copy_         0.66%     318.565us        13.83%       6.696ms      54.886us       4.385ms        28.80%       4.385ms      35.940us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.190ms        27.53%       4.190ms     322.305us            13
                                           aten::repeat         0.05%      24.487us         8.80%       4.260ms       1.065ms       0.000us         0.00%       4.157ms       1.039ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.142ms        27.21%       4.142ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.13%      64.334us        12.63%       6.118ms       2.039ms       0.000us         0.00%       2.815ms     938.175us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.427ms
Self CUDA time total: 15.222ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.00 ms
[TIME] td_target:    5.01 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.51 ms
[TIME] compute Q:    7.65 ms
[TIME] reward loss:    4.43 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.45 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.03 ms
[TIME] _update total:   49.93 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.38%       2.546ms        67.94%      32.164ms       2.680ms       0.000us         0.00%      21.571ms       1.798ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.239ms        60.74%       9.239ms       4.619ms             2
                             MooreExpertsModule_forward         0.32%     153.191us        19.82%       9.382ms       4.691ms       0.000us         0.00%       8.728ms       4.364ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.390ms        48.59%       7.390ms       7.390ms             1
                                              aten::bmm         0.35%     165.933us        16.48%       7.801ms     487.590us       6.798ms        44.69%       6.817ms     426.041us            16
                                            aten::copy_         0.63%     297.618us        11.66%       5.521ms      45.254us       4.363ms        28.68%       4.363ms      35.762us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.170ms        27.42%       4.170ms     320.784us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.141ms        27.23%       4.141ms       2.071ms             2
                                           aten::repeat         0.05%      22.043us         8.95%       4.237ms       1.059ms       0.000us         0.00%       4.136ms       1.034ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.385ms        22.25%       3.385ms       1.128ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.340ms
Self CUDA time total: 15.210ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.91 ms
[TIME] td_target:    4.95 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.15 ms
[TIME] compute Q:    7.58 ms
[TIME] reward loss:    3.51 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.00 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   49.95 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.13%       2.433ms        67.73%      32.123ms       2.677ms       0.000us         0.00%      22.207ms       1.851ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.328ms        66.50%      10.328ms       5.164ms             2
                             MooreExpertsModule_forward         0.29%     137.375us        22.04%      10.454ms       5.227ms       0.000us         0.00%       9.061ms       4.531ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.334ms        47.22%       7.334ms       7.334ms             1
                                              aten::bmm         0.34%     160.230us        16.78%       7.960ms     497.498us       7.115ms        45.81%       7.134ms     445.891us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.472ms        28.79%       4.472ms       2.236ms             2
                                            aten::copy_         0.61%     288.809us        12.63%       5.990ms      49.098us       4.366ms        28.11%       4.366ms      35.787us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.171ms        26.86%       4.171ms     320.860us            13
                                           aten::repeat         0.04%      19.800us         8.91%       4.228ms       1.057ms       0.000us         0.00%       4.137ms       1.034ms             4
                             Torch-Compiled Region: 3/0         0.14%      65.978us        10.97%       5.204ms       1.735ms       0.000us         0.00%       2.805ms     934.997us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.428ms
Self CUDA time total: 15.531ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.78 ms
[TIME] td_target:    4.98 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.05 ms
[TIME] compute Q:    7.70 ms
[TIME] reward loss:    4.23 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.47 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.84 ms
[TIME] _update total:   49.77 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.461ms        66.21%      31.159ms       2.597ms       0.000us         0.00%      21.601ms       1.800ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.252ms        60.76%       9.252ms       4.626ms             2
                             MooreExpertsModule_forward         0.30%     142.405us        19.93%       9.378ms       4.689ms       0.000us         0.00%       8.750ms       4.375ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.452ms        48.94%       7.452ms       7.452ms             1
                                              aten::bmm         0.34%     161.512us        16.40%       7.720ms     482.501us       6.777ms        44.51%       6.796ms     424.744us            16
                                            aten::copy_         0.61%     285.689us        12.03%       5.661ms      46.403us       4.383ms        28.78%       4.383ms      35.925us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.189ms        27.51%       4.189ms     322.243us            13
                                           aten::repeat         0.05%      22.439us         9.05%       4.258ms       1.064ms       0.000us         0.00%       4.156ms       1.039ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.145ms        27.22%       4.145ms       2.072ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.835ms        18.62%       2.835ms     945.087us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.062ms
Self CUDA time total: 15.226ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.84 ms
[TIME] td_target:    5.47 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.69 ms
[TIME] compute Q:    7.65 ms
[TIME] reward loss:    3.63 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.10 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   50.37 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.22%       2.491ms        68.41%      32.651ms       2.721ms       0.000us         0.00%      22.951ms       1.913ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.742ms        67.60%      10.742ms       5.371ms             2
                             MooreExpertsModule_forward         0.30%     144.717us        22.78%      10.872ms       5.436ms       0.000us         0.00%       9.444ms       4.722ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.395ms        46.54%       7.395ms       7.395ms             1
                                              aten::bmm         0.34%     164.070us        15.97%       7.622ms     476.383us       7.227ms        45.48%       7.247ms     452.912us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.607ms        28.99%       4.607ms       2.303ms             2
                                            aten::copy_         0.61%     290.192us        12.52%       5.978ms      48.996us       4.593ms        28.91%       4.593ms      37.648us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.399ms        27.68%       4.399ms     338.361us            13
                                           aten::repeat         0.04%      20.798us         9.63%       4.594ms       1.149ms       0.000us         0.00%       4.365ms       1.091ms             4
                             Torch-Compiled Region: 3/0         0.14%      66.795us         9.98%       4.763ms       1.588ms       0.000us         0.00%       2.784ms     928.137us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.730ms
Self CUDA time total: 15.890ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.90 ms
[TIME] td_target:    4.99 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.18 ms
[TIME] compute Q:    8.62 ms
[TIME] reward loss:    3.80 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   13.47 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   53.00 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.14%       2.579ms        61.51%      30.857ms       2.571ms       0.000us         0.00%      21.537ms       1.795ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.239ms        60.82%       9.239ms       4.620ms             2
                             MooreExpertsModule_forward         0.28%     142.438us        18.67%       9.368ms       4.684ms       0.000us         0.00%       8.736ms       4.368ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.292ms        54.59%       8.292ms       8.292ms             1
                                              aten::bmm         0.34%     168.134us        14.60%       7.323ms     457.676us       6.780ms        44.63%       6.799ms     424.946us            16
                                            aten::copy_         0.61%     308.119us        11.00%       5.517ms      45.219us       4.372ms        28.78%       4.372ms      35.838us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.177ms        27.50%       4.177ms     321.318us            13
                                           aten::repeat         0.05%      25.220us         8.47%       4.248ms       1.062ms       0.000us         0.00%       4.144ms       1.036ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.142ms        27.27%       4.142ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.14%      69.618us        11.49%       5.763ms       1.921ms       0.000us         0.00%       2.791ms     930.315us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.167ms
Self CUDA time total: 15.191ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    9.72 ms
[TIME] td_target:    4.92 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.88 ms
[TIME] compute Q:    9.40 ms
[TIME] reward loss:    4.04 ms
[TIME] value loss:    0.80 ms
[TIME] backward:   10.10 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   53.73 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.07%       2.587ms        66.75%      34.071ms       2.839ms       0.000us         0.00%      22.277ms       1.856ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.302ms        66.21%      10.302ms       5.151ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.137ms        58.72%       9.137ms       9.137ms             1
                             MooreExpertsModule_forward         0.29%     147.906us        20.45%      10.436ms       5.218ms       0.000us         0.00%       9.105ms       4.553ms             2
                                              aten::bmm         0.34%     171.856us        14.99%       7.652ms     478.236us       7.112ms        45.70%       7.131ms     445.671us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.473ms        28.74%       4.473ms       2.236ms             2
                                            aten::copy_         0.60%     306.209us        14.45%       7.377ms      60.465us       4.410ms        28.34%       4.410ms      36.149us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.215ms        27.09%       4.215ms     324.262us            13
                                           aten::repeat         0.04%      21.845us         8.38%       4.279ms       1.070ms       0.000us         0.00%       4.180ms       1.045ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.916ms        18.74%       2.916ms     972.160us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.038ms
Self CUDA time total: 15.560ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.83 ms
[TIME] td_target:    5.54 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.86 ms
[TIME] compute Q:    7.91 ms
[TIME] reward loss:    3.95 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   12.96 ms
[TIME] grad clipping:    1.03 ms
[TIME] optim.step:    1.12 ms
[TIME] _update total:   55.03 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.98%       2.568ms        63.27%      32.617ms       2.718ms       0.000us         0.00%      21.677ms       1.806ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.832ms        64.39%       9.832ms       4.916ms             2
                             MooreExpertsModule_forward         0.27%     137.229us        19.31%       9.957ms       4.979ms       0.000us         0.00%       8.792ms       4.396ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.584ms        49.67%       7.584ms       7.584ms             1
                                              aten::bmm         0.33%     171.746us        14.15%       7.293ms     455.794us       6.728ms        44.06%       6.747ms     421.694us            16
                                            aten::copy_         0.59%     303.159us        12.07%       6.222ms      51.001us       4.444ms        29.10%       4.444ms      36.424us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.250ms        27.83%       4.250ms     326.896us            13
                                           aten::repeat         0.04%      19.879us         8.35%       4.305ms       1.076ms       0.000us         0.00%       4.214ms       1.054ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.131ms        27.05%       4.131ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.13%      65.459us        12.34%       6.362ms       2.121ms       0.000us         0.00%       2.835ms     945.152us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.556ms
Self CUDA time total: 15.269ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.87 ms
[TIME] td_target:    7.14 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.05 ms
[TIME] compute Q:    7.81 ms
[TIME] reward loss:    4.52 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   13.88 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.11 ms
[TIME] _update total:   56.34 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.93%       2.631ms        70.00%      37.360ms       3.113ms       0.000us         0.00%      23.022ms       1.918ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      12.022ms        75.43%      12.022ms       6.011ms             2
                             MooreExpertsModule_forward         0.30%     159.355us        22.79%      12.163ms       6.081ms       0.000us         0.00%       9.469ms       4.735ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.503ms        47.07%       7.503ms       7.503ms             1
                                              aten::bmm         0.33%     174.582us        16.15%       8.619ms     538.701us       7.263ms        45.57%       7.282ms     455.105us            16
                                            aten::copy_         0.60%     319.126us        12.65%       6.753ms      55.355us       4.640ms        29.11%       4.640ms      38.031us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.606ms        28.90%       4.606ms       2.303ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.447ms        27.90%       4.447ms     342.091us            13
                                           aten::repeat         0.04%      23.546us         8.46%       4.516ms       1.129ms       0.000us         0.00%       4.414ms       1.103ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.388ms        21.26%       3.388ms       1.129ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.370ms
Self CUDA time total: 15.939ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.04 ms
[TIME] td_target:    6.82 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.12 ms
[TIME] compute Q:    8.74 ms
[TIME] reward loss:    3.95 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   12.66 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   54.31 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.99%       2.579ms        67.55%      34.902ms       2.909ms       0.000us         0.00%      21.844ms       1.820ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.159ms        72.62%      11.159ms       5.580ms             2
                             MooreExpertsModule_forward         0.28%     143.253us        21.85%      11.290ms       5.645ms       0.000us         0.00%       8.873ms       4.437ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.469ms        55.11%       8.469ms       8.469ms             1
                                              aten::bmm         0.33%     168.026us        17.02%       8.795ms     549.704us       6.766ms        44.03%       6.786ms     424.108us            16
                                            aten::copy_         0.59%     302.292us        13.83%       7.148ms      58.589us       4.523ms        29.44%       4.523ms      37.076us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.327ms        28.16%       4.327ms     332.835us            13
                                           aten::repeat         0.04%      21.420us         8.50%       4.392ms       1.098ms       0.000us         0.00%       4.293ms       1.073ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.143ms        26.96%       4.143ms       2.072ms             2
                             Torch-Compiled Region: 3/0         0.13%      67.090us        11.12%       5.747ms       1.916ms       0.000us         0.00%       2.818ms     939.411us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.667ms
Self CUDA time total: 15.366ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.88 ms
[TIME] td_target:    6.88 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.01 ms
[TIME] compute Q:    7.80 ms
[TIME] reward loss:    4.18 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   12.37 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.90 ms
[TIME] _update total:   54.87 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.76%       2.489ms        69.52%      36.319ms       3.027ms       0.000us         0.00%      22.713ms       1.893ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      12.215ms        77.34%      12.215ms       6.107ms             2
                             MooreExpertsModule_forward         0.27%     143.545us        23.63%      12.345ms       6.173ms       0.000us         0.00%       9.306ms       4.653ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.545ms        47.78%       7.545ms       7.545ms             1
                                              aten::bmm         0.32%     166.707us        16.33%       8.528ms     533.029us       6.765ms        42.83%       6.784ms     424.010us            16
                                            aten::copy_         0.57%     298.985us        13.71%       7.163ms      58.711us       5.002ms        31.67%       5.002ms      41.000us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.806ms        30.43%       4.806ms     369.690us            13
                                           aten::repeat         0.04%      20.425us        11.58%       6.050ms       1.513ms       0.000us         0.00%       4.773ms       1.193ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.123ms        26.11%       4.123ms       2.061ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.846ms        18.02%       2.846ms     948.661us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.241ms
Self CUDA time total: 15.793ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    8.17 ms
[TIME] td_target:    7.04 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.26 ms
[TIME] compute Q:    7.81 ms
[TIME] reward loss:    4.48 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   12.86 ms
[TIME] grad clipping:    1.60 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   56.37 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.74%       2.526ms        68.81%      36.680ms       3.057ms       0.000us         0.00%      23.238ms       1.936ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      12.445ms        77.45%      12.445ms       6.222ms             2
                             MooreExpertsModule_forward         0.28%     146.848us        23.59%      12.573ms       6.287ms       0.000us         0.00%       9.564ms       4.782ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.510ms        46.74%       7.510ms       7.510ms             1
                                              aten::bmm         0.32%     169.326us        17.75%       9.460ms     591.276us       7.357ms        45.79%       7.376ms     461.013us            16
                                            aten::copy_         0.59%     313.416us        12.83%       6.840ms      56.064us       4.672ms        29.08%       4.672ms      38.294us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.671ms        29.07%       4.671ms       2.335ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.477ms        27.87%       4.477ms     344.405us            13
                                           aten::repeat         0.04%      22.993us         8.53%       4.546ms       1.136ms       0.000us         0.00%       4.443ms       1.111ms             4
                             Torch-Compiled Region: 3/0         0.13%      67.931us         9.39%       5.004ms       1.668ms       0.000us         0.00%       2.825ms     941.769us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.307ms
Self CUDA time total: 16.067ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:   10.46 ms
[TIME] td_target:    4.87 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.92 ms
[TIME] compute Q:   10.37 ms
[TIME] reward loss:    4.04 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.82 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   55.34 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.86%       2.563ms        71.84%      37.866ms       3.156ms       0.000us         0.00%      23.020ms       1.918ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.097ms        63.31%      10.097ms      10.097ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.827ms        61.62%       9.827ms       4.914ms             2
                             MooreExpertsModule_forward         0.27%     144.222us        18.89%       9.960ms       4.980ms       0.000us         0.00%       9.466ms       4.733ms             2
                                              aten::bmm         0.32%     166.896us        14.55%       7.667ms     479.195us       7.106ms        44.56%       7.125ms     445.317us            16
                                            aten::copy_         0.58%     307.363us        12.89%       6.795ms      55.696us       4.748ms        29.77%       4.748ms      38.920us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.552ms        28.54%       4.552ms     350.145us            13
                                           aten::repeat         0.04%      20.822us         8.75%       4.614ms       1.153ms       0.000us         0.00%       4.518ms       1.130ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.501ms        28.22%       4.501ms       2.250ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.845ms        17.84%       2.845ms     948.458us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.713ms
Self CUDA time total: 15.948ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.90 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.31 ms
[TIME] compute Q:    8.70 ms
[TIME] reward loss:    3.74 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.22 ms
[TIME] grad clipping:    1.43 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   50.36 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.26%       2.515ms        64.75%      30.930ms       2.578ms       0.000us         0.00%      21.680ms       1.807ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.257ms        60.51%       9.257ms       4.628ms             2
                             MooreExpertsModule_forward         0.29%     139.486us        19.65%       9.385ms       4.693ms       0.000us         0.00%       8.769ms       4.384ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.425ms        55.08%       8.425ms       8.425ms             1
                                              aten::bmm         0.35%     166.855us        15.72%       7.510ms     469.396us       6.792ms        44.40%       6.812ms     425.722us            16
                                            aten::copy_         0.62%     295.476us        12.23%       5.844ms      47.902us       4.393ms        28.72%       4.393ms      36.008us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.199ms        27.45%       4.199ms     322.999us            13
                                           aten::repeat         0.04%      20.695us         8.92%       4.259ms       1.065ms       0.000us         0.00%       4.166ms       1.041ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.155ms        27.17%       4.155ms       2.078ms             2
                             Torch-Compiled Region: 3/0         0.13%      64.188us        12.32%       5.887ms       1.962ms       0.000us         0.00%       2.864ms     954.699us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.771ms
Self CUDA time total: 15.297ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.89 ms
[TIME] td_target:    5.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.67 ms
[TIME] compute Q:    8.32 ms
[TIME] reward loss:    3.90 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.26 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   52.70 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.11%       2.548ms        63.37%      31.592ms       2.633ms       0.000us         0.00%      21.563ms       1.797ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.699ms        63.81%       9.699ms       4.850ms             2
                             MooreExpertsModule_forward         0.29%     145.026us        19.72%       9.832ms       4.916ms       0.000us         0.00%       8.745ms       4.372ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.044ms        52.92%       8.044ms       8.044ms             1
                                              aten::bmm         0.36%     177.181us        15.00%       7.479ms     467.435us       6.780ms        44.61%       6.799ms     424.958us            16
                                            aten::copy_         0.64%     317.613us        13.20%       6.579ms      53.928us       4.371ms        28.76%       4.371ms      35.825us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.176ms        27.47%       4.176ms     321.227us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.151ms        27.31%       4.151ms       2.076ms             2
                                           aten::repeat         0.05%      23.603us         8.52%       4.246ms       1.061ms       0.000us         0.00%       4.142ms       1.035ms             4
                             Torch-Compiled Region: 3/0         0.14%      71.843us        10.48%       5.225ms       1.742ms       0.000us         0.00%       2.798ms     932.756us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.852ms
Self CUDA time total: 15.200ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.93 ms
[TIME] td_target:    4.98 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.10 ms
[TIME] compute Q:    8.10 ms
[TIME] reward loss:    3.58 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.27 ms
[TIME] grad clipping:    1.55 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   49.81 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.35%       2.514ms        65.71%      30.897ms       2.575ms       0.000us         0.00%      21.660ms       1.805ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.281ms        60.85%       9.281ms       4.640ms             2
                             MooreExpertsModule_forward         0.31%     144.063us        20.02%       9.412ms       4.706ms       0.000us         0.00%       8.783ms       4.391ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.848ms        51.45%       7.848ms       7.848ms             1
                                              aten::bmm         0.36%     167.606us        16.56%       7.784ms     486.506us       6.779ms        44.45%       6.799ms     424.916us            16
                                            aten::copy_         0.62%     291.816us        13.50%       6.348ms      52.032us       4.408ms        28.90%       4.408ms      36.129us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.213ms        27.63%       4.213ms     324.099us            13
                                           aten::repeat         0.04%      21.086us         9.10%       4.277ms       1.069ms       0.000us         0.00%       4.180ms       1.045ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.158ms        27.27%       4.158ms       2.079ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.912us        12.47%       5.864ms       1.955ms       0.000us         0.00%       2.818ms     939.358us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.017ms
Self CUDA time total: 15.251ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.83 ms
[TIME] td_target:    5.32 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.20 ms
[TIME] compute Q:    8.38 ms
[TIME] reward loss:    3.77 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   10.73 ms
[TIME] grad clipping:    1.64 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   51.04 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.31%       2.562ms        65.20%      31.439ms       2.620ms       0.000us         0.00%      21.535ms       1.795ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.541ms        62.80%       9.541ms       4.771ms             2
                             MooreExpertsModule_forward         0.31%     148.207us        20.06%       9.670ms       4.835ms       0.000us         0.00%       8.729ms       4.365ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.078ms        53.17%       8.078ms       8.078ms             1
                                              aten::bmm         0.35%     166.467us        16.78%       8.089ms     505.560us       6.765ms        44.53%       6.784ms     423.976us            16
                                            aten::copy_         0.63%     305.160us        12.89%       6.216ms      50.948us       4.377ms        28.81%       4.377ms      35.874us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.184ms        27.54%       4.184ms     321.810us            13
                                           aten::repeat         0.05%      24.181us         8.82%       4.253ms       1.063ms       0.000us         0.00%       4.150ms       1.038ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.129ms        27.18%       4.129ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.17%      80.621us        12.11%       5.840ms       1.947ms       0.000us         0.00%       2.803ms     934.207us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.219ms
Self CUDA time total: 15.192ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.87 ms
[TIME] td_target:    5.28 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.56 ms
[TIME] compute Q:    7.73 ms
[TIME] reward loss:    3.63 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.18 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   50.21 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.515ms        67.88%      32.288ms       2.691ms       0.000us         0.00%      22.823ms       1.902ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.520ms        66.43%      10.520ms       5.260ms             2
                             MooreExpertsModule_forward         0.30%     144.420us        22.39%      10.649ms       5.324ms       0.000us         0.00%       9.364ms       4.682ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.470ms        47.17%       7.470ms       7.470ms             1
                                              aten::bmm         0.35%     164.708us        16.18%       7.694ms     480.902us       7.298ms        46.09%       7.317ms     457.331us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.667ms        29.47%       4.667ms       2.333ms             2
                                            aten::copy_         0.62%     296.147us        12.21%       5.806ms      47.593us       4.484ms        28.32%       4.484ms      36.754us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.290ms        27.09%       4.290ms     330.024us            13
                                           aten::repeat         0.04%      21.063us         9.15%       4.353ms       1.088ms       0.000us         0.00%       4.256ms       1.064ms             4
                             Torch-Compiled Region: 3/0         0.13%      64.140us        10.03%       4.770ms       1.590ms       0.000us         0.00%       2.819ms     939.700us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.564ms
Self CUDA time total: 15.836ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.90 ms
[TIME] td_target:    5.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.34 ms
[TIME] compute Q:    8.28 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.63 ms
[TIME] grad clipping:    0.88 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   49.47 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.40%       2.532ms        67.19%      31.504ms       2.625ms       0.000us         0.00%      21.632ms       1.803ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.965ms        65.39%       9.965ms       4.983ms             2
                             MooreExpertsModule_forward         0.32%     148.424us        21.54%      10.100ms       5.050ms       0.000us         0.00%       8.774ms       4.387ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.028ms        52.68%       8.028ms       8.028ms             1
                                              aten::bmm         0.35%     163.760us        15.90%       7.458ms     466.095us       6.757ms        44.34%       6.776ms     423.530us            16
                                            aten::copy_         0.62%     291.144us        13.44%       6.302ms      51.654us       4.424ms        29.03%       4.424ms      36.263us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.228ms        27.74%       4.228ms     325.234us            13
                                           aten::repeat         0.05%      21.160us         9.15%       4.291ms       1.073ms       0.000us         0.00%       4.194ms       1.048ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.131ms        27.11%       4.131ms       2.066ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.083us        10.91%       5.115ms       1.705ms       0.000us         0.00%       2.809ms     936.394us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.890ms
Self CUDA time total: 15.239ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.97 ms
[TIME] td_target:    5.24 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.76 ms
[TIME] compute Q:    8.50 ms
[TIME] reward loss:    3.82 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.58 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.12 ms
[TIME] _update total:   50.87 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.31%       2.554ms        64.76%      31.167ms       2.597ms       0.000us         0.00%      21.871ms       1.823ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.564ms        62.22%       9.564ms       4.782ms             2
                             MooreExpertsModule_forward         0.31%     147.425us        20.15%       9.698ms       4.849ms       0.000us         0.00%       8.885ms       4.442ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.219ms        53.47%       8.219ms       8.219ms             1
                                              aten::bmm         0.36%     172.980us        15.31%       7.369ms     460.555us       6.805ms        44.27%       6.824ms     426.503us            16
                                            aten::copy_         0.66%     319.952us        13.20%       6.355ms      52.086us       4.542ms        29.55%       4.542ms      37.227us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.346ms        28.27%       4.346ms     334.298us            13
                                           aten::repeat         0.05%      23.233us         9.18%       4.417ms       1.104ms       0.000us         0.00%       4.312ms       1.078ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.135ms        26.90%       4.135ms       2.068ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.127us        11.10%       5.343ms       1.781ms       0.000us         0.00%       2.832ms     943.882us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.128ms
Self CUDA time total: 15.372ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    7.02 ms
[TIME] td_target:    5.95 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.93 ms
[TIME] compute Q:    7.76 ms
[TIME] reward loss:    3.66 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   11.27 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   50.55 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.30%       2.539ms        65.24%      31.265ms       2.605ms       0.000us         0.00%      21.987ms       1.832ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.564ms        62.02%       9.564ms       4.782ms             2
                             MooreExpertsModule_forward         0.31%     149.890us        20.37%       9.764ms       4.882ms       0.000us         0.00%       8.950ms       4.475ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.503ms        48.65%       7.503ms       7.503ms             1
                                              aten::bmm         0.35%     166.292us        15.00%       7.188ms     449.259us       6.787ms        44.01%       6.807ms     425.409us            16
                                            aten::copy_         0.63%     304.009us        12.39%       5.936ms      48.657us       4.587ms        29.75%       4.587ms      37.600us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.392ms        28.48%       4.392ms     337.810us            13
                                           aten::repeat         0.04%      21.074us         9.30%       4.456ms       1.114ms       0.000us         0.00%       4.357ms       1.089ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.153ms        26.93%       4.153ms       2.076ms             2
                             Torch-Compiled Region: 3/0         0.15%      70.239us        10.02%       4.800ms       1.600ms       0.000us         0.00%       2.801ms     933.578us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.921ms
Self CUDA time total: 15.420ms
----------------------------------------------
[DEBUG] ÂéüÂßã shapes - obs: (4, 256, 39), action: (3, 256, 4), reward: (3, 256, 1)
[DEBUG] Ê£ÄÊµãÂà∞ time‚Äëfirst Â∏ÉÂ±ÄÔºåÂ∑≤ËΩ¨ÁΩÆÂà∞ batch‚Äëfirst
[DEBUG] ËΩ¨ÁΩÆÂêé shapes - obs: (256, 4, 39), action: (256, 3, 4), reward: (256, 3, 1)
[TIME] encode:    6.86 ms
[TIME] td_target:    5.62 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   11.57 ms
[TIME] compute Q:    8.35 ms
[TIME] reward loss:    3.60 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.13 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.04 ms
[TIME] _update total:   49.96 ms
----- Profiler Summary for _update method -----
Traceback (most recent call last):
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 162, in <module>
    train()
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 142, in train
    trainer.train()
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/TDMPC2/algorithms/trainer/online_trainer.py", line 126, in train
    _train_metrics = self.agent.update(self.buffer)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 75, in _patched_update
    return self._update(obs, action, reward, task=task)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/timer.py", line 94, in wrapper
    result = f(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore_agent.py", line 918, in _update
    print(prof.key_averages().table(sort_by="cuda_time_total", row_limit=10))
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/profiler/profiler.py", line 313, in key_averages
    return self.profiler.key_averages(group_by_input_shape, group_by_stack_n)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/profiler.py", line 500, in key_averages
    self._ensure_function_events()
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/profiler.py", line 418, in _ensure_function_events
    parsed_results = self._parse_kineto_results(self.kineto_results)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/profiler.py", line 584, in _parse_kineto_results
    fe = FunctionEvent(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/profiler_util.py", line 478, in __init__
    self.time_range: Interval = Interval(start_us, end_us)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/profiler_util.py", line 430, in __init__
    self.start = start
KeyboardInterrupt