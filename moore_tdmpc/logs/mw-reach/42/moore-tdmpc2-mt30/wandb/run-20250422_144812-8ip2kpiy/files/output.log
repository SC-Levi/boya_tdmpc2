[34m[1mLogs will be synced with wandb.
Config(env_type='MooreMultiTask', n_contexts=1, obs_dim=39, action_dim=4, hidden_dim=256, n_experts=4, moore_temperature=1.0, use_softmax=True, use_checkpoint=True, use_mixed_precision=True, gamma=0.99, stddev=0.1, actor_updates=1, use_ema=True, ensemble_size=5, update_freq=2, seed=42, device=device(type='cuda', index=0), task='mw-reach', obs='state', multitask=False, steps=10000, batch_size=256, reward_coef=0.1, value_coef=0.1, consistency_coef=20, rho=0.5, lr=0.0003, enc_lr_scale=0.3, grad_clip_norm=20, tau=0.01, discount_denom=5, discount_min=0.95, discount_max=0.995, buffer_size=100000, exp_name='moore-tdmpc2-mt30', eval_freq=50000, eval_episodes=10, moore={'n_experts': 4, 'temperature': 1.0, 'use_softmax': True, 'debug_task_emb': False}, mpc=True, iterations=6, num_samples=512, num_elites=64, num_pi_trajs=24, horizon=3, min_std=0.05, max_std=2, temperature=0.5, log_std_min=-10, log_std_max=2, entropy_coef=0.0001, model_size=5, num_enc_layers=2, enc_dim=256, num_channels=32, mlp_dim=512, latent_dim=512, task_dim=0, num_q=5, dropout=0.01, simnorm_dim=8, num_bins=101, vmin=-10, vmax=10, wandb_project='moore-tdmpc2', wandb_entity='OA-MBRL', wandb_silent=False, enable_wandb=True, save_csv=True, save_video=False, save_agent=True, compile=False, work_dir=PosixPath('/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/logs/mw-reach/42/moore-tdmpc2-mt30'), task_title='Mw Reach', tasks=['mw-reach'], obs_shape={'state': (39,)}, episode_length=100, obs_shapes='???', episode_lengths='???', seed_steps=1000, bin_size=0.2, data_dir='/media/levi/Singe4linux/Moore-TDMPC/TDMPC2/data/mt30')
Architecture: MooreWorldModel(total_params=5269655, latent_dim=512, action_dim=4, n_experts=4, temperature=0.5)
Task Encoder: MooreTaskEncoder(obs_dim=39, latent_dim=512, hidden_dim=256, n_experts=4, temperature=1.0, use_softmax=True)
Transition-Reward Core: MoETransitionRewardModel(latent_dim=512, action_dim=4, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, reward_dim=101, use_mixed_precision=True)
Policy prior: Sequential(
  (0): Linear(in_features=512, out_features=256, bias=True)
  (1): ReLU()
  (2): Linear(in_features=256, out_features=256, bias=True)
  (3): ReLU()
  (4): Linear(in_features=256, out_features=8, bias=True)
)
Q-functions: Ensemble(n_models=5)
[32m[1må¼€å§‹Moore-TDMPC2è®­ç»ƒ...
[36mPROFILER STATUS: Enabled=True, Functions=1, Total Calls=1
[32mOnlineTrainer: Starting training loop with profiling enabled
[36mPROFILER STATUS: Enabled=True, Functions=1, Total Calls=1
[36mPROFILER: forward executed in 1.12ms (call 2)
[36mPROFILER: forward executed in 0.69ms (call 3)
 [32meval[39m    [34mE:[39m 0            [34mI:[39m 0            [34mR:[39m 317.9        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 0            [34mI:[39m 100          [34mR:[39m 364.9        [34mS:[39m 0.0          [34mT:[39m 0:00:01
Buffer capacity: 10,000
Storage required: 0.00 GB
Using CUDA:0 memory for storage.
 [34mtrain[39m   [34mE:[39m 1            [34mI:[39m 200          [34mR:[39m 315.7        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 2            [34mI:[39m 300          [34mR:[39m 605.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 3            [34mI:[39m 400          [34mR:[39m 347.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 4            [34mI:[39m 500          [34mR:[39m 319.2        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 5            [34mI:[39m 600          [34mR:[39m 274.8        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 6            [34mI:[39m 700          [34mR:[39m 276.7        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 7            [34mI:[39m 800          [34mR:[39m 190.2        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 8            [34mI:[39m 900          [34mR:[39m 547.0        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 9            [34mI:[39m 1,000        [34mR:[39m 361.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
Pretraining agent on seed data...
âœ“ Registered 67 gradient NaN/Inf detection hooks
[36mPROFILER: _td_target executed in 0.07ms (call 1)
[36mPROFILER: _update executed in 229.29ms (call 1)
[36mPROFILER: _td_target executed in 0.06ms (call 2)
[36mPROFILER: _update executed in 104.64ms (call 2)
[36mPROFILER: _td_target executed in 0.06ms (call 3)
[36mPROFILER: _update executed in 107.93ms (call 3)
[TIME] encode:    7.31 ms
[TIME] td_target:    4.92 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   17.45 ms
[TIME] compute Q:    9.65 ms
[TIME] policy loss:    0.34 ms
[TIME] reward loss:    0.17 ms
[TIME] value loss:    0.13 ms
[TIME] consistency loss:    1.18 ms
[TIME] backward:   15.01 ms
[TIME] gradient check:    3.39 ms
[TIME] grad clipping:   19.12 ms
[TIME] optim.step:    1.31 ms
[TIME] _update total:   62.57 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.48%       2.057ms        56.52%      33.433ms       4.776ms       0.000us         0.00%      23.946ms       3.421ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      18.210ms        96.94%      18.210ms       3.642ms             5
                             MooreExpertsModule_forward         0.50%     293.987us        31.24%      18.480ms       3.696ms       0.000us         0.00%      14.457ms       2.891ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      10.741ms        57.18%      10.741ms      10.741ms             1
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.374ms        49.90%       9.374ms       9.374ms             1
                                              aten::bmm         0.18%     109.322us        15.29%       9.046ms     904.577us       7.713ms        41.06%       7.713ms     771.318us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.360ms        39.18%       7.360ms     919.999us             8
                                            aten::copy_         0.20%     117.862us        12.94%       7.654ms     156.200us       6.727ms        35.81%       6.727ms     137.289us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.703ms        35.68%       6.703ms     257.800us            26
                                           aten::repeat         0.07%      43.386us        11.60%       6.860ms     686.019us       0.000us         0.00%       6.653ms     665.304us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 59.150ms
Self CUDA time total: 18.785ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 10           [34mI:[39m 1,100        [34mR:[39m 308.8        [34mS:[39m 0.0          [34mT:[39m 0:02:09
 [34mtrain[39m   [34mE:[39m 11           [34mI:[39m 1,200        [34mR:[39m 250.6        [34mS:[39m 0.0          [34mT:[39m 0:02:23
 [34mtrain[39m   [34mE:[39m 12           [34mI:[39m 1,300        [34mR:[39m 563.4        [34mS:[39m 0.0          [34mT:[39m 0:02:36
 [34mtrain[39m   [34mE:[39m 13           [34mI:[39m 1,400        [34mR:[39m 241.9        [34mS:[39m 0.0          [34mT:[39m 0:02:49
 [34mtrain[39m   [34mE:[39m 14           [34mI:[39m 1,500        [34mR:[39m 559.2        [34mS:[39m 0.0          [34mT:[39m 0:03:01
 [34mtrain[39m   [34mE:[39m 15           [34mI:[39m 1,600        [34mR:[39m 265.5        [34mS:[39m 0.0          [34mT:[39m 0:03:14
 [34mtrain[39m   [34mE:[39m 16           [34mI:[39m 1,700        [34mR:[39m 377.3        [34mS:[39m 0.0          [34mT:[39m 0:03:26
 [34mtrain[39m   [34mE:[39m 17           [34mI:[39m 1,800        [34mR:[39m 298.7        [34mS:[39m 0.0          [34mT:[39m 0:03:38
 [34mtrain[39m   [34mE:[39m 18           [34mI:[39m 1,900        [34mR:[39m 120.8        [34mS:[39m 0.0          [34mT:[39m 0:03:50
 [34mtrain[39m   [34mE:[39m 19           [34mI:[39m 2,000        [34mR:[39m 782.3        [34mS:[39m 0.0          [34mT:[39m 0:04:02
[TIME] encode:    7.01 ms
[TIME] td_target:    5.09 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   16.10 ms
[TIME] compute Q:    6.49 ms
[TIME] policy loss:    0.34 ms
[TIME] reward loss:    0.14 ms
[TIME] value loss:    0.15 ms
[TIME] consistency loss:    1.15 ms
[TIME] backward:   17.34 ms
[TIME] gradient check:    3.51 ms
[TIME] grad clipping:   21.49 ms
[TIME] optim.step:    1.22 ms
[TIME] _update total:   60.14 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.25%       1.830ms        57.67%      32.499ms       4.643ms       0.000us         0.00%      24.154ms       3.451ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      17.211ms        91.12%      17.211ms       3.442ms             5
                             MooreExpertsModule_forward         0.52%     290.926us        31.31%      17.646ms       3.529ms       0.000us         0.00%      14.599ms       2.920ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us       9.787ms        51.81%       9.787ms       9.787ms             1
                                              aten::bmm         0.17%      97.591us        13.53%       7.624ms     762.354us       7.475ms        39.57%       7.475ms     747.488us            10
                                            aten::copy_         0.22%     126.402us        13.58%       7.651ms     156.147us       7.107ms        37.63%       7.107ms     145.036us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       7.083ms        37.50%       7.083ms     272.423us            26
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.075ms        37.46%       7.075ms     884.332us             8
                                           aten::repeat         0.08%      45.919us        12.86%       7.245ms     724.454us       0.000us         0.00%       7.033ms     703.343us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.243ms        33.05%       6.243ms       6.243ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 56.355ms
Self CUDA time total: 18.888ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 20           [34mI:[39m 2,100        [34mR:[39m 772.1        [34mS:[39m 0.0          [34mT:[39m 0:04:18
 [34mtrain[39m   [34mE:[39m 21           [34mI:[39m 2,200        [34mR:[39m 315.2        [34mS:[39m 0.0          [34mT:[39m 0:04:33
 [34mtrain[39m   [34mE:[39m 22           [34mI:[39m 2,300        [34mR:[39m 169.5        [34mS:[39m 0.0          [34mT:[39m 0:04:47
 [34mtrain[39m   [34mE:[39m 23           [34mI:[39m 2,400        [34mR:[39m 1522.7       [34mS:[39m 0.0          [34mT:[39m 0:05:01
 [34mtrain[39m   [34mE:[39m 24           [34mI:[39m 2,500        [34mR:[39m 231.3        [34mS:[39m 0.0          [34mT:[39m 0:05:14
 [34mtrain[39m   [34mE:[39m 25           [34mI:[39m 2,600        [34mR:[39m 753.6        [34mS:[39m 0.0          [34mT:[39m 0:05:27
 [34mtrain[39m   [34mE:[39m 26           [34mI:[39m 2,700        [34mR:[39m 201.4        [34mS:[39m 0.0          [34mT:[39m 0:05:40
 [34mtrain[39m   [34mE:[39m 27           [34mI:[39m 2,800        [34mR:[39m 337.1        [34mS:[39m 0.0          [34mT:[39m 0:05:52
 [34mtrain[39m   [34mE:[39m 28           [34mI:[39m 2,900        [34mR:[39m 840.2        [34mS:[39m 0.0          [34mT:[39m 0:06:04
 [34mtrain[39m   [34mE:[39m 29           [34mI:[39m 3,000        [34mR:[39m 230.0        [34mS:[39m 0.0          [34mT:[39m 0:06:16
[TIME] encode:    8.21 ms
[TIME] td_target:    6.21 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   17.95 ms
[TIME] compute Q:    6.68 ms
[TIME] policy loss:    0.32 ms
[TIME] reward loss:    0.14 ms
[TIME] value loss:    0.13 ms
[TIME] consistency loss:    1.22 ms
[TIME] backward:   19.76 ms
[TIME] gradient check:    4.79 ms
[TIME] grad clipping:   25.24 ms
[TIME] optim.step:    1.26 ms
[TIME] _update total:   68.37 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.17%       2.034ms        57.72%      37.046ms       5.292ms       0.000us         0.00%      24.892ms       3.556ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      19.244ms        99.83%      19.244ms       3.849ms             5
                             MooreExpertsModule_forward         0.52%     333.113us        30.45%      19.546ms       3.909ms       0.000us         0.00%      14.929ms       2.986ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      10.181ms        52.81%      10.181ms      10.181ms             1
                                              aten::bmm         0.16%     101.606us        14.46%       9.278ms     927.816us       8.039ms        41.70%       8.039ms     803.946us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.640ms        39.63%       7.640ms     954.940us             8
                                            aten::copy_         0.20%     126.320us        14.56%       9.347ms     190.753us       6.871ms        35.65%       6.871ms     140.233us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.847ms        35.52%       6.847ms     263.351us            26
                                           aten::repeat         0.08%      51.643us        12.81%       8.221ms     822.077us       0.000us         0.00%       6.797ms     679.695us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.429ms        33.35%       6.429ms       6.429ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 64.184ms
Self CUDA time total: 19.277ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 30           [34mI:[39m 3,100        [34mR:[39m 450.6        [34mS:[39m 0.0          [34mT:[39m 0:06:29
 [34mtrain[39m   [34mE:[39m 31           [34mI:[39m 3,200        [34mR:[39m 112.4        [34mS:[39m 0.0          [34mT:[39m 0:06:41
 [34mtrain[39m   [34mE:[39m 32           [34mI:[39m 3,300        [34mR:[39m 548.4        [34mS:[39m 0.0          [34mT:[39m 0:06:53
 [34mtrain[39m   [34mE:[39m 33           [34mI:[39m 3,400        [34mR:[39m 1042.4       [34mS:[39m 0.0          [34mT:[39m 0:07:06
 [34mtrain[39m   [34mE:[39m 34           [34mI:[39m 3,500        [34mR:[39m 288.8        [34mS:[39m 0.0          [34mT:[39m 0:07:17
 [34mtrain[39m   [34mE:[39m 35           [34mI:[39m 3,600        [34mR:[39m 472.4        [34mS:[39m 0.0          [34mT:[39m 0:07:29
 [34mtrain[39m   [34mE:[39m 36           [34mI:[39m 3,700        [34mR:[39m 280.1        [34mS:[39m 0.0          [34mT:[39m 0:07:41
 [34mtrain[39m   [34mE:[39m 37           [34mI:[39m 3,800        [34mR:[39m 587.4        [34mS:[39m 0.0          [34mT:[39m 0:07:52
 [34mtrain[39m   [34mE:[39m 38           [34mI:[39m 3,900        [34mR:[39m 446.5        [34mS:[39m 0.0          [34mT:[39m 0:08:04
 [34mtrain[39m   [34mE:[39m 39           [34mI:[39m 4,000        [34mR:[39m 445.4        [34mS:[39m 0.0          [34mT:[39m 0:08:16
[TIME] encode:    7.47 ms
[TIME] td_target:    4.90 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   16.15 ms
[TIME] compute Q:    6.59 ms
[TIME] policy loss:    0.41 ms
[TIME] reward loss:    0.14 ms
[TIME] value loss:    0.13 ms
[TIME] consistency loss:    1.19 ms
[TIME] backward:   17.68 ms
[TIME] gradient check:    3.18 ms
[TIME] grad clipping:   21.48 ms
[TIME] optim.step:    1.23 ms
[TIME] _update total:   60.65 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.41%       1.926ms        58.42%      33.035ms       4.719ms       0.000us         0.00%      23.793ms       3.399ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      15.552ms        83.17%      15.552ms       3.110ms             5
                             MooreExpertsModule_forward         0.48%     273.816us        27.98%      15.822ms       3.164ms       0.000us         0.00%      14.403ms       2.881ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us       9.920ms        53.05%       9.920ms       9.920ms             1
                                              aten::bmm         0.19%     105.353us        14.08%       7.965ms     796.464us       7.441ms        39.80%       7.441ms     744.125us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.059ms        37.75%       7.059ms     882.316us             8
                                            aten::copy_         0.22%     122.373us        12.99%       7.343ms     149.857us       6.945ms        37.14%       6.945ms     141.727us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.921ms        37.01%       6.921ms     266.185us            26
                                           aten::repeat         0.08%      45.784us        12.53%       7.084ms     708.446us       0.000us         0.00%       6.871ms     687.094us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.310ms        33.75%       6.310ms       6.310ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 56.549ms
Self CUDA time total: 18.699ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 40           [34mI:[39m 4,100        [34mR:[39m 146.7        [34mS:[39m 0.0          [34mT:[39m 0:08:34
 [34mtrain[39m   [34mE:[39m 41           [34mI:[39m 4,200        [34mR:[39m 289.8        [34mS:[39m 0.0          [34mT:[39m 0:08:51
 [34mtrain[39m   [34mE:[39m 42           [34mI:[39m 4,300        [34mR:[39m 128.3        [34mS:[39m 0.0          [34mT:[39m 0:09:07
 [34mtrain[39m   [34mE:[39m 43           [34mI:[39m 4,400        [34mR:[39m 370.0        [34mS:[39m 0.0          [34mT:[39m 0:09:23
 [34mtrain[39m   [34mE:[39m 44           [34mI:[39m 4,500        [34mR:[39m 173.0        [34mS:[39m 0.0          [34mT:[39m 0:09:38
 [34mtrain[39m   [34mE:[39m 45           [34mI:[39m 4,600        [34mR:[39m 259.1        [34mS:[39m 0.0          [34mT:[39m 0:09:53
 [34mtrain[39m   [34mE:[39m 46           [34mI:[39m 4,700        [34mR:[39m 143.8        [34mS:[39m 0.0          [34mT:[39m 0:10:07
 [34mtrain[39m   [34mE:[39m 47           [34mI:[39m 4,800        [34mR:[39m 328.7        [34mS:[39m 0.0          [34mT:[39m 0:10:21
 [34mtrain[39m   [34mE:[39m 48           [34mI:[39m 4,900        [34mR:[39m 164.6        [34mS:[39m 0.0          [34mT:[39m 0:10:36
 [34mtrain[39m   [34mE:[39m 49           [34mI:[39m 5,000        [34mR:[39m 181.8        [34mS:[39m 0.0          [34mT:[39m 0:10:50
[TIME] encode:    8.23 ms
[TIME] td_target:    5.14 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   17.55 ms
[TIME] compute Q:    7.64 ms
[TIME] policy loss:    0.33 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.13 ms
[TIME] consistency loss:    1.33 ms
[TIME] backward:   19.95 ms
[TIME] gradient check:    3.38 ms
[TIME] grad clipping:   24.05 ms
[TIME] optim.step:    1.26 ms
[TIME] _update total:   66.79 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.13%       1.948ms        58.41%      36.399ms       5.200ms       0.000us         0.00%      25.439ms       3.634ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      19.588ms       100.10%      19.588ms       3.918ms             5
                             MooreExpertsModule_forward         0.48%     298.868us        31.88%      19.866ms       3.973ms       0.000us         0.00%      15.257ms       3.051ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      11.226ms        57.37%      11.226ms      11.226ms             1
                                              aten::bmm         0.15%      95.281us        16.24%      10.119ms       1.012ms       8.173ms        41.77%       8.173ms     817.310us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.773ms        39.72%       7.773ms     971.685us             8
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.378ms        37.71%       7.378ms       7.378ms             1
                                            aten::copy_         0.20%     123.271us        12.32%       7.678ms     156.690us       7.065ms        36.10%       7.065ms     144.175us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       7.041ms        35.98%       7.041ms     270.790us            26
                                           aten::repeat         0.08%      47.245us        11.61%       7.234ms     723.369us       0.000us         0.00%       6.991ms     699.069us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 62.317ms
Self CUDA time total: 19.569ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 50           [34mI:[39m 5,100        [34mR:[39m 550.1        [34mS:[39m 0.0          [34mT:[39m 0:11:10
 [34mtrain[39m   [34mE:[39m 51           [34mI:[39m 5,200        [34mR:[39m 240.3        [34mS:[39m 0.0          [34mT:[39m 0:11:28
 [34mtrain[39m   [34mE:[39m 52           [34mI:[39m 5,300        [34mR:[39m 612.1        [34mS:[39m 0.0          [34mT:[39m 0:11:45
 [34mtrain[39m   [34mE:[39m 53           [34mI:[39m 5,400        [34mR:[39m 136.2        [34mS:[39m 0.0          [34mT:[39m 0:12:02
 [34mtrain[39m   [34mE:[39m 54           [34mI:[39m 5,500        [34mR:[39m 140.8        [34mS:[39m 0.0          [34mT:[39m 0:12:18
 [34mtrain[39m   [34mE:[39m 55           [34mI:[39m 5,600        [34mR:[39m 131.6        [34mS:[39m 0.0          [34mT:[39m 0:12:33
 [34mtrain[39m   [34mE:[39m 56           [34mI:[39m 5,700        [34mR:[39m 430.2        [34mS:[39m 0.0          [34mT:[39m 0:12:48
 [34mtrain[39m   [34mE:[39m 57           [34mI:[39m 5,800        [34mR:[39m 752.7        [34mS:[39m 0.0          [34mT:[39m 0:13:02
 [34mtrain[39m   [34mE:[39m 58           [34mI:[39m 5,900        [34mR:[39m 192.8        [34mS:[39m 0.0          [34mT:[39m 0:13:15
 [34mtrain[39m   [34mE:[39m 59           [34mI:[39m 6,000        [34mR:[39m 247.8        [34mS:[39m 0.0          [34mT:[39m 0:13:29
[TIME] encode:    7.49 ms
[TIME] td_target:    5.44 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   16.84 ms
[TIME] compute Q:    6.57 ms
[TIME] policy loss:    0.30 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.12 ms
[TIME] consistency loss:    1.16 ms
[TIME] backward:   16.64 ms
[TIME] gradient check:    3.61 ms
[TIME] grad clipping:   21.08 ms
[TIME] optim.step:    1.35 ms
[TIME] _update total:   61.40 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.27%       1.907ms        57.99%      33.785ms       4.826ms       0.000us         0.00%      24.755ms       3.536ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      16.059ms        83.82%      16.059ms       3.212ms             5
                             MooreExpertsModule_forward         0.48%     278.938us        28.02%      16.325ms       3.265ms       0.000us         0.00%      14.856ms       2.971ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us       9.814ms        51.22%       9.814ms       9.814ms             1
                                              aten::bmm         0.16%      94.170us        14.15%       8.243ms     824.258us       7.944ms        41.47%       7.944ms     794.424us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.543ms        39.37%       7.543ms     942.909us             8
                                            aten::copy_         0.22%     126.913us        12.78%       7.443ms     151.896us       6.893ms        35.98%       6.893ms     140.664us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.869ms        35.85%       6.869ms     264.183us            26
                                           aten::repeat         0.08%      44.374us        12.09%       7.042ms     704.165us       0.000us         0.00%       6.819ms     681.866us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.295ms        32.85%       6.295ms       6.295ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 58.259ms
Self CUDA time total: 19.159ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 60           [34mI:[39m 6,100        [34mR:[39m 253.2        [34mS:[39m 0.0          [34mT:[39m 0:13:49
 [34mtrain[39m   [34mE:[39m 61           [34mI:[39m 6,200        [34mR:[39m 569.8        [34mS:[39m 0.0          [34mT:[39m 0:14:07
 [34mtrain[39m   [34mE:[39m 62           [34mI:[39m 6,300        [34mR:[39m 501.5        [34mS:[39m 0.0          [34mT:[39m 0:14:24
 [34mtrain[39m   [34mE:[39m 63           [34mI:[39m 6,400        [34mR:[39m 984.9        [34mS:[39m 0.0          [34mT:[39m 0:14:40
 [34mtrain[39m   [34mE:[39m 64           [34mI:[39m 6,500        [34mR:[39m 224.3        [34mS:[39m 0.0          [34mT:[39m 0:14:55
 [34mtrain[39m   [34mE:[39m 65           [34mI:[39m 6,600        [34mR:[39m 337.1        [34mS:[39m 0.0          [34mT:[39m 0:15:10
 [34mtrain[39m   [34mE:[39m 66           [34mI:[39m 6,700        [34mR:[39m 281.5        [34mS:[39m 0.0          [34mT:[39m 0:15:24
 [34mtrain[39m   [34mE:[39m 67           [34mI:[39m 6,800        [34mR:[39m 689.1        [34mS:[39m 0.0          [34mT:[39m 0:15:39
 [34mtrain[39m   [34mE:[39m 68           [34mI:[39m 6,900        [34mR:[39m 679.2        [34mS:[39m 0.0          [34mT:[39m 0:15:54
 [34mtrain[39m   [34mE:[39m 69           [34mI:[39m 7,000        [34mR:[39m 298.3        [34mS:[39m 0.0          [34mT:[39m 0:16:08
[TIME] encode:    7.31 ms
[TIME] td_target:    4.98 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   17.97 ms
[TIME] compute Q:    7.59 ms
[TIME] policy loss:    0.30 ms
[TIME] reward loss:    0.14 ms
[TIME] value loss:    0.14 ms
[TIME] consistency loss:    1.23 ms
[TIME] backward:   18.59 ms
[TIME] gradient check:    3.51 ms
[TIME] grad clipping:   22.89 ms
[TIME] optim.step:    2.38 ms
[TIME] _update total:   65.94 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.11%       1.940ms        55.57%      34.627ms       4.947ms       0.000us         0.00%      24.270ms       3.467ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      17.092ms        89.93%      17.092ms       3.418ms             5
                             MooreExpertsModule_forward         0.49%     305.145us        27.87%      17.369ms       3.474ms       0.000us         0.00%      14.669ms       2.934ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      11.582ms        60.93%      11.582ms      11.582ms             1
                                              aten::bmm         0.17%     103.363us        12.49%       7.781ms     778.101us       7.466ms        39.28%       7.466ms     746.619us            10
                                            aten::copy_         0.20%     121.534us        13.00%       8.100ms     165.309us       7.185ms        37.81%       7.185ms     146.642us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       7.161ms        37.68%       7.161ms     275.440us            26
                                           aten::repeat         0.08%      47.996us        11.80%       7.352ms     735.195us       0.000us         0.00%       7.111ms     711.082us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.074ms        37.22%       7.074ms     884.261us             8
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.811ms        35.84%       6.811ms       6.811ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 62.316ms
Self CUDA time total: 19.006ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 70           [34mI:[39m 7,100        [34mR:[39m 166.5        [34mS:[39m 0.0          [34mT:[39m 0:16:21
 [34mtrain[39m   [34mE:[39m 71           [34mI:[39m 7,200        [34mR:[39m 433.5        [34mS:[39m 0.0          [34mT:[39m 0:16:34
 [34mtrain[39m   [34mE:[39m 72           [34mI:[39m 7,300        [34mR:[39m 122.8        [34mS:[39m 0.0          [34mT:[39m 0:16:46
 [34mtrain[39m   [34mE:[39m 73           [34mI:[39m 7,400        [34mR:[39m 492.1        [34mS:[39m 0.0          [34mT:[39m 0:16:58
 [34mtrain[39m   [34mE:[39m 74           [34mI:[39m 7,500        [34mR:[39m 516.4        [34mS:[39m 0.0          [34mT:[39m 0:17:11
 [34mtrain[39m   [34mE:[39m 75           [34mI:[39m 7,600        [34mR:[39m 530.3        [34mS:[39m 0.0          [34mT:[39m 0:17:23
 [34mtrain[39m   [34mE:[39m 76           [34mI:[39m 7,700        [34mR:[39m 586.4        [34mS:[39m 0.0          [34mT:[39m 0:17:35
 [34mtrain[39m   [34mE:[39m 77           [34mI:[39m 7,800        [34mR:[39m 283.0        [34mS:[39m 0.0          [34mT:[39m 0:17:48
 [34mtrain[39m   [34mE:[39m 78           [34mI:[39m 7,900        [34mR:[39m 211.7        [34mS:[39m 0.0          [34mT:[39m 0:18:00
 [34mtrain[39m   [34mE:[39m 79           [34mI:[39m 8,000        [34mR:[39m 190.3        [34mS:[39m 0.0          [34mT:[39m 0:18:12
[TIME] encode:    8.01 ms
[TIME] td_target:    5.00 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   16.67 ms
[TIME] compute Q:    6.75 ms
[TIME] policy loss:    0.31 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.14 ms
[TIME] consistency loss:    1.20 ms
[TIME] backward:   19.25 ms
[TIME] gradient check:    3.41 ms
[TIME] grad clipping:   23.44 ms
[TIME] optim.step:    1.29 ms
[TIME] _update total:   63.91 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.17%       1.902ms        58.08%      34.861ms       4.980ms       0.000us         0.00%      25.124ms       3.589ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      18.781ms        96.87%      18.781ms       3.756ms             5
                             MooreExpertsModule_forward         0.52%     309.362us        31.76%      19.063ms       3.813ms       0.000us         0.00%      15.089ms       3.018ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      10.389ms        53.58%      10.389ms      10.389ms             1
                                              aten::bmm         0.17%     102.808us        16.43%       9.862ms     986.228us       8.008ms        41.30%       8.008ms     800.792us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.609ms        39.24%       7.609ms     951.118us             8
                                            aten::copy_         0.20%     122.027us        12.42%       7.453ms     152.098us       7.063ms        36.43%       7.063ms     144.147us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       7.040ms        36.31%       7.040ms     270.751us            26
                                           aten::repeat         0.08%      49.007us        12.05%       7.231ms     723.100us       0.000us         0.00%       6.990ms     698.964us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.493ms        33.49%       6.493ms       6.493ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 60.026ms
Self CUDA time total: 19.389ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 80           [34mI:[39m 8,100        [34mR:[39m 493.8        [34mS:[39m 0.0          [34mT:[39m 0:18:33
 [34mtrain[39m   [34mE:[39m 81           [34mI:[39m 8,200        [34mR:[39m 102.2        [34mS:[39m 0.0          [34mT:[39m 0:18:52
 [34mtrain[39m   [34mE:[39m 82           [34mI:[39m 8,300        [34mR:[39m 711.6        [34mS:[39m 0.0          [34mT:[39m 0:19:11
 [34mtrain[39m   [34mE:[39m 83           [34mI:[39m 8,400        [34mR:[39m 907.9        [34mS:[39m 0.0          [34mT:[39m 0:19:30
 [34mtrain[39m   [34mE:[39m 84           [34mI:[39m 8,500        [34mR:[39m 825.9        [34mS:[39m 0.0          [34mT:[39m 0:19:47
 [34mtrain[39m   [34mE:[39m 85           [34mI:[39m 8,600        [34mR:[39m 259.8        [34mS:[39m 0.0          [34mT:[39m 0:20:03
 [34mtrain[39m   [34mE:[39m 86           [34mI:[39m 8,700        [34mR:[39m 218.4        [34mS:[39m 0.0          [34mT:[39m 0:20:18
 [34mtrain[39m   [34mE:[39m 87           [34mI:[39m 8,800        [34mR:[39m 325.4        [34mS:[39m 0.0          [34mT:[39m 0:20:33
 [34mtrain[39m   [34mE:[39m 88           [34mI:[39m 8,900        [34mR:[39m 244.4        [34mS:[39m 0.0          [34mT:[39m 0:20:48
 [34mtrain[39m   [34mE:[39m 89           [34mI:[39m 9,000        [34mR:[39m 158.5        [34mS:[39m 0.0          [34mT:[39m 0:21:02
[TIME] encode:    7.11 ms
[TIME] td_target:    4.94 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   16.30 ms
[TIME] compute Q:    6.62 ms
[TIME] policy loss:    0.30 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.12 ms
[TIME] consistency loss:    1.15 ms
[TIME] backward:   17.74 ms
[TIME] gradient check:    3.28 ms
[TIME] grad clipping:   21.72 ms
[TIME] optim.step:    1.26 ms
[TIME] _update total:   60.64 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.35%       1.901ms        57.63%      32.662ms       4.666ms       0.000us         0.00%      24.027ms       3.432ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      17.450ms        92.72%      17.450ms       3.490ms             5
                             MooreExpertsModule_forward         0.51%     289.191us        31.53%      17.873ms       3.575ms       0.000us         0.00%      14.544ms       2.909ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      10.064ms        53.47%      10.064ms      10.064ms             1
                                              aten::bmm         0.18%     100.100us        13.66%       7.740ms     774.029us       7.445ms        39.56%       7.445ms     744.484us            10
                                            aten::copy_         0.22%     122.551us        13.46%       7.626ms     155.628us       7.082ms        37.63%       7.082ms     144.534us            49
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.064ms        37.53%       7.064ms     883.009us             8
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       7.059ms        37.51%       7.059ms     271.485us            26
                                           aten::repeat         0.08%      47.767us        12.76%       7.234ms     723.386us       0.000us         0.00%       7.009ms     700.893us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.346ms        33.72%       6.346ms       6.346ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 56.676ms
Self CUDA time total: 18.820ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 90           [34mI:[39m 9,100        [34mR:[39m 211.0        [34mS:[39m 0.0          [34mT:[39m 0:21:22
 [34mtrain[39m   [34mE:[39m 91           [34mI:[39m 9,200        [34mR:[39m 167.7        [34mS:[39m 0.0          [34mT:[39m 0:21:41
 [34mtrain[39m   [34mE:[39m 92           [34mI:[39m 9,300        [34mR:[39m 177.7        [34mS:[39m 0.0          [34mT:[39m 0:21:59
 [34mtrain[39m   [34mE:[39m 93           [34mI:[39m 9,400        [34mR:[39m 514.1        [34mS:[39m 0.0          [34mT:[39m 0:22:16
 [34mtrain[39m   [34mE:[39m 94           [34mI:[39m 9,500        [34mR:[39m 139.0        [34mS:[39m 0.0          [34mT:[39m 0:22:33
 [34mtrain[39m   [34mE:[39m 95           [34mI:[39m 9,600        [34mR:[39m 277.4        [34mS:[39m 0.0          [34mT:[39m 0:22:49
 [34mtrain[39m   [34mE:[39m 96           [34mI:[39m 9,700        [34mR:[39m 326.3        [34mS:[39m 0.0          [34mT:[39m 0:23:04
 [34mtrain[39m   [34mE:[39m 97           [34mI:[39m 9,800        [34mR:[39m 348.8        [34mS:[39m 0.0          [34mT:[39m 0:23:18
 [34mtrain[39m   [34mE:[39m 98           [34mI:[39m 9,900        [34mR:[39m 426.1        [34mS:[39m 0.0          [34mT:[39m 0:23:32
 [34mtrain[39m   [34mE:[39m 99           [34mI:[39m 10,000       [34mR:[39m 117.5        [34mS:[39m 0.0          [34mT:[39m 0:23:45
[TIME] encode:    6.99 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   16.28 ms
[TIME] compute Q:    6.77 ms
[TIME] policy loss:    0.30 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.14 ms
[TIME] consistency loss:    1.16 ms
[TIME] backward:   17.98 ms
[TIME] gradient check:    3.48 ms
[TIME] grad clipping:   22.14 ms
[TIME] optim.step:    1.29 ms
[TIME] _update total:   61.15 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.60%       2.050ms        56.39%      32.102ms       4.586ms       0.000us         0.00%      23.592ms       3.370ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      15.064ms        81.16%      15.064ms       3.013ms             5
                             MooreExpertsModule_forward         0.50%     287.205us        27.06%      15.406ms       3.081ms       0.000us         0.00%      14.273ms       2.855ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us       9.857ms        53.11%       9.857ms       9.857ms             1
                                              aten::bmm         0.16%      91.707us        13.33%       7.587ms     758.682us       7.445ms        40.11%       7.445ms     744.500us            10
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       7.071ms        38.10%       7.071ms     883.905us             8
                                            aten::copy_         0.22%     126.969us        12.81%       7.295ms     148.876us       6.811ms        36.69%       6.811ms     138.991us            49
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.787ms        36.56%       6.787ms     261.022us            26
                                           aten::repeat         0.08%      46.298us        12.26%       6.980ms     698.039us       0.000us         0.00%       6.737ms     673.717us            10
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       6.492ms        34.98%       6.492ms       6.492ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 56.927ms
Self CUDA time total: 18.561ms
----------------------------------------------