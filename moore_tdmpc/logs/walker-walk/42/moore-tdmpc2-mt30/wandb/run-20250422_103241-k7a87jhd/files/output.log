[34m[1mLogs will be synced with wandb.
Config(env_type='MooreMultiTask', n_contexts=1, obs_dim=24, action_dim=6, hidden_dim=256, n_experts=4, moore_temperature=1.0, use_softmax=True, use_checkpoint=True, use_mixed_precision=True, gamma=0.99, stddev=0.1, actor_updates=1, use_ema=True, ensemble_size=5, update_freq=2, seed=42, device=device(type='cuda', index=0), task='walker-walk', obs='state', multitask=False, steps=100000, batch_size=256, reward_coef=0.1, value_coef=0.1, consistency_coef=20, rho=0.5, lr=0.0003, enc_lr_scale=0.3, grad_clip_norm=20, tau=0.01, discount_denom=5, discount_min=0.95, discount_max=0.995, buffer_size=100000, exp_name='moore-tdmpc2-mt30', eval_freq=50000, eval_episodes=10, moore={'n_experts': 4, 'temperature': 1.0, 'use_softmax': True, 'debug_task_emb': False}, mpc=True, iterations=6, num_samples=512, num_elites=64, num_pi_trajs=24, horizon=3, min_std=0.05, max_std=2, temperature=0.5, log_std_min=-10, log_std_max=2, entropy_coef=0.0001, model_size=5, num_enc_layers=2, enc_dim=256, num_channels=32, mlp_dim=512, latent_dim=512, task_dim=0, num_q=5, dropout=0.01, simnorm_dim=8, num_bins=101, vmin=-10, vmax=10, wandb_project='moore-tdmpc2', wandb_entity='OA-MBRL', wandb_silent=False, enable_wandb=True, save_csv=True, save_video=False, save_agent=True, compile=False, work_dir=PosixPath('/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/logs/walker-walk/42/moore-tdmpc2-mt30'), task_title='Walker Walk', tasks=['walker-walk'], obs_shape={'state': (24,)}, episode_length=500, obs_shapes='???', episode_lengths='???', seed_steps=2500, bin_size=0.2, data_dir='/media/levi/Singe4linux/Moore-TDMPC/TDMPC2/data/mt30')
Architecture: TD-MPC2 Moore World Model
Task Encoder: MooreTaskEncoder(obs_dim=24, latent_dim=512, hidden_dim=256, n_experts=4, temperature=1.0, use_softmax=True)
Dynamics: MoEDynamicsModel(latent_dim=512, action_dim=6, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, use_mixed_precision=True)
Reward: MoERewardModel(latent_dim=512, action_dim=6, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, reward_dim=101, top_k=1)
Policy prior: Sequential(
  (0): Linear(in_features=512, out_features=256, bias=True)
  (1): ReLU()
  (2): Linear(in_features=256, out_features=256, bias=True)
  (3): ReLU()
  (4): Linear(in_features=256, out_features=12, bias=True)
)
Q-functions: Ensemble(n_models=5)
Learnable parameters: 5,209,033
[32m[1må¼€å§‹Moore-TDMPC2è®­ç»ƒ...
[36mPROFILER STATUS: Enabled=True, Functions=3, Total Calls=7
[32mOnlineTrainer: Starting training loop with profiling enabled
[36mPROFILER STATUS: Enabled=True, Functions=3, Total Calls=7
[36mPROFILER: forward executed in 1.09ms (call 3)
 [32meval[39m    [34mE:[39m 0            [34mI:[39m 0            [34mR:[39m 20.3         [34mS:[39m 0.0          [34mT:[39m 0:00:06
 [34mtrain[39m   [34mE:[39m 0            [34mI:[39m 500          [34mR:[39m 41.9         [34mS:[39m 0.0          [34mT:[39m 0:00:06
Buffer capacity: 100,000
Storage required: 0.01 GB
Using CUDA:0 memory for storage.
 [34mtrain[39m   [34mE:[39m 1            [34mI:[39m 1,000        [34mR:[39m 31.9         [34mS:[39m 0.0          [34mT:[39m 0:00:06
 [34mtrain[39m   [34mE:[39m 2            [34mI:[39m 1,500        [34mR:[39m 32.1         [34mS:[39m 0.0          [34mT:[39m 0:00:06
 [34mtrain[39m   [34mE:[39m 3            [34mI:[39m 2,000        [34mR:[39m 46.7         [34mS:[39m 0.0          [34mT:[39m 0:00:06
 [34mtrain[39m   [34mE:[39m 4            [34mI:[39m 2,500        [34mR:[39m 33.7         [34mS:[39m 0.0          [34mT:[39m 0:00:06
Pretraining agent on seed data...
[36mPROFILER: _td_target executed in 0.06ms (call 1)
[36mPROFILER: _update executed in 2383.12ms (call 1)
[36mPROFILER: _td_target executed in 0.06ms (call 2)
[36mPROFILER: _update executed in 84.09ms (call 2)
[36mPROFILER: _td_target executed in 0.06ms (call 3)
[36mPROFILER: _update executed in 82.68ms (call 3)
[TIME] encode:    6.64 ms
[TIME] td_target:    4.88 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.52 ms
[TIME] compute Q:   10.21 ms
[TIME] reward loss:    4.06 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.78 ms
[TIME] grad clipping:    0.74 ms
[TIME] optim.step:    1.03 ms
[TIME] _update total:   52.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.97%       2.495ms        58.54%      29.403ms       2.450ms       0.000us         0.00%      21.195ms       1.766ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.840ms        66.21%       9.840ms       9.840ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.079ms        61.09%       9.079ms       4.539ms             2
                             MooreExpertsModule_forward         0.27%     134.479us        18.32%       9.201ms       4.601ms       0.000us         0.00%       8.597ms       4.298ms             2
                                              aten::bmm         0.34%     169.342us        14.33%       7.195ms     449.713us       6.512ms        43.82%       6.531ms     408.213us            16
                                            aten::copy_         0.61%     308.183us        13.75%       6.905ms      56.597us       4.476ms        30.12%       4.476ms      36.691us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.294ms        28.89%       4.294ms     330.284us            13
                                           aten::repeat         0.04%      19.900us         8.66%       4.348ms       1.087ms       0.000us         0.00%       4.262ms       1.065ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.130ms        27.79%       4.130ms       2.065ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.789ms        18.76%       2.789ms     929.540us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.225ms
Self CUDA time total: 14.862ms
----------------------------------------------
[TIME] encode:    6.95 ms
[TIME] td_target:    4.69 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   11.26 ms
[TIME] compute Q:    8.10 ms
[TIME] reward loss:    6.08 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.63 ms
[TIME] grad clipping:    0.69 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   49.45 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.08%       2.386ms        67.62%      31.788ms       2.649ms       0.000us         0.00%      21.814ms       1.818ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.218ms        59.98%       9.218ms       4.609ms             2
                             MooreExpertsModule_forward         0.26%     122.941us        19.85%       9.330ms       4.665ms       0.000us         0.00%       8.864ms       4.432ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.848ms        51.07%       7.848ms       7.848ms             1
                                              aten::bmm         0.40%     190.076us        14.84%       6.978ms     436.117us       6.549ms        42.62%       6.567ms     410.460us            16
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       5.017ms        32.64%       5.017ms       1.672ms             3
                                            aten::copy_         0.62%     289.281us        12.14%       5.707ms      46.776us       4.742ms        30.86%       4.742ms      38.872us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.551ms        29.61%       4.551ms     350.059us            13
                                           aten::repeat         0.04%      18.794us         9.79%       4.601ms       1.150ms       0.000us         0.00%       4.517ms       1.129ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.138ms        26.93%       4.138ms       2.069ms             2
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.012ms
Self CUDA time total: 15.368ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 5            [34mI:[39m 3,000        [34mR:[39m 23.0         [34mS:[39m 0.0          [34mT:[39m 0:04:29
[TIME] encode:    7.48 ms
[TIME] td_target:    5.51 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   17.20 ms
[TIME] compute Q:    9.70 ms
[TIME] reward loss:    4.19 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   15.74 ms
[TIME] grad clipping:    0.93 ms
[TIME] optim.step:    1.20 ms
[TIME] _update total:   63.21 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.59%       2.760ms        62.72%      37.727ms       3.144ms       0.000us         0.00%      21.738ms       1.811ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.305ms        67.29%      10.305ms       5.152ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.394ms        61.34%       9.394ms       9.394ms             1
                             MooreExpertsModule_forward         0.29%     176.456us        17.39%      10.458ms       5.229ms       0.000us         0.00%       8.868ms       4.434ms             2
                                              aten::bmm         0.30%     179.733us        14.85%       8.931ms     558.201us       6.437ms        42.03%       6.454ms     403.404us            16
                                            aten::copy_         0.52%     314.454us        12.46%       7.493ms      61.414us       4.780ms        31.21%       4.780ms      39.180us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.580ms        29.91%       4.580ms     352.301us            13
                                           aten::repeat         0.05%      29.276us         7.75%       4.660ms       1.165ms       0.000us         0.00%       4.546ms       1.137ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.115ms        26.87%       4.115ms       2.058ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.879ms        18.80%       2.879ms     959.622us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 60.149ms
Self CUDA time total: 15.314ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 6            [34mI:[39m 3,500        [34mR:[39m 9.9          [34mS:[39m 0.0          [34mT:[39m 0:05:24
 [34mtrain[39m   [34mE:[39m 7            [34mI:[39m 4,000        [34mR:[39m 19.7         [34mS:[39m 0.0          [34mT:[39m 0:06:12
[TIME] encode:    8.21 ms
[TIME] td_target:    4.96 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.54 ms
[TIME] compute Q:    7.90 ms
[TIME] reward loss:    5.19 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   11.98 ms
[TIME] grad clipping:    1.88 ms
[TIME] optim.step:    1.17 ms
[TIME] _update total:   56.89 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.41%       2.389ms        62.80%      33.988ms       2.832ms       0.000us         0.00%      22.067ms       1.839ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.781ms        69.46%      10.781ms       5.390ms             2
                             MooreExpertsModule_forward         0.25%     133.883us        20.14%      10.900ms       5.450ms       0.000us         0.00%       8.990ms       4.495ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.628ms        49.14%       7.628ms       7.628ms             1
                                              aten::bmm         0.30%     164.990us        13.52%       7.317ms     457.318us       6.890ms        44.39%       6.909ms     431.823us            16
                                            aten::copy_         0.59%     320.826us        11.37%       6.151ms      50.417us       4.521ms        29.13%       4.521ms      37.061us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.483ms        28.88%       4.483ms       2.241ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.327ms        27.87%       4.327ms     332.821us            13
                                           aten::repeat         0.04%      23.442us         8.11%       4.390ms       1.098ms       0.000us         0.00%       4.287ms       1.072ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.971ms        25.58%       3.971ms       1.324ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 54.120ms
Self CUDA time total: 15.522ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 8            [34mI:[39m 4,500        [34mR:[39m 9.8          [34mS:[39m 0.0          [34mT:[39m 0:06:59
 [34mtrain[39m   [34mE:[39m 9            [34mI:[39m 5,000        [34mR:[39m 23.1         [34mS:[39m 0.0          [34mT:[39m 0:07:46
[TIME] encode:    7.59 ms
[TIME] td_target:    4.73 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.68 ms
[TIME] compute Q:    8.42 ms
[TIME] reward loss:    4.00 ms
[TIME] value loss:    0.20 ms
[TIME] backward:   12.76 ms
[TIME] grad clipping:    1.04 ms
[TIME] optim.step:    1.40 ms
[TIME] _update total:   55.69 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.43%       2.347ms        63.93%      33.894ms       2.825ms       0.000us         0.00%      22.400ms       1.867ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.822ms        62.72%       9.822ms       4.911ms             2
                             MooreExpertsModule_forward         0.28%     150.569us        18.77%       9.953ms       4.977ms       0.000us         0.00%       9.173ms       4.586ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.125ms        51.88%       8.125ms       8.125ms             1
                                              aten::bmm         0.31%     164.516us        16.61%       8.809ms     550.557us       6.974ms        44.54%       6.992ms     437.024us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.629ms        29.56%       4.629ms       2.314ms             2
                                            aten::copy_         0.58%     308.759us        12.01%       6.366ms      52.183us       4.567ms        29.16%       4.567ms      37.437us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.372ms        27.92%       4.372ms     336.346us            13
                                           aten::repeat         0.04%      23.248us         8.37%       4.439ms       1.110ms       0.000us         0.00%       4.339ms       1.085ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.822ms        18.02%       2.822ms     940.609us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.021ms
Self CUDA time total: 15.660ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 10           [34mI:[39m 5,500        [34mR:[39m 23.4         [34mS:[39m 0.0          [34mT:[39m 0:08:47
 [34mtrain[39m   [34mE:[39m 11           [34mI:[39m 6,000        [34mR:[39m 41.4         [34mS:[39m 0.0          [34mT:[39m 0:09:35
[TIME] encode:    7.62 ms
[TIME] td_target:    5.10 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.93 ms
[TIME] compute Q:    7.89 ms
[TIME] reward loss:    5.37 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   11.69 ms
[TIME] grad clipping:    1.81 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   55.59 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.57%       2.419ms        62.30%      32.999ms       2.750ms       0.000us         0.00%      22.161ms       1.847ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.161ms        65.21%      10.161ms       5.081ms             2
                             MooreExpertsModule_forward         0.29%     151.597us        19.55%      10.355ms       5.177ms       0.000us         0.00%       9.017ms       4.509ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.573ms        48.60%       7.573ms       7.573ms             1
                                              aten::bmm         0.31%     165.318us        15.22%       8.063ms     503.915us       6.554ms        42.06%       6.572ms     410.755us            16
                                            aten::copy_         0.59%     313.734us        16.58%       8.780ms      71.968us       4.914ms        31.54%       4.914ms      40.280us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.718ms        30.28%       4.718ms     362.908us            13
                                           aten::repeat         0.04%      20.825us         9.03%       4.784ms       1.196ms       0.000us         0.00%       4.684ms       1.171ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.111ms        26.38%       4.111ms       2.056ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.993ms        25.63%       3.993ms       1.331ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.968ms
Self CUDA time total: 15.582ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 12           [34mI:[39m 6,500        [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 0:10:23
 [34mtrain[39m   [34mE:[39m 13           [34mI:[39m 7,000        [34mR:[39m 13.8         [34mS:[39m 0.0          [34mT:[39m 0:11:09
[TIME] encode:    8.48 ms
[TIME] td_target:    5.37 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.80 ms
[TIME] compute Q:    8.72 ms
[TIME] reward loss:    4.14 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   12.70 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.46 ms
[TIME] _update total:   57.65 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.55%       3.045ms        65.92%      36.202ms       3.017ms       0.000us         0.00%      22.520ms       1.877ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.766ms        68.51%      10.766ms       5.383ms             2
                             MooreExpertsModule_forward         0.28%     152.180us        19.84%      10.896ms       5.448ms       0.000us         0.00%       9.239ms       4.620ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.461ms        53.84%       8.461ms       8.461ms             1
                                              aten::bmm         0.29%     161.415us        17.41%       9.564ms     597.736us       6.886ms        43.82%       6.904ms     431.504us            16
                                            aten::copy_         0.53%     289.800us        11.56%       6.348ms      52.034us       4.742ms        30.17%       4.742ms      38.866us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.549ms        28.95%       4.549ms     349.950us            13
                                           aten::repeat         0.04%      22.783us         8.40%       4.614ms       1.154ms       0.000us         0.00%       4.516ms       1.129ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.507ms        28.68%       4.507ms       2.253ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.914ms        18.55%       2.914ms     971.466us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 54.918ms
Self CUDA time total: 15.715ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 14           [34mI:[39m 7,500        [34mR:[39m 23.5         [34mS:[39m 0.0          [34mT:[39m 0:12:13
 [34mtrain[39m   [34mE:[39m 15           [34mI:[39m 8,000        [34mR:[39m 23.2         [34mS:[39m 0.0          [34mT:[39m 0:13:03
[TIME] encode:    7.43 ms
[TIME] td_target:    4.74 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.53 ms
[TIME] compute Q:    8.07 ms
[TIME] reward loss:    4.00 ms
[TIME] value loss:    0.20 ms
[TIME] backward:    9.94 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    2.94 ms
[TIME] _update total:   52.56 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.83%       2.408ms        61.44%      30.628ms       2.552ms       0.000us         0.00%      22.424ms       1.869ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.683ms        61.80%       9.683ms       4.841ms             2
                             MooreExpertsModule_forward         0.31%     152.061us        19.69%       9.817ms       4.908ms       0.000us         0.00%       9.171ms       4.585ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.793ms        49.74%       7.793ms       7.793ms             1
                                              aten::bmm         0.34%     171.055us        14.94%       7.449ms     465.585us       6.904ms        44.07%       6.923ms     432.676us            16
                                            aten::copy_         0.66%     326.809us        14.04%       7.000ms      57.381us       4.661ms        29.75%       4.661ms      38.205us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.538ms        28.96%       4.538ms       2.269ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.469ms        28.52%       4.469ms     343.731us            13
                                           aten::repeat         0.04%      21.778us         9.10%       4.538ms       1.134ms       0.000us         0.00%       4.435ms       1.109ms             4
                             Torch-Compiled Region: 3/0         0.14%      69.180us         9.75%       4.861ms       1.620ms       0.000us         0.00%       2.821ms     940.488us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.848ms
Self CUDA time total: 15.667ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 16           [34mI:[39m 8,500        [34mR:[39m 9.7          [34mS:[39m 0.0          [34mT:[39m 0:13:51
 [34mtrain[39m   [34mE:[39m 17           [34mI:[39m 9,000        [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 0:14:37
[TIME] encode:    8.12 ms
[TIME] td_target:    4.87 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.27 ms
[TIME] compute Q:    7.94 ms
[TIME] reward loss:    5.02 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   12.06 ms
[TIME] grad clipping:    0.88 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   55.38 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.60%       2.418ms        61.34%      32.239ms       2.687ms       0.000us         0.00%      22.230ms       1.853ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.388ms        66.72%      10.388ms       5.194ms             2
                             MooreExpertsModule_forward         0.29%     153.776us        20.00%      10.514ms       5.257ms       0.000us         0.00%       9.076ms       4.538ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.637ms        49.05%       7.637ms       7.637ms             1
                                              aten::bmm         0.32%     167.935us        13.85%       7.278ms     454.866us       6.832ms        43.88%       6.851ms     428.197us            16
                                            aten::copy_         0.61%     322.214us        11.80%       6.204ms      50.849us       4.656ms        29.90%       4.656ms      38.164us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.465ms        28.67%       4.465ms     343.448us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.435ms        28.48%       4.435ms       2.217ms             2
                                           aten::repeat         0.04%      23.116us         8.61%       4.524ms       1.131ms       0.000us         0.00%       4.425ms       1.106ms             4
                             Torch-Compiled Region: 3/0         0.13%      67.065us         9.25%       4.861ms       1.620ms       0.000us         0.00%       2.804ms     934.542us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.561ms
Self CUDA time total: 15.571ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 18           [34mI:[39m 9,500        [34mR:[39m 42.8         [34mS:[39m 0.0          [34mT:[39m 0:15:43
 [34mtrain[39m   [34mE:[39m 19           [34mI:[39m 10,000       [34mR:[39m 10.0         [34mS:[39m 0.0          [34mT:[39m 0:16:33
[TIME] encode:    7.24 ms
[TIME] td_target:    4.64 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.64 ms
[TIME] compute Q:    9.55 ms
[TIME] reward loss:    4.41 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   13.54 ms
[TIME] grad clipping:    0.98 ms
[TIME] optim.step:    1.14 ms
[TIME] _update total:   56.25 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.66%       2.485ms        57.46%      30.668ms       2.556ms       0.000us         0.00%      22.202ms       1.850ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.407ms        60.47%       9.407ms       4.703ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.271ms        59.60%       9.271ms       9.271ms             1
                             MooreExpertsModule_forward         0.23%     123.689us        17.84%       9.524ms       4.762ms       0.000us         0.00%       9.067ms       4.533ms             2
                                              aten::bmm         0.31%     165.216us        14.15%       7.550ms     471.898us       6.979ms        44.86%       6.998ms     437.358us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.588ms        29.49%       4.588ms       2.294ms             2
                                            aten::copy_         0.62%     329.892us        14.45%       7.711ms      63.201us       4.507ms        28.97%       4.507ms      36.940us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.310ms        27.71%       4.310ms     331.536us            13
                                           aten::repeat         0.04%      19.826us         8.19%       4.369ms       1.092ms       0.000us         0.00%       4.277ms       1.069ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.220ms        20.70%       3.220ms       1.073ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.372ms
Self CUDA time total: 15.556ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 20           [34mI:[39m 10,500       [34mR:[39m 15.9         [34mS:[39m 0.0          [34mT:[39m 0:17:20
 [34mtrain[39m   [34mE:[39m 21           [34mI:[39m 11,000       [34mR:[39m 10.7         [34mS:[39m 0.0          [34mT:[39m 0:18:05
[TIME] encode:    7.86 ms
[TIME] td_target:    5.02 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.92 ms
[TIME] compute Q:    8.48 ms
[TIME] reward loss:    4.39 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.65 ms
[TIME] grad clipping:    0.94 ms
[TIME] optim.step:    1.15 ms
[TIME] _update total:   56.48 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.38%       2.355ms        61.25%      32.952ms       2.746ms       0.000us         0.00%      22.860ms       1.905ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.487ms        65.91%      10.487ms       5.243ms             2
                             MooreExpertsModule_forward         0.24%     127.242us        19.71%      10.606ms       5.303ms       0.000us         0.00%       9.370ms       4.685ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.197ms        51.52%       8.197ms       8.197ms             1
                                              aten::bmm         0.31%     168.215us        14.53%       7.814ms     488.362us       7.099ms        44.62%       7.118ms     444.850us            16
                                            aten::copy_         0.59%     316.706us        11.47%       6.171ms      50.582us       4.699ms        29.54%       4.699ms      38.519us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.689ms        29.47%       4.689ms       2.345ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.504ms        28.31%       4.504ms     346.489us            13
                                           aten::repeat         0.04%      22.870us         8.49%       4.566ms       1.141ms       0.000us         0.00%       4.470ms       1.118ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.235ms        20.33%       3.235ms       1.078ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.795ms
Self CUDA time total: 15.910ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 22           [34mI:[39m 11,500       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 0:19:11
 [34mtrain[39m   [34mE:[39m 23           [34mI:[39m 12,000       [34mR:[39m 14.6         [34mS:[39m 0.0          [34mT:[39m 0:20:07
[TIME] encode:    8.02 ms
[TIME] td_target:    5.71 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   15.05 ms
[TIME] compute Q:    8.36 ms
[TIME] reward loss:    5.12 ms
[TIME] value loss:    0.21 ms
[TIME] backward:   14.08 ms
[TIME] grad clipping:    1.03 ms
[TIME] optim.step:    1.19 ms
[TIME] _update total:   59.77 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.58%       2.599ms        60.93%      34.576ms       2.881ms       0.000us         0.00%      22.426ms       1.869ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.379ms        66.06%      10.379ms       5.190ms             2
                             MooreExpertsModule_forward         0.29%     163.444us        18.97%      10.767ms       5.384ms       0.000us         0.00%       9.148ms       4.574ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.067ms        51.34%       8.067ms       8.067ms             1
                                              aten::bmm         0.30%     172.220us        13.41%       7.607ms     475.446us       6.868ms        43.71%       6.886ms     430.384us            16
                                            aten::copy_         0.59%     333.235us        11.75%       6.666ms      54.642us       4.713ms        29.99%       4.713ms      38.631us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.520ms        28.76%       4.520ms     347.674us            13
                                           aten::repeat         0.05%      27.028us         8.11%       4.604ms       1.151ms       0.000us         0.00%       4.484ms       1.121ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.453ms        28.34%       4.453ms       2.227ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.610ms        22.97%       3.610ms       1.203ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 56.747ms
Self CUDA time total: 15.713ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 24           [34mI:[39m 12,500       [34mR:[39m 11.2         [34mS:[39m 0.0          [34mT:[39m 0:20:56
 [34mtrain[39m   [34mE:[39m 25           [34mI:[39m 13,000       [34mR:[39m 22.0         [34mS:[39m 0.0          [34mT:[39m 0:21:41
[TIME] encode:    7.23 ms
[TIME] td_target:    5.09 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.01 ms
[TIME] compute Q:    8.36 ms
[TIME] reward loss:    3.94 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.28 ms
[TIME] grad clipping:    2.70 ms
[TIME] optim.step:    1.17 ms
[TIME] _update total:   53.96 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.08%       2.595ms        60.59%      30.967ms       2.581ms       0.000us         0.00%      22.062ms       1.839ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.693ms        62.66%       9.693ms       4.847ms             2
                             MooreExpertsModule_forward         0.35%     181.001us        19.28%       9.852ms       4.926ms       0.000us         0.00%       9.012ms       4.506ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.069ms        52.16%       8.069ms       8.069ms             1
                                              aten::bmm         0.34%     172.444us        14.56%       7.439ms     464.929us       6.870ms        44.41%       6.888ms     430.530us            16
                                            aten::copy_         0.60%     306.620us        11.36%       5.807ms      47.601us       4.553ms        29.43%       4.553ms      37.318us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.474ms        28.92%       4.474ms       2.237ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.361ms        28.19%       4.361ms     335.463us            13
                                           aten::repeat         0.05%      26.029us         8.68%       4.435ms       1.109ms       0.000us         0.00%       4.326ms       1.082ms             4
                             Torch-Compiled Region: 3/0         0.14%      73.663us         9.56%       4.884ms       1.628ms       0.000us         0.00%       2.764ms     921.209us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.105ms
Self CUDA time total: 15.469ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 26           [34mI:[39m 13,500       [34mR:[39m 10.1         [34mS:[39m 0.0          [34mT:[39m 0:22:36
 [34mtrain[39m   [34mE:[39m 27           [34mI:[39m 14,000       [34mR:[39m 9.8          [34mS:[39m 0.0          [34mT:[39m 0:23:45
[TIME] encode:    7.25 ms
[TIME] td_target:    5.07 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.54 ms
[TIME] compute Q:    9.37 ms
[TIME] reward loss:    4.12 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.18 ms
[TIME] grad clipping:    0.90 ms
[TIME] optim.step:    1.26 ms
[TIME] _update total:   56.79 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.75%       2.557ms        62.72%      33.781ms       2.815ms       0.000us         0.00%      22.041ms       1.837ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.369ms        60.40%       9.369ms       4.684ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.058ms        58.40%       9.058ms       9.058ms             1
                             MooreExpertsModule_forward         0.27%     144.687us        17.63%       9.497ms       4.749ms       0.000us         0.00%       8.969ms       4.484ms             2
                                              aten::bmm         0.32%     171.498us        13.60%       7.326ms     457.876us       6.509ms        41.96%       6.528ms     407.988us            16
                                            aten::copy_         0.58%     312.287us        13.73%       7.397ms      60.630us       4.848ms        31.26%       4.848ms      39.740us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.654ms        30.00%       4.654ms     357.976us            13
                                           aten::repeat         0.04%      22.106us         8.80%       4.738ms       1.184ms       0.000us         0.00%       4.620ms       1.155ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.139ms        26.68%       4.139ms       2.069ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.871ms        18.51%       2.871ms     957.058us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.860ms
Self CUDA time total: 15.512ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 28           [34mI:[39m 14,500       [34mR:[39m 42.0         [34mS:[39m 0.0          [34mT:[39m 0:24:37
 [34mtrain[39m   [34mE:[39m 29           [34mI:[39m 15,000       [34mR:[39m 10.3         [34mS:[39m 0.0          [34mT:[39m 0:25:23
[TIME] encode:    7.63 ms
[TIME] td_target:    4.92 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.40 ms
[TIME] compute Q:    8.03 ms
[TIME] reward loss:    3.82 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.87 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.28 ms
[TIME] _update total:   50.76 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.53%       3.151ms        63.53%      30.666ms       2.555ms       0.000us         0.00%      21.304ms       1.775ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.126ms        60.48%       9.126ms       4.563ms             2
                             MooreExpertsModule_forward         0.27%     130.080us        19.36%       9.347ms       4.674ms       0.000us         0.00%       8.619ms       4.310ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.761ms        51.43%       7.761ms       7.761ms             1
                                              aten::bmm         0.45%     217.272us        15.09%       7.284ms     455.265us       6.526ms        43.25%       6.544ms     409.003us            16
                                            aten::copy_         0.62%     297.977us        11.53%       5.566ms      45.623us       4.481ms        29.70%       4.481ms      36.729us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.289ms        28.42%       4.289ms     329.935us            13
                                           aten::repeat         0.04%      19.404us         9.00%       4.342ms       1.086ms       0.000us         0.00%       4.256ms       1.064ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.141ms        27.44%       4.141ms       2.070ms             2
                             Torch-Compiled Region: 3/0         0.20%      96.929us        10.39%       5.016ms       1.672ms       0.000us         0.00%       2.801ms     933.715us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.273ms
Self CUDA time total: 15.090ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 30           [34mI:[39m 15,500       [34mR:[39m 21.4         [34mS:[39m 0.0          [34mT:[39m 0:26:08
 [34mtrain[39m   [34mE:[39m 31           [34mI:[39m 16,000       [34mR:[39m 42.7         [34mS:[39m 0.0          [34mT:[39m 0:27:17
[TIME] encode:    7.07 ms
[TIME] td_target:    5.09 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.06 ms
[TIME] compute Q:   10.59 ms
[TIME] reward loss:    4.18 ms
[TIME] value loss:    0.22 ms
[TIME] backward:   13.86 ms
[TIME] grad clipping:    1.00 ms
[TIME] optim.step:    1.25 ms
[TIME] _update total:   56.37 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.40%       2.347ms        59.01%      31.503ms       2.625ms       0.000us         0.00%      21.916ms       1.826ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.301ms        66.76%      10.301ms      10.301ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.837ms        63.75%       9.837ms       4.918ms             2
                             MooreExpertsModule_forward         0.25%     132.740us        18.64%       9.953ms       4.977ms       0.000us         0.00%       8.922ms       4.461ms             2
                                              aten::bmm         0.31%     164.390us        13.70%       7.316ms     457.253us       6.484ms        42.02%       6.503ms     406.408us            16
                                            aten::copy_         0.59%     312.749us        12.14%       6.482ms      53.133us       4.823ms        31.26%       4.823ms      39.537us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.630ms        30.01%       4.630ms     356.175us            13
                                           aten::repeat         0.05%      24.224us         8.81%       4.704ms       1.176ms       0.000us         0.00%       4.597ms       1.149ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.116ms        26.67%       4.116ms       2.058ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.014ms        19.53%       3.014ms       1.005ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.385ms
Self CUDA time total: 15.431ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 32           [34mI:[39m 16,500       [34mR:[39m 23.4         [34mS:[39m 0.0          [34mT:[39m 0:28:13
 [34mtrain[39m   [34mE:[39m 33           [34mI:[39m 17,000       [34mR:[39m 23.2         [34mS:[39m 0.0          [34mT:[39m 0:29:02
[TIME] encode:    6.95 ms
[TIME] td_target:    4.78 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.06 ms
[TIME] compute Q:    8.01 ms
[TIME] reward loss:    3.91 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.10 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.15 ms
[TIME] _update total:   49.99 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.94%       2.336ms        62.97%      29.790ms       2.483ms       0.000us         0.00%      21.753ms       1.813ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.316ms        60.77%       9.316ms       4.658ms             2
                             MooreExpertsModule_forward         0.26%     123.592us        19.93%       9.430ms       4.715ms       0.000us         0.00%       8.837ms       4.419ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.755ms        50.59%       7.755ms       7.755ms             1
                                              aten::bmm         0.36%     171.527us        14.97%       7.081ms     442.570us       6.526ms        42.57%       6.545ms     409.048us            16
                                            aten::copy_         0.66%     310.532us        13.45%       6.365ms      52.173us       4.716ms        30.76%       4.716ms      38.654us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.522ms        29.50%       4.522ms     347.879us            13
                                           aten::repeat         0.04%      20.080us         9.71%       4.594ms       1.149ms       0.000us         0.00%       4.489ms       1.122ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.139ms        27.00%       4.139ms       2.069ms             2
                             Torch-Compiled Region: 3/0         0.19%      92.010us        10.25%       4.850ms       1.617ms       0.000us         0.00%       2.804ms     934.631us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.311ms
Self CUDA time total: 15.330ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 34           [34mI:[39m 17,500       [34mR:[39m 10.3         [34mS:[39m 0.0          [34mT:[39m 0:29:48
 [34mtrain[39m   [34mE:[39m 35           [34mI:[39m 18,000       [34mR:[39m 10.6         [34mS:[39m 0.0          [34mT:[39m 0:31:01
[TIME] encode:    8.20 ms
[TIME] td_target:    5.41 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   15.55 ms
[TIME] compute Q:    8.65 ms
[TIME] reward loss:    5.31 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   13.60 ms
[TIME] grad clipping:    1.13 ms
[TIME] optim.step:    1.31 ms
[TIME] _update total:   60.34 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.56%       2.607ms        64.53%      36.897ms       3.075ms       0.000us         0.00%      22.002ms       1.833ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.989ms        70.97%      10.989ms       5.494ms             2
                             MooreExpertsModule_forward         0.25%     141.259us        19.45%      11.122ms       5.561ms       0.000us         0.00%       8.963ms       4.482ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.329ms        53.79%       8.329ms       8.329ms             1
                                              aten::bmm         0.31%     178.462us        13.36%       7.638ms     477.379us       6.899ms        44.56%       6.918ms     432.377us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.499ms        29.06%       4.499ms       2.249ms             2
                                            aten::copy_         0.56%     321.330us        12.61%       7.213ms      59.119us       4.484ms        28.96%       4.484ms      36.753us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.286ms        27.68%       4.286ms     329.675us            13
                                           aten::repeat         0.05%      31.043us         7.62%       4.357ms       1.089ms       0.000us         0.00%       4.241ms       1.060ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.529ms        22.79%       3.529ms       1.176ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 57.181ms
Self CUDA time total: 15.483ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 36           [34mI:[39m 18,500       [34mR:[39m 41.4         [34mS:[39m 0.0          [34mT:[39m 0:32:02
 [34mtrain[39m   [34mE:[39m 37           [34mI:[39m 19,000       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 0:32:51
[TIME] encode:    7.94 ms
[TIME] td_target:    5.11 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.65 ms
[TIME] compute Q:    8.13 ms
[TIME] reward loss:    4.85 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   12.98 ms
[TIME] grad clipping:    0.90 ms
[TIME] optim.step:    1.18 ms
[TIME] _update total:   56.94 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.91%       2.648ms        66.22%      35.750ms       2.979ms       0.000us         0.00%      22.970ms       1.914ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.281ms        64.46%      10.281ms       5.141ms             2
                             MooreExpertsModule_forward         0.34%     183.214us        19.52%      10.539ms       5.269ms       0.000us         0.00%       9.443ms       4.721ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.830ms        49.09%       7.830ms       7.830ms             1
                                              aten::bmm         0.32%     174.607us        15.74%       8.498ms     531.107us       7.178ms        45.00%       7.197ms     449.790us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.787ms        30.01%       4.787ms       2.393ms             2
                                            aten::copy_         0.58%     311.308us        12.91%       6.970ms      57.129us       4.672ms        29.29%       4.672ms      38.294us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.479ms        28.08%       4.479ms     344.540us            13
                                           aten::repeat         0.05%      27.778us         8.44%       4.559ms       1.140ms       0.000us         0.00%       4.445ms       1.111ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.463ms        21.71%       3.463ms       1.154ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.983ms
Self CUDA time total: 15.950ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 38           [34mI:[39m 19,500       [34mR:[39m 13.5         [34mS:[39m 0.0          [34mT:[39m 0:33:36
 [34mtrain[39m   [34mE:[39m 39           [34mI:[39m 20,000       [34mR:[39m 33.3         [34mS:[39m 0.0          [34mT:[39m 0:34:44
[TIME] encode:    6.86 ms
[TIME] td_target:    4.82 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.58 ms
[TIME] compute Q:    8.21 ms
[TIME] reward loss:    4.28 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.91 ms
[TIME] grad clipping:    2.81 ms
[TIME] optim.step:    1.22 ms
[TIME] _update total:   52.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.36%       2.672ms        60.54%      30.154ms       2.513ms       0.000us         0.00%      21.328ms       1.777ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.028ms        59.67%       9.028ms       4.514ms             2
                             MooreExpertsModule_forward         0.34%     168.199us        18.42%       9.172ms       4.586ms       0.000us         0.00%       8.617ms       4.308ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.901ms        52.22%       7.901ms       7.901ms             1
                                              aten::bmm         0.35%     172.881us        14.30%       7.125ms     445.312us       6.551ms        43.30%       6.570ms     410.633us            16
                                            aten::copy_         0.63%     312.451us        18.12%       9.027ms      73.990us       4.470ms        29.54%       4.470ms      36.636us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.275ms        28.25%       4.275ms     328.808us            13
                                           aten::repeat         0.06%      28.122us         8.76%       4.365ms       1.091ms       0.000us         0.00%       4.241ms       1.060ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.167ms        27.54%       4.167ms       2.084ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.917ms        19.28%       2.917ms     972.400us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.809ms
Self CUDA time total: 15.129ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 40           [34mI:[39m 20,500       [34mR:[39m 32.6         [34mS:[39m 0.0          [34mT:[39m 0:35:43
 [34mtrain[39m   [34mE:[39m 41           [34mI:[39m 21,000       [34mR:[39m 45.6         [34mS:[39m 0.0          [34mT:[39m 0:36:32
[TIME] encode:    8.04 ms
[TIME] td_target:    4.67 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.47 ms
[TIME] compute Q:    7.99 ms
[TIME] reward loss:    5.08 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   12.03 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.75 ms
[TIME] _update total:   55.98 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.53%       2.410ms        62.05%      33.033ms       2.753ms       0.000us         0.00%      21.945ms       1.829ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.269ms        66.52%      10.269ms       5.134ms             2
                             MooreExpertsModule_forward         0.25%     134.551us        19.52%      10.393ms       5.196ms       0.000us         0.00%       8.941ms       4.471ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.722ms        50.02%       7.722ms       7.722ms             1
                                              aten::bmm         0.30%     160.752us        13.69%       7.287ms     455.408us       6.875ms        44.54%       6.894ms     430.869us            16
                                            aten::copy_         0.59%     312.195us        11.23%       5.978ms      48.996us       4.480ms        29.02%       4.480ms      36.722us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.474ms        28.98%       4.474ms       2.237ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.286ms        27.77%       4.286ms     329.694us            13
                                           aten::repeat         0.04%      21.932us         8.17%       4.351ms       1.088ms       0.000us         0.00%       4.248ms       1.062ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.920ms        25.39%       3.920ms       1.307ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.233ms
Self CUDA time total: 15.436ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 42           [34mI:[39m 21,500       [34mR:[39m 13.7         [34mS:[39m 0.0          [34mT:[39m 0:37:19
 [34mtrain[39m   [34mE:[39m 43           [34mI:[39m 22,000       [34mR:[39m 23.2         [34mS:[39m 0.0          [34mT:[39m 0:38:24
[TIME] encode:    6.93 ms
[TIME] td_target:    4.66 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.89 ms
[TIME] compute Q:   10.93 ms
[TIME] reward loss:    4.10 ms
[TIME] value loss:    0.20 ms
[TIME] backward:   13.18 ms
[TIME] grad clipping:    0.96 ms
[TIME] optim.step:    1.28 ms
[TIME] _update total:   56.05 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.52%       2.403ms        58.72%      31.222ms       2.602ms       0.000us         0.00%      21.038ms       1.753ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.616ms        70.75%      10.616ms      10.616ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.238ms        61.57%       9.238ms       4.619ms             2
                             MooreExpertsModule_forward         0.25%     132.181us        17.60%       9.358ms       4.679ms       0.000us         0.00%       8.474ms       4.237ms             2
                                              aten::bmm         0.33%     174.275us        13.68%       7.274ms     454.633us       6.580ms        43.85%       6.598ms     412.378us            16
                                            aten::copy_         0.59%     312.283us        11.85%       6.299ms      51.633us       4.317ms        28.77%       4.317ms      35.388us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.167ms        27.77%       4.167ms       2.084ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.123ms        27.48%       4.123ms     317.178us            13
                                           aten::repeat         0.05%      24.344us         7.92%       4.209ms       1.052ms       0.000us         0.00%       4.090ms       1.023ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.875ms        19.16%       2.875ms     958.254us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 53.168ms
Self CUDA time total: 15.004ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 44           [34mI:[39m 22,500       [34mR:[39m 14.3         [34mS:[39m 0.0          [34mT:[39m 0:39:34
 [34mtrain[39m   [34mE:[39m 45           [34mI:[39m 23,000       [34mR:[39m 13.9         [34mS:[39m 0.0          [34mT:[39m 0:40:25
[TIME] encode:    6.71 ms
[TIME] td_target:    4.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.15 ms
[TIME] compute Q:    8.03 ms
[TIME] reward loss:    3.82 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.84 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    2.80 ms
[TIME] _update total:   50.93 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.06%       2.442ms        60.69%      29.303ms       2.442ms       0.000us         0.00%      21.238ms       1.770ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.959ms        59.43%       8.959ms       4.480ms             2
                             MooreExpertsModule_forward         0.31%     147.370us        18.82%       9.089ms       4.545ms       0.000us         0.00%       8.587ms       4.294ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.771ms        51.55%       7.771ms       7.771ms             1
                                              aten::bmm         0.35%     168.505us        14.53%       7.016ms     438.501us       6.566ms        43.56%       6.585ms     411.590us            16
                                            aten::copy_         0.62%     297.027us        14.70%       7.097ms      58.172us       4.454ms        29.54%       4.454ms      36.507us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.260ms        28.26%       4.260ms     327.681us            13
                                           aten::repeat         0.05%      23.369us         8.97%       4.329ms       1.082ms       0.000us         0.00%       4.227ms       1.057ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.151ms        27.54%       4.151ms       2.076ms             2
                             Torch-Compiled Region: 3/0         0.14%      69.722us        10.33%       4.990ms       1.663ms       0.000us         0.00%       2.792ms     930.783us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.287ms
Self CUDA time total: 15.075ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 46           [34mI:[39m 23,500       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 0:41:20
 [34mtrain[39m   [34mE:[39m 47           [34mI:[39m 24,000       [34mR:[39m 14.9         [34mS:[39m 0.0          [34mT:[39m 0:42:43
[TIME] encode:    7.12 ms
[TIME] td_target:    5.11 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   18.00 ms
[TIME] compute Q:   26.67 ms
[TIME] reward loss:   15.17 ms
[TIME] value loss:    0.41 ms
[TIME] backward:   60.70 ms
[TIME] grad clipping:    2.51 ms
[TIME] optim.step:    2.81 ms
[TIME] _update total:  139.62 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      26.351ms       169.99%      26.351ms      26.351ms             1
                                     CheckpointFunction         1.76%       2.409ms        32.06%      43.843ms       3.654ms       0.000us         0.00%      22.118ms       1.843ms            12
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us      13.089ms        84.44%      13.089ms       4.363ms             3
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.749ms        62.89%       9.749ms       4.874ms             2
                             MooreExpertsModule_forward         0.11%     154.541us         7.23%       9.884ms       4.942ms       0.000us         0.00%       9.035ms       4.517ms             2
                                              aten::bmm         0.12%     166.396us         8.13%      11.122ms     695.149us       6.908ms        44.56%       6.926ms     432.892us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.571ms        29.49%       4.571ms       2.286ms             2
                                            aten::copy_         0.22%     302.551us        16.07%      21.967ms     180.060us       4.500ms        29.03%       4.500ms      36.888us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.287ms        27.66%       4.287ms     329.804us            13
                                           aten::repeat         0.02%      25.552us         3.20%       4.379ms       1.095ms       0.000us         0.00%       4.256ms       1.064ms             4
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 136.739ms
Self CUDA time total: 15.502ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 48           [34mI:[39m 24,500       [34mR:[39m 22.2         [34mS:[39m 0.0          [34mT:[39m 0:44:28
 [34mtrain[39m   [34mE:[39m 49           [34mI:[39m 25,000       [34mR:[39m 41.5         [34mS:[39m 0.0          [34mT:[39m 0:45:57
[TIME] encode:   11.21 ms
[TIME] td_target:    7.26 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   25.39 ms
[TIME] compute Q:    9.97 ms
[TIME] reward loss:    3.93 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.00 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.18 ms
[TIME] _update total:   70.91 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.50%       3.063ms        65.48%      44.553ms       3.713ms       0.000us         0.00%      21.810ms       1.817ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      11.059ms        72.93%      11.059ms       5.530ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.643ms        63.59%       9.643ms       9.643ms             1
                             MooreExpertsModule_forward         0.19%     131.923us        16.60%      11.298ms       5.649ms       0.000us         0.00%       8.920ms       4.460ms             2
                                              aten::bmm         0.25%     168.932us        12.65%       8.607ms     537.937us       6.737ms        44.42%       6.755ms     422.170us            16
                                            aten::copy_         0.44%     300.986us        14.87%      10.120ms      82.951us       4.516ms        29.78%       4.516ms      37.016us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.394ms        28.97%       4.394ms       2.197ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.331ms        28.56%       4.331ms     333.173us            13
                                           aten::repeat         0.03%      22.561us         7.02%       4.774ms       1.193ms       0.000us         0.00%       4.300ms       1.075ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.746ms        18.11%       2.746ms     915.293us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 68.043ms
Self CUDA time total: 15.165ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 50           [34mI:[39m 25,500       [34mR:[39m 19.0         [34mS:[39m 0.0          [34mT:[39m 0:47:17
 [34mtrain[39m   [34mE:[39m 51           [34mI:[39m 26,000       [34mR:[39m 21.7         [34mS:[39m 0.0          [34mT:[39m 0:48:37
[TIME] encode:    7.36 ms
[TIME] td_target:    4.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.85 ms
[TIME] compute Q:    7.84 ms
[TIME] reward loss:    3.83 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.67 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.14 ms
[TIME] _update total:   49.23 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.45%       3.001ms        64.25%      29.903ms       2.492ms       0.000us         0.00%      21.545ms       1.795ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.098ms        60.40%       9.098ms       4.549ms             2
                             MooreExpertsModule_forward         0.29%     136.801us        19.81%       9.219ms       4.609ms       0.000us         0.00%       8.749ms       4.375ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.567ms        50.24%       7.567ms       7.567ms             1
                                              aten::bmm         0.36%     166.609us        14.87%       6.921ms     432.553us       6.524ms        43.31%       6.542ms     408.902us            16
                                            aten::copy_         0.62%     289.807us        11.94%       5.557ms      45.549us       4.624ms        30.70%       4.624ms      37.899us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.442ms        29.49%       4.442ms     341.666us            13
                                           aten::repeat         0.05%      22.535us         9.68%       4.504ms       1.126ms       0.000us         0.00%       4.411ms       1.103ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.134ms        27.44%       4.134ms       2.067ms             2
                             Torch-Compiled Region: 3/0         0.15%      68.349us        10.41%       4.847ms       1.616ms       0.000us         0.00%       2.798ms     932.747us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.538ms
Self CUDA time total: 15.063ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 52           [34mI:[39m 26,500       [34mR:[39m 23.8         [34mS:[39m 0.0          [34mT:[39m 0:50:28
 [34mtrain[39m   [34mE:[39m 53           [34mI:[39m 27,000       [34mR:[39m 19.7         [34mS:[39m 0.0          [34mT:[39m 0:52:02
[TIME] encode:    6.82 ms
[TIME] td_target:    5.61 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   16.63 ms
[TIME] compute Q:   23.78 ms
[TIME] reward loss:   18.52 ms
[TIME] value loss:    0.25 ms
[TIME] backward:   55.56 ms
[TIME] grad clipping:    2.69 ms
[TIME] optim.step:    2.56 ms
[TIME] _update total:  133.74 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      23.432ms       152.65%      23.432ms      23.432ms             1
                                     CheckpointFunction         1.92%       2.504ms        36.14%      47.211ms       3.934ms       0.000us         0.00%      21.837ms       1.820ms            12
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us      15.690ms       102.21%      15.690ms       5.230ms             3
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.009ms        65.20%      10.009ms       5.004ms             2
                             MooreExpertsModule_forward         0.11%     141.130us         7.76%      10.133ms       5.067ms       0.000us         0.00%       8.864ms       4.432ms             2
                                              aten::bmm         0.13%     171.174us         6.33%       8.269ms     516.826us       6.532ms        42.55%       6.550ms     409.381us            16
                                            aten::copy_         0.24%     310.027us        13.55%      17.697ms     145.055us       4.757ms        30.99%       4.757ms      38.988us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.564ms        29.73%       4.564ms     351.053us            13
                                           aten::repeat         0.02%      24.451us         3.55%       4.640ms       1.160ms       0.000us         0.00%       4.532ms       1.133ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.121ms        26.85%       4.121ms       2.061ms             2
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 130.648ms
Self CUDA time total: 15.351ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 54           [34mI:[39m 27,500       [34mR:[39m 23.0         [34mS:[39m 0.0          [34mT:[39m 0:53:24
 [34mtrain[39m   [34mE:[39m 55           [34mI:[39m 28,000       [34mR:[39m 20.3         [34mS:[39m 0.0          [34mT:[39m 0:54:40
[TIME] encode:    6.64 ms
[TIME] td_target:    6.00 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   18.36 ms
[TIME] compute Q:   25.42 ms
[TIME] reward loss:   15.82 ms
[TIME] value loss:    0.41 ms
[TIME] backward:   55.58 ms
[TIME] grad clipping:    2.48 ms
[TIME] optim.step:    2.56 ms
[TIME] _update total:  134.53 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      25.077ms       166.06%      25.077ms      25.077ms             1
                                     CheckpointFunction         1.88%       2.475ms        32.72%      43.018ms       3.585ms       0.000us         0.00%      21.391ms       1.783ms            12
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us      13.358ms        88.46%      13.358ms       4.453ms             3
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.283ms        68.10%      10.283ms       5.142ms             2
                             MooreExpertsModule_forward         0.11%     138.777us         7.91%      10.405ms       5.202ms       0.000us         0.00%       8.684ms       4.342ms             2
                                              aten::bmm         0.12%     163.944us         6.01%       7.907ms     494.191us       6.585ms        43.60%       6.603ms     412.664us            16
                                            aten::copy_         0.24%     313.403us        13.83%      18.185ms     149.058us       4.487ms        29.71%       4.487ms      36.775us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.285ms        28.38%       4.285ms     329.628us            13
                                           aten::repeat         0.02%      22.749us         3.31%       4.351ms       1.088ms       0.000us         0.00%       4.253ms       1.063ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.173ms        27.64%       4.173ms       2.087ms             2
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 131.488ms
Self CUDA time total: 15.101ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 56           [34mI:[39m 28,500       [34mR:[39m 19.9         [34mS:[39m 0.0          [34mT:[39m 0:56:33
 [34mtrain[39m   [34mE:[39m 57           [34mI:[39m 29,000       [34mR:[39m 21.9         [34mS:[39m 0.0          [34mT:[39m 0:58:05
[TIME] encode:    8.66 ms
[TIME] td_target:    7.21 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   23.46 ms
[TIME] compute Q:   14.53 ms
[TIME] reward loss:   11.37 ms
[TIME] value loss:    0.45 ms
[TIME] backward:   31.26 ms
[TIME] grad clipping:    0.92 ms
[TIME] optim.step:    1.31 ms
[TIME] _update total:  100.46 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         2.66%       2.591ms        49.52%      48.145ms       4.012ms       0.000us         0.00%      21.846ms       1.821ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      14.186ms        93.08%      14.186ms      14.186ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.876ms        71.37%      10.876ms       5.438ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       9.149ms        60.03%       9.149ms       3.050ms             3
                             MooreExpertsModule_forward         0.14%     140.832us        11.44%      11.125ms       5.562ms       0.000us         0.00%       8.922ms       4.461ms             2
                                              aten::bmm         0.17%     165.612us         9.61%       9.341ms     583.819us       6.736ms        44.20%       6.755ms     422.158us            16
                                            aten::copy_         0.32%     306.751us        14.56%      14.161ms     116.074us       4.549ms        29.85%       4.549ms      37.287us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.368ms        28.66%       4.368ms       2.184ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.361ms        28.62%       4.361ms     335.475us            13
                                           aten::repeat         0.03%      27.207us         4.97%       4.829ms       1.207ms       0.000us         0.00%       4.329ms       1.082ms             4
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 97.228ms
Self CUDA time total: 15.240ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 58           [34mI:[39m 29,500       [34mR:[39m 23.8         [34mS:[39m 0.0          [34mT:[39m 0:59:26
 [34mtrain[39m   [34mE:[39m 59           [34mI:[39m 30,000       [34mR:[39m 43.0         [34mS:[39m 0.0          [34mT:[39m 1:00:37
[TIME] encode:    8.61 ms
[TIME] td_target:    6.55 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   22.65 ms
[TIME] compute Q:   12.48 ms
[TIME] reward loss:   12.75 ms
[TIME] value loss:    0.41 ms
[TIME] backward:   34.37 ms
[TIME] grad clipping:    0.84 ms
[TIME] optim.step:    1.15 ms
[TIME] _update total:  100.90 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         2.44%       2.401ms        47.88%      47.040ms       3.920ms       0.000us         0.00%      22.102ms       1.842ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      12.171ms        79.14%      12.171ms      12.171ms             1
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us      10.648ms        69.23%      10.648ms       3.549ms             3
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.444ms        67.90%      10.444ms       5.222ms             2
                             MooreExpertsModule_forward         0.13%     124.035us        10.87%      10.676ms       5.338ms       0.000us         0.00%       9.032ms       4.516ms             2
                                              aten::bmm         0.16%     159.938us         9.50%       9.334ms     583.366us       6.733ms        43.78%       6.751ms     421.920us            16
                                            aten::copy_         0.29%     286.625us        14.04%      13.798ms     113.102us       4.638ms        30.16%       4.638ms      38.020us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.453ms        28.95%       4.453ms     342.540us            13
                                           aten::repeat         0.02%      20.864us         4.79%       4.707ms       1.177ms       0.000us         0.00%       4.420ms       1.105ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.388ms        28.53%       4.388ms       2.194ms             2
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 98.245ms
Self CUDA time total: 15.380ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 60           [34mI:[39m 30,500       [34mR:[39m 26.9         [34mS:[39m 0.0          [34mT:[39m 1:02:17
 [34mtrain[39m   [34mE:[39m 61           [34mI:[39m 31,000       [34mR:[39m 24.0         [34mS:[39m 0.0          [34mT:[39m 1:03:12
[TIME] encode:    6.71 ms
[TIME] td_target:    4.63 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.17 ms
[TIME] compute Q:    8.06 ms
[TIME] reward loss:    3.84 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.84 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    2.92 ms
[TIME] _update total:   50.97 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.96%       2.399ms        60.21%      29.153ms       2.429ms       0.000us         0.00%      21.272ms       1.773ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.935ms        59.16%       8.935ms       4.468ms             2
                             MooreExpertsModule_forward         0.25%     121.209us        18.70%       9.053ms       4.527ms       0.000us         0.00%       8.603ms       4.302ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.780ms        51.51%       7.780ms       7.780ms             1
                                              aten::bmm         0.33%     160.676us        14.71%       7.122ms     445.096us       6.552ms        43.38%       6.571ms     410.706us            16
                                            aten::copy_         0.66%     318.272us        14.84%       7.186ms      58.905us       4.467ms        29.58%       4.467ms      36.616us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.273ms        28.29%       4.273ms     328.718us            13
                                           aten::repeat         0.04%      20.830us         8.95%       4.333ms       1.083ms       0.000us         0.00%       4.240ms       1.060ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.154ms        27.50%       4.154ms       2.077ms             2
                             Torch-Compiled Region: 3/0         0.20%      95.689us        10.30%       4.987ms       1.662ms       0.000us         0.00%       2.790ms     929.872us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.418ms
Self CUDA time total: 15.104ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 62           [34mI:[39m 31,500       [34mR:[39m 28.0         [34mS:[39m 0.0          [34mT:[39m 1:03:59
 [34mtrain[39m   [34mE:[39m 63           [34mI:[39m 32,000       [34mR:[39m 56.8         [34mS:[39m 0.0          [34mT:[39m 1:04:44
[TIME] encode:    6.98 ms
[TIME] td_target:    4.58 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.85 ms
[TIME] compute Q:    7.87 ms
[TIME] reward loss:    3.98 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.53 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   48.68 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.18%       2.389ms        63.86%      29.464ms       2.455ms       0.000us         0.00%      21.361ms       1.780ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.126ms        60.29%       9.126ms       4.563ms             2
                             MooreExpertsModule_forward         0.27%     126.496us        20.04%       9.244ms       4.622ms       0.000us         0.00%       8.655ms       4.328ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.597ms        50.19%       7.597ms       7.597ms             1
                                              aten::bmm         0.36%     166.212us        15.41%       7.107ms     444.215us       6.562ms        43.35%       6.582ms     411.345us            16
                                            aten::copy_         0.66%     305.256us        11.87%       5.476ms      44.886us       4.520ms        29.86%       4.520ms      37.052us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.327ms        28.59%       4.327ms     332.873us            13
                                           aten::repeat         0.04%      20.759us         9.51%       4.386ms       1.096ms       0.000us         0.00%       4.294ms       1.073ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.152ms        27.43%       4.152ms       2.076ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.844ms        18.79%       2.844ms     948.070us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.135ms
Self CUDA time total: 15.137ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 64           [34mI:[39m 32,500       [34mR:[39m 21.0         [34mS:[39m 0.0          [34mT:[39m 1:06:05
 [34mtrain[39m   [34mE:[39m 65           [34mI:[39m 33,000       [34mR:[39m 58.7         [34mS:[39m 0.0          [34mT:[39m 1:07:04
[TIME] encode:    8.02 ms
[TIME] td_target:    4.98 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.73 ms
[TIME] compute Q:    8.01 ms
[TIME] reward loss:    5.05 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   12.41 ms
[TIME] grad clipping:    1.85 ms
[TIME] optim.step:    1.17 ms
[TIME] _update total:   57.28 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.41%       2.407ms        64.85%      35.376ms       2.948ms       0.000us         0.00%      22.018ms       1.835ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.530ms        67.90%      10.530ms       5.265ms             2
                             MooreExpertsModule_forward         0.24%     130.776us        19.52%      10.648ms       5.324ms       0.000us         0.00%       8.961ms       4.481ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.713ms        49.74%       7.713ms       7.713ms             1
                                              aten::bmm         0.30%     163.953us        13.41%       7.317ms     457.282us       6.894ms        44.46%       6.913ms     432.046us            16
                                            aten::copy_         0.57%     312.993us        14.76%       8.051ms      65.989us       4.495ms        28.99%       4.495ms      36.848us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.480ms        28.89%       4.480ms       2.240ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.303ms        27.74%       4.303ms     330.963us            13
                                           aten::repeat         0.04%      21.395us         8.00%       4.362ms       1.090ms       0.000us         0.00%       4.268ms       1.067ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.867ms        24.94%       3.867ms       1.289ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 54.552ms
Self CUDA time total: 15.508ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 66           [34mI:[39m 33,500       [34mR:[39m 19.7         [34mS:[39m 0.0          [34mT:[39m 1:07:53
 [34mtrain[39m   [34mE:[39m 67           [34mI:[39m 34,000       [34mR:[39m 23.1         [34mS:[39m 0.0          [34mT:[39m 1:08:46
[TIME] encode:    8.79 ms
[TIME] td_target:    4.84 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.52 ms
[TIME] compute Q:    8.16 ms
[TIME] reward loss:    5.49 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.29 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    1.19 ms
[TIME] _update total:   58.21 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.86%       3.248ms        65.44%      36.280ms       3.023ms       0.000us         0.00%      23.223ms       1.935ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.320ms        63.94%      10.320ms       5.160ms             2
                             MooreExpertsModule_forward         0.29%     158.414us        18.86%      10.455ms       5.227ms       0.000us         0.00%       9.536ms       4.768ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.856ms        48.68%       7.856ms       7.856ms             1
                                              aten::bmm         0.31%     171.513us        14.92%       8.269ms     516.824us       7.244ms        44.89%       7.263ms     453.931us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.840ms        29.99%       4.840ms       2.420ms             2
                                            aten::copy_         0.56%     310.944us        13.71%       7.598ms      62.279us       4.716ms        29.22%       4.716ms      38.657us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.521ms        28.01%       4.521ms     347.781us            13
                                           aten::repeat         0.05%      28.989us         8.29%       4.593ms       1.148ms       0.000us         0.00%       4.488ms       1.122ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       4.264ms        26.42%       4.264ms       1.421ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 55.438ms
Self CUDA time total: 16.139ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 68           [34mI:[39m 34,500       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 1:10:11
 [34mtrain[39m   [34mE:[39m 69           [34mI:[39m 35,000       [34mR:[39m 27.6         [34mS:[39m 0.0          [34mT:[39m 1:11:09
[TIME] encode:    6.75 ms
[TIME] td_target:    4.64 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.42 ms
[TIME] compute Q:    8.19 ms
[TIME] reward loss:    3.88 ms
[TIME] value loss:    0.21 ms
[TIME] backward:    9.93 ms
[TIME] grad clipping:    0.84 ms
[TIME] optim.step:    1.19 ms
[TIME] _update total:   49.94 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.09%       2.412ms        61.95%      29.347ms       2.446ms       0.000us         0.00%      21.417ms       1.785ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.987ms        59.09%       8.987ms       4.494ms             2
                             MooreExpertsModule_forward         0.26%     121.591us        19.21%       9.101ms       4.551ms       0.000us         0.00%       8.645ms       4.323ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.933ms        52.16%       7.933ms       7.933ms             1
                                              aten::bmm         0.37%     177.093us        14.85%       7.033ms     439.563us       6.569ms        43.19%       6.587ms     411.716us            16
                                            aten::copy_         0.68%     321.345us        13.31%       6.306ms      51.690us       4.526ms        29.76%       4.526ms      37.101us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.332ms        28.48%       4.332ms     333.242us            13
                                           aten::repeat         0.05%      21.870us         9.27%       4.390ms       1.098ms       0.000us         0.00%       4.299ms       1.075ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.141ms        27.23%       4.141ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.15%      69.864us        10.63%       5.037ms       1.679ms       0.000us         0.00%       2.851ms     950.448us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.374ms
Self CUDA time total: 15.210ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 70           [34mI:[39m 35,500       [34mR:[39m 21.4         [34mS:[39m 0.0          [34mT:[39m 1:11:55
 [34mtrain[39m   [34mE:[39m 71           [34mI:[39m 36,000       [34mR:[39m 23.3         [34mS:[39m 0.0          [34mT:[39m 1:12:38
[TIME] encode:    6.82 ms
[TIME] td_target:    4.78 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.25 ms
[TIME] compute Q:    8.15 ms
[TIME] reward loss:    3.89 ms
[TIME] value loss:    0.22 ms
[TIME] backward:    9.88 ms
[TIME] grad clipping:    0.84 ms
[TIME] optim.step:    1.16 ms
[TIME] _update total:   49.91 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.28%       2.492ms        62.16%      29.318ms       2.443ms       0.000us         0.00%      21.397ms       1.783ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.999ms        59.36%       8.999ms       4.499ms             2
                             MooreExpertsModule_forward         0.31%     148.317us        19.37%       9.137ms       4.569ms       0.000us         0.00%       8.668ms       4.334ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.857ms        51.83%       7.857ms       7.857ms             1
                                              aten::bmm         0.34%     160.513us        14.71%       6.938ms     433.616us       6.548ms        43.20%       6.567ms     410.459us            16
                                            aten::copy_         0.63%     298.397us        11.64%       5.488ms      44.986us       4.520ms        29.82%       4.520ms      37.049us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.326ms        28.53%       4.326ms     332.750us            13
                                           aten::repeat         0.04%      20.996us         9.29%       4.383ms       1.096ms       0.000us         0.00%       4.292ms       1.073ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.166ms        27.48%       4.166ms       2.083ms             2
                             Torch-Compiled Region: 3/0         0.15%      71.593us        10.39%       4.902ms       1.634ms       0.000us         0.00%       2.790ms     929.964us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.165ms
Self CUDA time total: 15.160ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 72           [34mI:[39m 36,500       [34mR:[39m 22.0         [34mS:[39m 0.0          [34mT:[39m 1:13:57
 [34mtrain[39m   [34mE:[39m 73           [34mI:[39m 37,000       [34mR:[39m 23.2         [34mS:[39m 0.0          [34mT:[39m 1:14:54
[TIME] encode:    6.82 ms
[TIME] td_target:    4.69 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.06 ms
[TIME] compute Q:    8.19 ms
[TIME] reward loss:    3.69 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.88 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    2.75 ms
[TIME] _update total:   50.88 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.88%       2.359ms        60.77%      29.351ms       2.446ms       0.000us         0.00%      21.693ms       1.808ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.142ms        59.66%       9.142ms       4.571ms             2
                             MooreExpertsModule_forward         0.26%     127.035us        19.21%       9.275ms       4.638ms       0.000us         0.00%       8.803ms       4.401ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.919ms        51.68%       7.919ms       7.919ms             1
                                              aten::bmm         0.33%     160.069us        14.37%       6.942ms     433.847us       6.549ms        42.74%       6.568ms     410.478us            16
                                            aten::copy_         0.64%     309.661us        15.55%       7.512ms      61.574us       4.684ms        30.57%       4.684ms      38.392us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.491ms        29.31%       4.491ms     345.462us            13
                                           aten::repeat         0.04%      20.546us         9.42%       4.551ms       1.138ms       0.000us         0.00%       4.458ms       1.114ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.137ms        26.99%       4.137ms       2.068ms             2
                             Torch-Compiled Region: 3/0         0.15%      71.128us        10.17%       4.913ms       1.638ms       0.000us         0.00%       2.811ms     937.030us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.296ms
Self CUDA time total: 15.323ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 74           [34mI:[39m 37,500       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 1:15:40
 [34mtrain[39m   [34mE:[39m 75           [34mI:[39m 38,000       [34mR:[39m 26.6         [34mS:[39m 0.0          [34mT:[39m 1:16:27
[TIME] encode:    6.80 ms
[TIME] td_target:    4.68 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   14.55 ms
[TIME] compute Q:    9.11 ms
[TIME] reward loss:    4.01 ms
[TIME] value loss:    0.20 ms
[TIME] backward:   13.29 ms
[TIME] grad clipping:    0.87 ms
[TIME] optim.step:    1.19 ms
[TIME] _update total:   55.63 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.65%       2.452ms        60.20%      31.742ms       2.645ms       0.000us         0.00%      21.345ms       1.779ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.998ms        59.39%       8.998ms       4.499ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.799ms        58.07%       8.799ms       8.799ms             1
                             MooreExpertsModule_forward         0.26%     134.956us        17.32%       9.132ms       4.566ms       0.000us         0.00%       8.636ms       4.318ms             2
                                              aten::bmm         0.32%     169.462us        13.28%       7.002ms     437.655us       6.565ms        43.33%       6.584ms     411.493us            16
                                            aten::copy_         0.61%     322.941us        10.67%       5.625ms      46.106us       4.490ms        29.63%       4.490ms      36.801us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.294ms        28.34%       4.294ms     330.313us            13
                                           aten::repeat         0.04%      22.412us         8.27%       4.362ms       1.091ms       0.000us         0.00%       4.260ms       1.065ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.167ms        27.51%       4.167ms       2.084ms             2
                             Torch-Compiled Region: 3/0         0.14%      73.772us        13.73%       7.238ms       2.413ms       0.000us         0.00%       2.802ms     934.041us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.731ms
Self CUDA time total: 15.151ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 76           [34mI:[39m 38,500       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 1:17:13
 [34mtrain[39m   [34mE:[39m 77           [34mI:[39m 39,000       [34mR:[39m 22.3         [34mS:[39m 0.0          [34mT:[39m 1:18:07
[TIME] encode:    6.48 ms
[TIME] td_target:    5.53 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.94 ms
[TIME] compute Q:    8.51 ms
[TIME] reward loss:    4.07 ms
[TIME] value loss:    0.21 ms
[TIME] backward:   13.47 ms
[TIME] grad clipping:    1.02 ms
[TIME] optim.step:    1.33 ms
[TIME] _update total:  106.84 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.52%       2.380ms        59.00%      31.082ms       2.590ms       0.000us         0.00%      20.871ms       1.739ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.023ms        60.49%       9.023ms       4.512ms             2
                             MooreExpertsModule_forward         0.26%     136.956us        17.36%       9.144ms       4.572ms       0.000us         0.00%       8.401ms       4.200ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.222ms        55.12%       8.222ms       8.222ms             1
                                              aten::bmm         0.31%     164.705us        13.13%       6.920ms     432.485us       6.488ms        43.50%       6.507ms     406.693us            16
                                            aten::copy_         0.60%     318.510us        12.67%       6.673ms      54.697us       4.271ms        28.64%       4.271ms      35.012us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.151ms        27.83%       4.151ms       2.076ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.078ms        27.34%       4.078ms     313.666us            13
                                           aten::repeat         0.05%      25.089us         7.90%       4.161ms       1.040ms       0.000us         0.00%       4.043ms       1.011ms             4
                             Torch-Compiled Region: 3/0         0.14%      72.115us        12.31%       6.487ms       2.162ms       0.000us         0.00%       2.814ms     937.911us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 52.683ms
Self CUDA time total: 14.917ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 78           [34mI:[39m 39,500       [34mR:[39m 23.4         [34mS:[39m 0.0          [34mT:[39m 1:19:32
 [34mtrain[39m   [34mE:[39m 79           [34mI:[39m 40,000       [34mR:[39m 17.9         [34mS:[39m 0.0          [34mT:[39m 1:20:28
[TIME] encode:    6.73 ms
[TIME] td_target:    4.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.95 ms
[TIME] compute Q:    7.83 ms
[TIME] reward loss:    3.77 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.51 ms
[TIME] grad clipping:    0.89 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   48.29 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.09%       2.336ms        63.23%      28.991ms       2.416ms       0.000us         0.00%      21.271ms       1.773ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.952ms        59.33%       8.952ms       4.476ms             2
                             MooreExpertsModule_forward         0.27%     125.791us        19.78%       9.068ms       4.534ms       0.000us         0.00%       8.612ms       4.306ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.579ms        50.23%       7.579ms       7.579ms             1
                                              aten::bmm         0.37%     168.048us        15.18%       6.961ms     435.070us       6.541ms        43.35%       6.561ms     410.038us            16
                                            aten::copy_         0.66%     303.479us        12.07%       5.535ms      45.373us       4.474ms        29.65%       4.474ms      36.670us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.279ms        28.36%       4.279ms     329.186us            13
                                           aten::repeat         0.05%      21.090us         9.47%       4.341ms       1.085ms       0.000us         0.00%       4.246ms       1.062ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.156ms        27.54%       4.156ms       2.078ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.166us        10.64%       4.878ms       1.626ms       0.000us         0.00%       2.777ms     925.629us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 45.851ms
Self CUDA time total: 15.089ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 80           [34mI:[39m 40,500       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 1:21:14
 [34mtrain[39m   [34mE:[39m 81           [34mI:[39m 41,000       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 1:21:58
[TIME] encode:    6.85 ms
[TIME] td_target:    5.08 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.18 ms
[TIME] compute Q:    7.85 ms
[TIME] reward loss:    3.76 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.80 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   49.39 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.08%       2.380ms        64.03%      30.009ms       2.501ms       0.000us         0.00%      21.725ms       1.810ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.416ms        61.48%       9.416ms       4.708ms             2
                             MooreExpertsModule_forward         0.38%     175.799us        20.39%       9.557ms       4.778ms       0.000us         0.00%       8.835ms       4.417ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.583ms        49.51%       7.583ms       7.583ms             1
                                              aten::bmm         0.39%     184.300us        15.19%       7.118ms     444.870us       6.531ms        42.64%       6.550ms     409.357us            16
                                            aten::copy_         0.68%     320.559us        12.21%       5.721ms      46.897us       4.720ms        30.82%       4.720ms      38.686us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.526ms        29.55%       4.526ms     348.189us            13
                                           aten::repeat         0.05%      25.450us         9.83%       4.605ms       1.151ms       0.000us         0.00%       4.493ms       1.123ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.129ms        26.96%       4.129ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.15%      71.090us        10.26%       4.810ms       1.603ms       0.000us         0.00%       2.785ms     928.294us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.863ms
Self CUDA time total: 15.316ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 82           [34mI:[39m 41,500       [34mR:[39m 23.1         [34mS:[39m 0.0          [34mT:[39m 1:23:18
 [34mtrain[39m   [34mE:[39m 83           [34mI:[39m 42,000       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 1:24:19
[TIME] encode:    7.11 ms
[TIME] td_target:    4.71 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.18 ms
[TIME] compute Q:    8.01 ms
[TIME] reward loss:    3.77 ms
[TIME] value loss:    0.20 ms
[TIME] backward:    9.77 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   49.50 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.456ms        63.88%      30.019ms       2.502ms       0.000us         0.00%      22.253ms       1.854ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.428ms        60.45%       9.428ms       4.714ms             2
                             MooreExpertsModule_forward         0.27%     125.010us        20.29%       9.535ms       4.767ms       0.000us         0.00%       9.088ms       4.544ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.740ms        49.62%       7.740ms       7.740ms             1
                                              aten::bmm         0.42%     195.431us        15.52%       7.293ms     455.791us       6.836ms        43.83%       6.855ms     428.435us            16
                                            aten::copy_         0.68%     317.935us        14.42%       6.777ms      55.552us       4.662ms        29.89%       4.662ms      38.214us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.469ms        28.65%       4.469ms     343.750us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.444ms        28.49%       4.444ms       2.222ms             2
                                           aten::repeat         0.05%      22.173us         9.64%       4.528ms       1.132ms       0.000us         0.00%       4.435ms       1.109ms             4
                             Torch-Compiled Region: 3/0         0.17%      81.985us        10.52%       4.942ms       1.647ms       0.000us         0.00%       2.797ms     932.238us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.992ms
Self CUDA time total: 15.596ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 84           [34mI:[39m 42,500       [34mR:[39m 21.6         [34mS:[39m 0.0          [34mT:[39m 1:25:06
 [34mtrain[39m   [34mE:[39m 85           [34mI:[39m 43,000       [34mR:[39m 22.5         [34mS:[39m 0.0          [34mT:[39m 1:25:50
[TIME] encode:    6.94 ms
[TIME] td_target:    4.61 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.08 ms
[TIME] compute Q:    7.95 ms
[TIME] reward loss:    4.02 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.83 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   49.37 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.17%       2.420ms        63.14%      29.544ms       2.462ms       0.000us         0.00%      21.410ms       1.784ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.145ms        60.27%       9.145ms       4.573ms             2
                             MooreExpertsModule_forward         0.26%     121.694us        19.79%       9.259ms       4.629ms       0.000us         0.00%       8.666ms       4.333ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.693ms        50.70%       7.693ms       7.693ms             1
                                              aten::bmm         0.37%     171.930us        15.17%       7.099ms     443.686us       6.557ms        43.22%       6.576ms     411.002us            16
                                            aten::copy_         0.72%     338.688us        12.13%       5.678ms      46.541us       4.535ms        29.89%       4.535ms      37.173us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.342ms        28.62%       4.342ms     334.016us            13
                                           aten::repeat         0.05%      22.101us         9.43%       4.412ms       1.103ms       0.000us         0.00%       4.309ms       1.077ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.149ms        27.34%       4.149ms       2.075ms             2
                             Torch-Compiled Region: 3/0         0.15%      68.045us        10.26%       4.801ms       1.600ms       0.000us         0.00%       2.808ms     935.952us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.790ms
Self CUDA time total: 15.173ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 86           [34mI:[39m 43,500       [34mR:[39m 23.5         [34mS:[39m 0.0          [34mT:[39m 1:27:09
 [34mtrain[39m   [34mE:[39m 87           [34mI:[39m 44,000       [34mR:[39m 22.2         [34mS:[39m 0.0          [34mT:[39m 1:28:07
[TIME] encode:    6.77 ms
[TIME] td_target:    4.79 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.92 ms
[TIME] compute Q:    7.94 ms
[TIME] reward loss:    3.68 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.88 ms
[TIME] grad clipping:    0.85 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   48.95 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.21%       2.415ms        63.06%      29.249ms       2.437ms       0.000us         0.00%      21.519ms       1.793ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.185ms        60.30%       9.185ms       4.593ms             2
                             MooreExpertsModule_forward         0.26%     120.583us        20.04%       9.295ms       4.648ms       0.000us         0.00%       8.718ms       4.359ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.670ms        50.36%       7.670ms       7.670ms             1
                                              aten::bmm         0.34%     157.215us        15.00%       6.956ms     434.726us       6.569ms        43.13%       6.588ms     411.730us            16
                                            aten::copy_         0.66%     304.739us        12.19%       5.656ms      46.359us       4.569ms        30.00%       4.569ms      37.454us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.376ms        28.73%       4.376ms     336.620us            13
                                           aten::repeat         0.04%      20.574us         9.56%       4.433ms       1.108ms       0.000us         0.00%       4.343ms       1.086ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.168ms        27.36%       4.168ms       2.084ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.033us        10.28%       4.768ms       1.589ms       0.000us         0.00%       2.811ms     937.005us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.386ms
Self CUDA time total: 15.231ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 88           [34mI:[39m 44,500       [34mR:[39m 42.3         [34mS:[39m 0.0          [34mT:[39m 1:28:53
 [34mtrain[39m   [34mE:[39m 89           [34mI:[39m 45,000       [34mR:[39m 22.7         [34mS:[39m 0.0          [34mT:[39m 1:29:36
[TIME] encode:    7.40 ms
[TIME] td_target:    4.67 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.00 ms
[TIME] compute Q:    7.81 ms
[TIME] reward loss:    3.65 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.69 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.12 ms
[TIME] _update total:   49.13 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.19%       2.418ms        65.12%      30.346ms       2.529ms       0.000us         0.00%      22.234ms       1.853ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.692ms        62.20%       9.692ms       4.846ms             2
                             MooreExpertsModule_forward         0.25%     116.768us        21.03%       9.801ms       4.901ms       0.000us         0.00%       9.081ms       4.540ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.546ms        48.42%       7.546ms       7.546ms             1
                                              aten::bmm         0.35%     162.179us        15.52%       7.231ms     451.938us       6.839ms        43.89%       6.857ms     428.586us            16
                                            aten::copy_         0.65%     301.757us        15.66%       7.298ms      59.823us       4.655ms        29.87%       4.655ms      38.156us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.461ms        28.63%       4.461ms     343.190us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.443ms        28.51%       4.443ms       2.222ms             2
                                           aten::repeat         0.04%      20.383us         9.73%       4.535ms       1.134ms       0.000us         0.00%       4.428ms       1.107ms             4
                             Torch-Compiled Region: 3/0         0.14%      65.492us        10.41%       4.852ms       1.617ms       0.000us         0.00%       2.798ms     932.685us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.600ms
Self CUDA time total: 15.583ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 90           [34mI:[39m 45,500       [34mR:[39m 23.0         [34mS:[39m 0.0          [34mT:[39m 1:30:55
 [34mtrain[39m   [34mE:[39m 91           [34mI:[39m 46,000       [34mR:[39m 21.7         [34mS:[39m 0.0          [34mT:[39m 1:31:52
[TIME] encode:    6.86 ms
[TIME] td_target:    4.61 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.05 ms
[TIME] compute Q:    7.91 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.55 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   48.57 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.08%       2.338ms        63.43%      29.212ms       2.434ms       0.000us         0.00%      21.275ms       1.773ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.973ms        59.55%       8.973ms       4.487ms             2
                             MooreExpertsModule_forward         0.28%     127.534us        19.98%       9.202ms       4.601ms       0.000us         0.00%       8.633ms       4.316ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.642ms        50.71%       7.642ms       7.642ms             1
                                              aten::bmm         0.35%     160.727us        14.98%       6.899ms     431.191us       6.510ms        43.20%       6.529ms     408.033us            16
                                            aten::copy_         0.64%     295.911us        12.05%       5.548ms      45.477us       4.485ms        29.77%       4.485ms      36.766us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.294ms        28.49%       4.294ms     330.289us            13
                                           aten::repeat         0.05%      20.814us         9.46%       4.356ms       1.089ms       0.000us         0.00%       4.260ms       1.065ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.163ms        27.62%       4.163ms       2.081ms             2
                             Torch-Compiled Region: 3/0         0.15%      67.203us        10.33%       4.758ms       1.586ms       0.000us         0.00%       2.771ms     923.670us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.055ms
Self CUDA time total: 15.069ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 92           [34mI:[39m 46,500       [34mR:[39m 22.8         [34mS:[39m 0.0          [34mT:[39m 1:32:38
 [34mtrain[39m   [34mE:[39m 93           [34mI:[39m 47,000       [34mR:[39m 22.7         [34mS:[39m 0.0          [34mT:[39m 1:33:22
[TIME] encode:    7.04 ms
[TIME] td_target:    4.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.81 ms
[TIME] compute Q:    7.73 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   10.21 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   49.09 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.04%       2.343ms        63.36%      29.454ms       2.454ms       0.000us         0.00%      21.957ms       1.830ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.263ms        59.92%       9.263ms       4.632ms             2
                             MooreExpertsModule_forward         0.27%     123.609us        20.17%       9.378ms       4.689ms       0.000us         0.00%       8.932ms       4.466ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.471ms        48.33%       7.471ms       7.471ms             1
                                              aten::bmm         0.36%     166.210us        15.67%       7.285ms     455.325us       6.865ms        44.41%       6.884ms     430.229us            16
                                            aten::copy_         0.65%     300.347us        11.71%       5.442ms      44.609us       4.483ms        29.00%       4.483ms      36.744us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.466ms        28.89%       4.466ms       2.233ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.290ms        27.75%       4.290ms     330.015us            13
                                           aten::repeat         0.04%      20.415us         9.35%       4.347ms       1.087ms       0.000us         0.00%       4.257ms       1.064ms             4
                             Torch-Compiled Region: 3/0         0.16%      72.703us        10.20%       4.741ms       1.580ms       0.000us         0.00%       2.798ms     932.577us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.488ms
Self CUDA time total: 15.459ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 94           [34mI:[39m 47,500       [34mR:[39m 22.7         [34mS:[39m 0.0          [34mT:[39m 1:34:41
 [34mtrain[39m   [34mE:[39m 95           [34mI:[39m 48,000       [34mR:[39m 21.9         [34mS:[39m 0.0          [34mT:[39m 1:35:38
[TIME] encode:    6.91 ms
[TIME] td_target:    4.60 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.25 ms
[TIME] compute Q:    7.98 ms
[TIME] reward loss:    3.96 ms
[TIME] value loss:    0.20 ms
[TIME] backward:    9.79 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    2.98 ms
[TIME] _update total:   51.35 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.00%       2.437ms        60.06%      29.253ms       2.438ms       0.000us         0.00%      21.221ms       1.768ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.935ms        59.30%       8.935ms       4.467ms             2
                             MooreExpertsModule_forward         0.31%     151.567us        18.63%       9.074ms       4.537ms       0.000us         0.00%       8.593ms       4.297ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.627ms        50.62%       7.627ms       7.627ms             1
                                              aten::bmm         0.34%     167.009us        14.53%       7.079ms     442.410us       6.536ms        43.38%       6.555ms     409.717us            16
                                            aten::copy_         0.63%     304.542us        14.90%       7.255ms      59.470us       4.461ms        29.61%       4.461ms      36.569us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.268ms        28.33%       4.268ms     328.290us            13
                                           aten::repeat         0.05%      22.105us         8.89%       4.328ms       1.082ms       0.000us         0.00%       4.234ms       1.059ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.151ms        27.55%       4.151ms       2.076ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.077us         9.93%       4.835ms       1.612ms       0.000us         0.00%       2.774ms     924.769us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.706ms
Self CUDA time total: 15.067ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 96           [34mI:[39m 48,500       [34mR:[39m 22.0         [34mS:[39m 0.0          [34mT:[39m 1:36:23
 [34mtrain[39m   [34mE:[39m 97           [34mI:[39m 49,000       [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 1:37:07
[TIME] encode:    7.32 ms
[TIME] td_target:    4.72 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.87 ms
[TIME] compute Q:    7.82 ms
[TIME] reward loss:    3.75 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.80 ms
[TIME] grad clipping:    0.74 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   49.08 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.29%       2.932ms        63.69%      29.699ms       2.475ms       0.000us         0.00%      21.273ms       1.773ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.084ms        60.18%       9.084ms       4.542ms             2
                             MooreExpertsModule_forward         0.27%     125.448us        19.72%       9.197ms       4.598ms       0.000us         0.00%       8.608ms       4.304ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.554ms        50.04%       7.554ms       7.554ms             1
                                              aten::bmm         0.37%     172.715us        14.97%       6.981ms     436.334us       6.563ms        43.47%       6.582ms     411.365us            16
                                            aten::copy_         0.65%     301.846us        11.76%       5.486ms      44.963us       4.455ms        29.51%       4.455ms      36.513us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.260ms        28.22%       4.260ms     327.723us            13
                                           aten::repeat         0.04%      20.821us         9.26%       4.317ms       1.079ms       0.000us         0.00%       4.227ms       1.057ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.171ms        27.63%       4.171ms       2.086ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.103us        10.23%       4.772ms       1.591ms       0.000us         0.00%       2.783ms     927.798us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.628ms
Self CUDA time total: 15.096ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 98           [34mI:[39m 49,500       [34mR:[39m 26.3         [34mS:[39m 0.0          [34mT:[39m 1:38:26
 [32meval[39m    [34mE:[39m 99           [34mI:[39m 50,000       [34mR:[39m 23.3         [34mS:[39m 0.0          [34mT:[39m 1:39:31
 [34mtrain[39m   [34mE:[39m 99           [34mI:[39m 50,000       [34mR:[39m 22.2         [34mS:[39m 0.0          [34mT:[39m 1:39:31
[TIME] encode:    6.71 ms
[TIME] td_target:    4.92 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.94 ms
[TIME] compute Q:    7.75 ms
[TIME] reward loss:    3.64 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.70 ms
[TIME] grad clipping:    0.74 ms
[TIME] optim.step:    1.15 ms
[TIME] _update total:   48.52 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.01%       2.313ms        63.87%      29.463ms       2.455ms       0.000us         0.00%      21.611ms       1.801ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.304ms        60.94%       9.304ms       4.652ms             2
                             MooreExpertsModule_forward         0.27%     126.616us        20.43%       9.425ms       4.713ms       0.000us         0.00%       8.774ms       4.387ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.501ms        49.13%       7.501ms       7.501ms             1
                                              aten::bmm         0.34%     156.784us        15.35%       7.081ms     442.587us       6.519ms        42.70%       6.537ms     408.575us            16
                                            aten::copy_         0.62%     287.590us        12.50%       5.767ms      47.271us       4.667ms        30.57%       4.667ms      38.256us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.475ms        29.31%       4.475ms     344.228us            13
                                           aten::repeat         0.05%      23.493us         9.84%       4.540ms       1.135ms       0.000us         0.00%       4.442ms       1.110ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.127ms        27.03%       4.127ms       2.064ms             2
                             Torch-Compiled Region: 3/0         0.15%      68.614us        10.30%       4.752ms       1.584ms       0.000us         0.00%       2.788ms     929.334us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.130ms
Self CUDA time total: 15.267ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 100          [34mI:[39m 50,500       [34mR:[39m 23.3         [34mS:[39m 0.0          [34mT:[39m 1:40:16
 [34mtrain[39m   [34mE:[39m 101          [34mI:[39m 51,000       [34mR:[39m 21.1         [34mS:[39m 0.0          [34mT:[39m 1:41:01
[TIME] encode:    6.62 ms
[TIME] td_target:    4.84 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.05 ms
[TIME] compute Q:    7.88 ms
[TIME] reward loss:    3.67 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.68 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.11 ms
[TIME] _update total:   48.55 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.01%       2.311ms        63.33%      29.211ms       2.434ms       0.000us         0.00%      21.404ms       1.784ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.173ms        60.53%       9.173ms       4.586ms             2
                             MooreExpertsModule_forward         0.28%     127.616us        20.13%       9.286ms       4.643ms       0.000us         0.00%       8.680ms       4.340ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.626ms        50.32%       7.626ms       7.626ms             1
                                              aten::bmm         0.34%     156.568us        15.31%       7.060ms     441.243us       6.523ms        43.04%       6.542ms     408.869us            16
                                            aten::copy_         0.62%     288.237us        11.97%       5.520ms      45.243us       4.561ms        30.10%       4.561ms      37.386us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.368ms        28.82%       4.368ms     336.014us            13
                                           aten::repeat         0.05%      21.796us         9.60%       4.429ms       1.107ms       0.000us         0.00%       4.335ms       1.084ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.137ms        27.30%       4.137ms       2.069ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.249us        10.40%       4.797ms       1.599ms       0.000us         0.00%       2.781ms     927.071us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.127ms
Self CUDA time total: 15.155ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 102          [34mI:[39m 51,500       [34mR:[39m 22.8         [34mS:[39m 0.0          [34mT:[39m 1:42:02
 [34mtrain[39m   [34mE:[39m 103          [34mI:[39m 52,000       [34mR:[39m 15.8         [34mS:[39m 0.0          [34mT:[39m 1:43:14
[TIME] encode:    6.69 ms
[TIME] td_target:    4.80 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.77 ms
[TIME] compute Q:    7.86 ms
[TIME] reward loss:    4.00 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.83 ms
[TIME] grad clipping:    0.74 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   48.74 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.11%       2.364ms        63.50%      29.365ms       2.447ms       0.000us         0.00%      21.306ms       1.775ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.125ms        60.41%       9.125ms       4.562ms             2
                             MooreExpertsModule_forward         0.26%     122.417us        19.97%       9.236ms       4.618ms       0.000us         0.00%       8.631ms       4.316ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.609ms        50.37%       7.609ms       7.609ms             1
                                              aten::bmm         0.36%     165.419us        15.11%       6.986ms     436.615us       6.580ms        43.56%       6.598ms     412.403us            16
                                            aten::copy_         0.65%     300.743us        11.73%       5.423ms      44.451us       4.458ms        29.51%       4.458ms      36.544us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.265ms        28.24%       4.265ms     328.107us            13
                                           aten::repeat         0.05%      24.499us         9.36%       4.328ms       1.082ms       0.000us         0.00%       4.232ms       1.058ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.192ms        27.75%       4.192ms       2.096ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.831ms        18.74%       2.831ms     943.520us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.248ms
Self CUDA time total: 15.106ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 104          [34mI:[39m 52,500       [34mR:[39m 22.2         [34mS:[39m 0.0          [34mT:[39m 1:44:03
 [34mtrain[39m   [34mE:[39m 105          [34mI:[39m 53,000       [34mR:[39m 23.2         [34mS:[39m 0.0          [34mT:[39m 1:44:47
[TIME] encode:    6.84 ms
[TIME] td_target:    4.97 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.26 ms
[TIME] compute Q:    8.05 ms
[TIME] reward loss:    3.88 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.91 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   49.84 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.29%       2.500ms        63.49%      29.982ms       2.498ms       0.000us         0.00%      21.773ms       1.814ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.222ms        60.12%       9.222ms       4.611ms             2
                             MooreExpertsModule_forward         0.27%     128.587us        20.04%       9.462ms       4.731ms       0.000us         0.00%       8.865ms       4.433ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.781ms        50.73%       7.781ms       7.781ms             1
                                              aten::bmm         0.35%     164.212us        14.78%       6.979ms     436.159us       6.519ms        42.50%       6.538ms     408.619us            16
                                            aten::copy_         0.67%     315.261us        12.44%       5.872ms      48.132us       4.741ms        30.91%       4.741ms      38.863us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.548ms        29.65%       4.548ms     349.845us            13
                                           aten::repeat         0.05%      21.663us         9.75%       4.606ms       1.151ms       0.000us         0.00%       4.514ms       1.129ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.138ms        26.98%       4.138ms       2.069ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.845us        10.13%       4.785ms       1.595ms       0.000us         0.00%       2.772ms     923.861us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.222ms
Self CUDA time total: 15.338ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 106          [34mI:[39m 53,500       [34mR:[39m 23.0         [34mS:[39m 0.0          [34mT:[39m 1:45:37
 [34mtrain[39m   [34mE:[39m 107          [34mI:[39m 54,000       [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 1:46:54
[TIME] encode:    6.77 ms
[TIME] td_target:    4.62 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.27 ms
[TIME] compute Q:    8.07 ms
[TIME] reward loss:    3.96 ms
[TIME] value loss:    0.21 ms
[TIME] backward:   10.06 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    2.83 ms
[TIME] _update total:   51.51 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.05%       2.464ms        60.15%      29.352ms       2.446ms       0.000us         0.00%      21.300ms       1.775ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.970ms        59.35%       8.970ms       4.485ms             2
                             MooreExpertsModule_forward         0.26%     126.651us        18.62%       9.086ms       4.543ms       0.000us         0.00%       8.618ms       4.309ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.787ms        51.52%       7.787ms       7.787ms             1
                                              aten::bmm         0.35%     169.920us        14.25%       6.955ms     434.711us       6.532ms        43.22%       6.550ms     409.395us            16
                                            aten::copy_         0.63%     306.254us        12.54%       6.119ms      50.157us       4.491ms        29.71%       4.491ms      36.808us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.297ms        28.43%       4.297ms     330.576us            13
                                           aten::repeat         0.04%      20.511us         8.95%       4.369ms       1.092ms       0.000us         0.00%       4.264ms       1.066ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.148ms        27.44%       4.148ms       2.074ms             2
                             Torch-Compiled Region: 3/0         0.15%      71.405us        10.34%       5.046ms       1.682ms       0.000us         0.00%       2.788ms     929.383us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.801ms
Self CUDA time total: 15.114ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 108          [34mI:[39m 54,500       [34mR:[39m 23.1         [34mS:[39m 0.0          [34mT:[39m 1:47:47
 [34mtrain[39m   [34mE:[39m 109          [34mI:[39m 55,000       [34mR:[39m 25.7         [34mS:[39m 0.0          [34mT:[39m 1:48:32
[TIME] encode:    6.68 ms
[TIME] td_target:    4.60 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.96 ms
[TIME] compute Q:    7.86 ms
[TIME] reward loss:    3.94 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.96 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   48.84 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.96%       2.299ms        62.99%      29.180ms       2.432ms       0.000us         0.00%      21.406ms       1.784ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.003ms        59.35%       9.003ms       4.502ms             2
                             MooreExpertsModule_forward         0.26%     120.004us        19.67%       9.113ms       4.556ms       0.000us         0.00%       8.666ms       4.333ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.596ms        50.07%       7.596ms       7.596ms             1
                                              aten::bmm         0.37%     170.221us        15.27%       7.073ms     442.057us       6.515ms        42.95%       6.534ms     408.398us            16
                                            aten::copy_         0.65%     301.079us        15.92%       7.377ms      60.466us       4.551ms        30.00%       4.551ms      37.299us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.357ms        28.72%       4.357ms     335.131us            13
                                           aten::repeat         0.04%      20.211us         9.54%       4.419ms       1.105ms       0.000us         0.00%       4.323ms       1.081ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.138ms        27.28%       4.138ms       2.069ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.719us        10.67%       4.944ms       1.648ms       0.000us         0.00%       2.804ms     934.591us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.326ms
Self CUDA time total: 15.170ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 110          [34mI:[39m 55,500       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 1:49:16
 [34mtrain[39m   [34mE:[39m 111          [34mI:[39m 56,000       [34mR:[39m 22.0         [34mS:[39m 0.0          [34mT:[39m 1:50:24
[TIME] encode:    6.77 ms
[TIME] td_target:    4.91 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.98 ms
[TIME] compute Q:    7.96 ms
[TIME] reward loss:    3.76 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.83 ms
[TIME] grad clipping:    0.84 ms
[TIME] optim.step:    2.82 ms
[TIME] _update total:   50.86 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.87%       2.354ms        61.45%      29.679ms       2.473ms       0.000us         0.00%      21.628ms       1.802ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.302ms        60.86%       9.302ms       4.651ms             2
                             MooreExpertsModule_forward         0.27%     129.136us        19.51%       9.422ms       4.711ms       0.000us         0.00%       8.780ms       4.390ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.694ms        50.34%       7.694ms       7.694ms             1
                                              aten::bmm         0.34%     162.472us        14.43%       6.970ms     435.630us       6.570ms        42.98%       6.588ms     411.768us            16
                                            aten::copy_         0.63%     305.046us        15.46%       7.467ms      61.208us       4.621ms        30.23%       4.621ms      37.877us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.428ms        28.97%       4.428ms     340.618us            13
                                           aten::repeat         0.06%      27.879us         9.34%       4.512ms       1.128ms       0.000us         0.00%       4.395ms       1.099ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.174ms        27.31%       4.174ms       2.087ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.667us        10.07%       4.865ms       1.622ms       0.000us         0.00%       2.793ms     931.136us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.295ms
Self CUDA time total: 15.284ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 112          [34mI:[39m 56,500       [34mR:[39m 16.1         [34mS:[39m 0.0          [34mT:[39m 1:51:31
 [34mtrain[39m   [34mE:[39m 113          [34mI:[39m 57,000       [34mR:[39m 22.3         [34mS:[39m 0.0          [34mT:[39m 1:52:18
[TIME] encode:    6.70 ms
[TIME] td_target:    4.65 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.05 ms
[TIME] compute Q:    8.04 ms
[TIME] reward loss:    3.65 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.77 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   48.71 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.03%       2.325ms        62.90%      29.070ms       2.423ms       0.000us         0.00%      21.373ms       1.781ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.010ms        59.51%       9.010ms       4.505ms             2
                             MooreExpertsModule_forward         0.28%     129.302us        19.76%       9.134ms       4.567ms       0.000us         0.00%       8.662ms       4.331ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.786ms        51.43%       7.786ms       7.786ms             1
                                              aten::bmm         0.35%     161.280us        15.20%       7.023ms     438.945us       6.481ms        42.81%       6.500ms     406.263us            16
                                            aten::copy_         0.63%     290.864us        14.36%       6.637ms      54.399us       4.546ms        30.03%       4.546ms      37.259us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.352ms        28.75%       4.352ms     334.799us            13
                                           aten::repeat         0.05%      23.329us         9.55%       4.415ms       1.104ms       0.000us         0.00%       4.319ms       1.080ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.138ms        27.33%       4.138ms       2.069ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.428us        10.68%       4.937ms       1.646ms       0.000us         0.00%       2.779ms     926.210us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.214ms
Self CUDA time total: 15.139ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 114          [34mI:[39m 57,500       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 1:53:03
 [34mtrain[39m   [34mE:[39m 115          [34mI:[39m 58,000       [34mR:[39m 23.8         [34mS:[39m 0.0          [34mT:[39m 1:54:00
[TIME] encode:    6.78 ms
[TIME] td_target:    4.86 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.29 ms
[TIME] compute Q:    8.01 ms
[TIME] reward loss:    3.86 ms
[TIME] value loss:    0.21 ms
[TIME] backward:    9.94 ms
[TIME] grad clipping:    2.37 ms
[TIME] optim.step:    1.21 ms
[TIME] _update total:   51.44 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.90%       2.391ms        60.86%      29.675ms       2.473ms       0.000us         0.00%      21.145ms       1.762ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.078ms        60.41%       9.078ms       4.539ms             2
                             MooreExpertsModule_forward         0.27%     131.490us        19.12%       9.324ms       4.662ms       0.000us         0.00%       8.548ms       4.274ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.767ms        51.68%       7.767ms       7.767ms             1
                                              aten::bmm         0.34%     166.316us        14.24%       6.943ms     433.946us       6.531ms        43.46%       6.550ms     409.353us            16
                                            aten::copy_         0.60%     290.280us        15.68%       7.645ms      62.661us       4.416ms        29.39%       4.416ms      36.198us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.223ms        28.10%       4.223ms     324.835us            13
                                           aten::repeat         0.05%      26.313us         9.12%       4.448ms       1.112ms       0.000us         0.00%       4.189ms       1.047ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.148ms        27.60%       4.148ms       2.074ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.185us        10.02%       4.885ms       1.628ms       0.000us         0.00%       2.776ms     925.357us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.760ms
Self CUDA time total: 15.028ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 116          [34mI:[39m 58,500       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 1:55:16
 [34mtrain[39m   [34mE:[39m 117          [34mI:[39m 59,000       [34mR:[39m 22.3         [34mS:[39m 0.0          [34mT:[39m 1:56:08
[TIME] encode:    7.03 ms
[TIME] td_target:    4.68 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.87 ms
[TIME] compute Q:    7.68 ms
[TIME] reward loss:    3.76 ms
[TIME] value loss:    0.26 ms
[TIME] backward:    9.51 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   48.44 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.07%       2.332ms        64.38%      29.593ms       2.466ms       0.000us         0.00%      21.813ms       1.818ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.356ms        60.95%       9.356ms       4.678ms             2
                             MooreExpertsModule_forward         0.27%     123.669us        20.60%       9.470ms       4.735ms       0.000us         0.00%       8.891ms       4.445ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.424ms        48.36%       7.424ms       7.424ms             1
                                              aten::bmm         0.37%     168.472us        15.30%       7.035ms     439.714us       6.484ms        42.24%       6.502ms     406.380us            16
                                            aten::copy_         0.66%     301.525us        12.66%       5.817ms      47.684us       4.776ms        31.11%       4.776ms      39.149us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.584ms        29.87%       4.584ms     352.651us            13
                                           aten::repeat         0.05%      20.827us        10.10%       4.641ms       1.160ms       0.000us         0.00%       4.551ms       1.138ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.130ms        26.91%       4.130ms       2.065ms             2
                             Torch-Compiled Region: 3/0         0.14%      65.828us        10.31%       4.740ms       1.580ms       0.000us         0.00%       2.764ms     921.455us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 45.969ms
Self CUDA time total: 15.350ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 118          [34mI:[39m 59,500       [34mR:[39m 23.9         [34mS:[39m 0.0          [34mT:[39m 1:56:53
 [34mtrain[39m   [34mE:[39m 119          [34mI:[39m 60,000       [34mR:[39m 15.3         [34mS:[39m 0.0          [34mT:[39m 1:57:42
[TIME] encode:    6.69 ms
[TIME] td_target:    4.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.95 ms
[TIME] compute Q:    8.00 ms
[TIME] reward loss:    3.72 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.79 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    2.88 ms
[TIME] _update total:   50.51 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.74%       2.275ms        60.81%      29.180ms       2.432ms       0.000us         0.00%      21.182ms       1.765ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.053ms        60.10%       9.053ms       4.527ms             2
                             MooreExpertsModule_forward         0.27%     128.320us        19.11%       9.171ms       4.586ms       0.000us         0.00%       8.555ms       4.278ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.726ms        51.29%       7.726ms       7.726ms             1
                                              aten::bmm         0.34%     163.816us        14.48%       6.947ms     434.163us       6.549ms        43.48%       6.569ms     410.544us            16
                                            aten::copy_         0.63%     301.663us        14.52%       6.969ms      57.124us       4.440ms        29.48%       4.440ms      36.397us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.246ms        28.19%       4.246ms     326.638us            13
                                           aten::repeat         0.05%      26.357us         9.02%       4.328ms       1.082ms       0.000us         0.00%       4.213ms       1.053ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.136ms        27.46%       4.136ms       2.068ms             2
                             Torch-Compiled Region: 3/0         0.16%      75.265us        10.39%       4.986ms       1.662ms       0.000us         0.00%       2.804ms     934.628us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.984ms
Self CUDA time total: 15.064ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 120          [34mI:[39m 60,500       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 1:59:00
 [34mtrain[39m   [34mE:[39m 121          [34mI:[39m 61,000       [34mR:[39m 23.5         [34mS:[39m 0.0          [34mT:[39m 1:59:55
[TIME] encode:    6.82 ms
[TIME] td_target:    4.86 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   11.44 ms
[TIME] compute Q:    9.64 ms
[TIME] reward loss:    3.67 ms
[TIME] value loss:    0.17 ms
[TIME] backward:   10.02 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.16 ms
[TIME] _update total:   70.57 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.27%       2.468ms        63.48%      29.716ms       2.476ms       0.000us         0.00%      21.578ms       1.798ms            12
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       9.313ms        61.09%       9.313ms       9.313ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.258ms        60.72%       9.258ms       4.629ms             2
                             MooreExpertsModule_forward         0.29%     136.534us        20.04%       9.381ms       4.691ms       0.000us         0.00%       8.762ms       4.381ms             2
                                              aten::bmm         0.34%     160.590us        14.85%       6.954ms     434.608us       6.556ms        43.00%       6.575ms     410.920us            16
                                            aten::copy_         0.63%     295.004us        13.01%       6.088ms      49.902us       4.612ms        30.26%       4.612ms      37.807us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.420ms        28.99%       4.420ms     339.989us            13
                                           aten::repeat         0.05%      23.621us         9.58%       4.485ms       1.121ms       0.000us         0.00%       4.386ms       1.097ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.167ms        27.33%       4.167ms       2.084ms             2
                             Torch-Compiled Region: 3/0         0.19%      87.120us        10.65%       4.984ms       1.661ms       0.000us         0.00%       2.790ms     929.979us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.813ms
Self CUDA time total: 15.245ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 122          [34mI:[39m 61,500       [34mR:[39m 22.8         [34mS:[39m 0.0          [34mT:[39m 2:00:40
 [34mtrain[39m   [34mE:[39m 123          [34mI:[39m 62,000       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 2:01:27
[TIME] encode:    6.63 ms
[TIME] td_target:    4.83 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.92 ms
[TIME] compute Q:    7.87 ms
[TIME] reward loss:    3.89 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   10.02 ms
[TIME] grad clipping:    0.93 ms
[TIME] optim.step:    3.00 ms
[TIME] _update total:   51.11 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.75%       2.302ms        60.43%      29.307ms       2.442ms       0.000us         0.00%      20.975ms       1.748ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.112ms        60.96%       9.112ms       4.556ms             2
                             MooreExpertsModule_forward         0.31%     151.863us        19.07%       9.251ms       4.625ms       0.000us         0.00%       8.460ms       4.230ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.612ms        50.92%       7.612ms       7.612ms             1
                                              aten::bmm         0.34%     164.393us        14.61%       7.088ms     442.995us       6.515ms        43.59%       6.534ms     408.398us            16
                                            aten::copy_         0.62%     299.954us        14.47%       7.018ms      57.522us       4.347ms        29.08%       4.347ms      35.629us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.153ms        27.78%       4.153ms     319.475us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.137ms        27.67%       4.137ms       2.068ms             2
                                           aten::repeat         0.05%      23.804us         8.73%       4.234ms       1.058ms       0.000us         0.00%       4.120ms       1.030ms             4
                             Torch-Compiled Region: 3/0         0.15%      71.324us         9.98%       4.839ms       1.613ms       0.000us         0.00%       2.783ms     927.525us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.498ms
Self CUDA time total: 14.948ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 124          [34mI:[39m 62,500       [34mR:[39m 23.1         [34mS:[39m 0.0          [34mT:[39m 2:02:46
 [34mtrain[39m   [34mE:[39m 125          [34mI:[39m 63,000       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 2:03:43
[TIME] encode:    6.86 ms
[TIME] td_target:    4.64 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.94 ms
[TIME] compute Q:    7.85 ms
[TIME] reward loss:    3.87 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.62 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   48.64 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.06%       2.333ms        63.26%      29.159ms       2.430ms       0.000us         0.00%      21.397ms       1.783ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.041ms        59.78%       9.041ms       4.521ms             2
                             MooreExpertsModule_forward         0.27%     124.895us        19.87%       9.160ms       4.580ms       0.000us         0.00%       8.704ms       4.352ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.586ms        50.16%       7.586ms       7.586ms             1
                                              aten::bmm         0.36%     164.644us        14.99%       6.910ms     431.901us       6.490ms        42.91%       6.508ms     406.767us            16
                                            aten::copy_         0.68%     311.537us        12.37%       5.702ms      46.738us       4.565ms        30.19%       4.565ms      37.421us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.373ms        28.91%       4.373ms     336.359us            13
                                           aten::repeat         0.05%      20.838us         9.62%       4.432ms       1.108ms       0.000us         0.00%       4.339ms       1.085ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.155ms        27.47%       4.155ms       2.077ms             2
                             Torch-Compiled Region: 3/0         0.15%      67.449us        10.15%       4.679ms       1.560ms       0.000us         0.00%       2.773ms     924.443us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.094ms
Self CUDA time total: 15.123ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 126          [34mI:[39m 63,500       [34mR:[39m 22.1         [34mS:[39m 0.0          [34mT:[39m 2:04:29
 [34mtrain[39m   [34mE:[39m 127          [34mI:[39m 64,000       [34mR:[39m 21.9         [34mS:[39m 0.0          [34mT:[39m 2:05:13
[TIME] encode:    6.98 ms
[TIME] td_target:    4.58 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.97 ms
[TIME] compute Q:    7.74 ms
[TIME] reward loss:    3.75 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.78 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.07 ms
[TIME] _update total:   48.58 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.97%       2.290ms        63.61%      29.340ms       2.445ms       0.000us         0.00%      21.899ms       1.825ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.246ms        59.95%       9.246ms       4.623ms             2
                             MooreExpertsModule_forward         0.28%     127.303us        20.30%       9.362ms       4.681ms       0.000us         0.00%       8.906ms       4.453ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.487ms        48.54%       7.487ms       7.487ms             1
                                              aten::bmm         0.36%     167.342us        15.78%       7.278ms     454.876us       6.871ms        44.55%       6.890ms     430.641us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.465ms        28.95%       4.465ms       2.232ms             2
                                            aten::copy_         0.66%     304.369us        11.76%       5.426ms      44.474us       4.458ms        28.91%       4.458ms      36.543us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.265ms        27.66%       4.265ms     328.091us            13
                                           aten::repeat         0.04%      20.179us         9.38%       4.325ms       1.081ms       0.000us         0.00%       4.232ms       1.058ms             4
                             Torch-Compiled Region: 3/0         0.14%      64.733us        10.22%       4.713ms       1.571ms       0.000us         0.00%       2.797ms     932.283us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.121ms
Self CUDA time total: 15.423ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 128          [34mI:[39m 64,500       [34mR:[39m 22.8         [34mS:[39m 0.0          [34mT:[39m 2:06:32
 [34mtrain[39m   [34mE:[39m 129          [34mI:[39m 65,000       [34mR:[39m 25.2         [34mS:[39m 0.0          [34mT:[39m 2:07:31
[TIME] encode:    6.64 ms
[TIME] td_target:    4.72 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.71 ms
[TIME] compute Q:    7.92 ms
[TIME] reward loss:    3.74 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.77 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   48.31 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.95%       2.270ms        63.09%      28.939ms       2.412ms       0.000us         0.00%      21.272ms       1.773ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.088ms        60.21%       9.088ms       4.544ms             2
                             MooreExpertsModule_forward         0.27%     122.540us        20.06%       9.200ms       4.600ms       0.000us         0.00%       8.609ms       4.305ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.657ms        50.73%       7.657ms       7.657ms             1
                                              aten::bmm         0.36%     166.973us        15.20%       6.971ms     435.676us       6.556ms        43.44%       6.575ms     410.957us            16
                                            aten::copy_         0.65%     299.822us        11.84%       5.430ms      44.510us       4.458ms        29.54%       4.458ms      36.539us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.265ms        28.26%       4.265ms     328.086us            13
                                           aten::repeat         0.05%      21.901us         9.43%       4.327ms       1.082ms       0.000us         0.00%       4.232ms       1.058ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.168ms        27.62%       4.168ms       2.084ms             2
                             Torch-Compiled Region: 3/0         0.15%      66.977us        10.23%       4.691ms       1.564ms       0.000us         0.00%       2.781ms     927.088us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 45.868ms
Self CUDA time total: 15.093ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 130          [34mI:[39m 65,500       [34mR:[39m 22.5         [34mS:[39m 0.0          [34mT:[39m 2:08:17
 [34mtrain[39m   [34mE:[39m 131          [34mI:[39m 66,000       [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 2:09:01
[TIME] encode:    6.86 ms
[TIME] td_target:    4.68 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.92 ms
[TIME] compute Q:    7.64 ms
[TIME] reward loss:    3.89 ms
[TIME] value loss:    0.20 ms
[TIME] backward:   10.29 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.12 ms
[TIME] _update total:   49.22 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.00%       2.341ms        63.01%      29.476ms       2.456ms       0.000us         0.00%      21.513ms       1.793ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.188ms        60.38%       9.188ms       4.594ms             2
                             MooreExpertsModule_forward         0.25%     115.269us        19.92%       9.319ms       4.660ms       0.000us         0.00%       8.726ms       4.363ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.365ms        48.39%       7.365ms       7.365ms             1
                                              aten::bmm         0.38%     179.661us        15.10%       7.064ms     441.506us       6.533ms        42.93%       6.553ms     409.539us            16
                                            aten::copy_         0.60%     281.439us        11.82%       5.531ms      45.340us       4.597ms        30.21%       4.597ms      37.680us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.404ms        28.94%       4.404ms     338.776us            13
                                           aten::repeat         0.04%      19.844us         9.56%       4.470ms       1.118ms       0.000us         0.00%       4.371ms       1.093ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.146ms        27.24%       4.146ms       2.073ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.830ms        18.59%       2.830ms     943.217us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.779ms
Self CUDA time total: 15.218ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 132          [34mI:[39m 66,500       [34mR:[39m 15.6         [34mS:[39m 0.0          [34mT:[39m 2:10:21
 [34mtrain[39m   [34mE:[39m 133          [34mI:[39m 67,000       [34mR:[39m 15.5         [34mS:[39m 0.0          [34mT:[39m 2:11:19
[TIME] encode:    6.67 ms
[TIME] td_target:    4.64 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.94 ms
[TIME] compute Q:    7.99 ms
[TIME] reward loss:    3.72 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.96 ms
[TIME] grad clipping:    0.78 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   48.84 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.11%       2.367ms        62.52%      28.972ms       2.414ms       0.000us         0.00%      21.384ms       1.782ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.997ms        59.35%       8.997ms       4.498ms             2
                             MooreExpertsModule_forward         0.28%     128.366us        19.67%       9.113ms       4.557ms       0.000us         0.00%       8.655ms       4.328ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.737ms        51.04%       7.737ms       7.737ms             1
                                              aten::bmm         0.35%     161.287us        14.94%       6.923ms     432.659us       6.536ms        43.12%       6.555ms     409.709us            16
                                            aten::copy_         0.64%     297.634us        11.84%       5.485ms      44.958us       4.531ms        29.89%       4.531ms      37.141us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.338ms        28.62%       4.338ms     333.718us            13
                                           aten::repeat         0.05%      21.636us         9.49%       4.399ms       1.100ms       0.000us         0.00%       4.305ms       1.076ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.143ms        27.33%       4.143ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.436us        10.43%       4.834ms       1.611ms       0.000us         0.00%       2.803ms     934.322us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.342ms
Self CUDA time total: 15.159ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 134          [34mI:[39m 67,500       [34mR:[39m 23.8         [34mS:[39m 0.0          [34mT:[39m 2:12:05
 [34mtrain[39m   [34mE:[39m 135          [34mI:[39m 68,000       [34mR:[39m 16.1         [34mS:[39m 0.0          [34mT:[39m 2:12:49
[TIME] encode:    6.88 ms
[TIME] td_target:    4.85 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.26 ms
[TIME] compute Q:    7.98 ms
[TIME] reward loss:    3.90 ms
[TIME] value loss:    0.24 ms
[TIME] backward:   10.02 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   49.97 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.37%       2.542ms        63.20%      29.894ms       2.491ms       0.000us         0.00%      21.717ms       1.810ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.159ms        59.75%       9.159ms       4.579ms             2
                             MooreExpertsModule_forward         0.27%     128.418us        19.61%       9.275ms       4.637ms       0.000us         0.00%       8.819ms       4.409ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.649ms        49.90%       7.649ms       7.649ms             1
                                              aten::bmm         0.39%     186.202us        14.72%       6.962ms     435.137us       6.540ms        42.67%       6.560ms     409.983us            16
                                            aten::copy_         0.62%     293.682us        11.91%       5.632ms      46.163us       4.693ms        30.61%       4.693ms      38.464us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.499ms        29.35%       4.499ms     346.087us            13
                                           aten::repeat         0.04%      21.256us         9.64%       4.560ms       1.140ms       0.000us         0.00%       4.466ms       1.116ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.141ms        27.01%       4.141ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.591us        10.38%       4.907ms       1.636ms       0.000us         0.00%       2.806ms     935.186us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.297ms
Self CUDA time total: 15.329ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 136          [34mI:[39m 68,500       [34mR:[39m 22.4         [34mS:[39m 0.0          [34mT:[39m 2:14:09
 [34mtrain[39m   [34mE:[39m 137          [34mI:[39m 69,000       [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 2:15:18
[TIME] encode:    6.70 ms
[TIME] td_target:    4.75 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.92 ms
[TIME] compute Q:    7.87 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.72 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   48.58 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.08%       2.341ms        63.32%      29.203ms       2.434ms       0.000us         0.00%      21.307ms       1.776ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.121ms        60.36%       9.121ms       4.560ms             2
                             MooreExpertsModule_forward         0.26%     120.167us        20.01%       9.230ms       4.615ms       0.000us         0.00%       8.629ms       4.314ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.611ms        50.36%       7.611ms       7.611ms             1
                                              aten::bmm         0.37%     168.635us        15.46%       7.131ms     445.709us       6.543ms        43.30%       6.562ms     410.139us            16
                                            aten::copy_         0.66%     305.341us        12.02%       5.545ms      45.450us       4.496ms        29.75%       4.496ms      36.854us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.303ms        28.47%       4.303ms     330.991us            13
                                           aten::repeat         0.05%      21.261us         9.46%       4.361ms       1.090ms       0.000us         0.00%       4.270ms       1.067ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.151ms        27.47%       4.151ms       2.075ms             2
                             Torch-Compiled Region: 3/0         0.15%      68.618us        10.44%       4.815ms       1.605ms       0.000us         0.00%       2.772ms     923.964us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.121ms
Self CUDA time total: 15.111ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 138          [34mI:[39m 69,500       [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 2:16:03
 [34mtrain[39m   [34mE:[39m 139          [34mI:[39m 70,000       [34mR:[39m 16.5         [34mS:[39m 0.0          [34mT:[39m 2:16:46
[TIME] encode:    6.86 ms
[TIME] td_target:    4.94 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.83 ms
[TIME] compute Q:    7.96 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.71 ms
[TIME] grad clipping:    0.80 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   48.70 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.06%       2.343ms        64.21%      29.722ms       2.477ms       0.000us         0.00%      21.924ms       1.827ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.451ms        61.31%       9.451ms       4.726ms             2
                             MooreExpertsModule_forward         0.30%     140.637us        20.70%       9.582ms       4.791ms       0.000us         0.00%       8.937ms       4.468ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.577ms        49.15%       7.577ms       7.577ms             1
                                              aten::bmm         0.34%     157.687us        15.79%       7.308ms     456.770us       6.768ms        43.90%       6.787ms     424.197us            16
                                            aten::copy_         0.66%     304.336us        12.26%       5.675ms      46.513us       4.557ms        29.56%       4.557ms      37.355us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.396ms        28.52%       4.396ms       2.198ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.365ms        28.31%       4.365ms     335.744us            13
                                           aten::repeat         0.05%      20.919us         9.61%       4.450ms       1.112ms       0.000us         0.00%       4.331ms       1.083ms             4
                             Torch-Compiled Region: 3/0         0.15%      67.744us        10.30%       4.768ms       1.589ms       0.000us         0.00%       2.783ms     927.688us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.286ms
Self CUDA time total: 15.417ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 140          [34mI:[39m 70,500       [34mR:[39m 21.6         [34mS:[39m 0.0          [34mT:[39m 2:18:06
 [34mtrain[39m   [34mE:[39m 141          [34mI:[39m 71,000       [34mR:[39m 16.3         [34mS:[39m 0.0          [34mT:[39m 2:19:02
[TIME] encode:    6.77 ms
[TIME] td_target:    4.73 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.14 ms
[TIME] compute Q:    8.06 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.61 ms
[TIME] grad clipping:    0.98 ms
[TIME] optim.step:    1.15 ms
[TIME] _update total:   49.26 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.23%       2.440ms        63.36%      29.535ms       2.461ms       0.000us         0.00%      21.555ms       1.796ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.087ms        59.56%       9.087ms       4.544ms             2
                             MooreExpertsModule_forward         0.30%     138.540us        19.76%       9.211ms       4.605ms       0.000us         0.00%       8.727ms       4.363ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.793ms        51.07%       7.793ms       7.793ms             1
                                              aten::bmm         0.36%     168.386us        14.95%       6.969ms     435.591us       6.569ms        43.05%       6.588ms     411.729us            16
                                            aten::copy_         0.62%     287.010us        14.32%       6.675ms      54.714us       4.606ms        30.19%       4.606ms      37.754us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.414ms        28.93%       4.414ms     339.505us            13
                                           aten::repeat         0.05%      23.775us         9.61%       4.481ms       1.120ms       0.000us         0.00%       4.380ms       1.095ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.140ms        27.14%       4.140ms       2.070ms             2
                             Torch-Compiled Region: 3/0         0.16%      72.543us        10.83%       5.050ms       1.683ms       0.000us         0.00%       2.831ms     943.655us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.615ms
Self CUDA time total: 15.258ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 142          [34mI:[39m 71,500       [34mR:[39m 22.8         [34mS:[39m 0.0          [34mT:[39m 2:19:48
 [34mtrain[39m   [34mE:[39m 143          [34mI:[39m 72,000       [34mR:[39m 22.6         [34mS:[39m 0.0          [34mT:[39m 2:20:32
[TIME] encode:    6.89 ms
[TIME] td_target:    4.81 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.06 ms
[TIME] compute Q:    7.94 ms
[TIME] reward loss:    3.75 ms
[TIME] value loss:    0.22 ms
[TIME] backward:    9.89 ms
[TIME] grad clipping:    0.89 ms
[TIME] optim.step:    1.16 ms
[TIME] _update total:   49.45 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.10%       2.387ms        63.16%      29.570ms       2.464ms       0.000us         0.00%      21.498ms       1.792ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.221ms        60.68%       9.221ms       4.610ms             2
                             MooreExpertsModule_forward         0.28%     129.429us        19.96%       9.345ms       4.672ms       0.000us         0.00%       8.735ms       4.367ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.589ms        49.94%       7.589ms       7.589ms             1
                                              aten::bmm         0.35%     163.713us        15.62%       7.311ms     456.937us       6.762ms        44.50%       6.781ms     423.823us            16
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.405ms        28.99%       4.405ms       2.203ms             2
                                            aten::copy_         0.67%     315.295us        13.90%       6.510ms      53.359us       4.350ms        28.63%       4.350ms      35.657us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.157ms        27.36%       4.157ms     319.796us            13
                                           aten::repeat         0.04%      19.686us         9.00%       4.213ms       1.053ms       0.000us         0.00%       4.124ms       1.031ms             4
                             Torch-Compiled Region: 3/0         0.18%      84.546us        10.26%       4.802ms       1.601ms       0.000us         0.00%       2.787ms     928.884us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.818ms
Self CUDA time total: 15.196ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 144          [34mI:[39m 72,500       [34mR:[39m 22.1         [34mS:[39m 0.0          [34mT:[39m 2:21:51
 [34mtrain[39m   [34mE:[39m 145          [34mI:[39m 73,000       [34mR:[39m 22.4         [34mS:[39m 0.0          [34mT:[39m 2:22:48
[TIME] encode:    6.72 ms
[TIME] td_target:    4.58 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.01 ms
[TIME] compute Q:    7.91 ms
[TIME] reward loss:    3.78 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.82 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   48.65 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.06%       2.333ms        62.84%      28.979ms       2.415ms       0.000us         0.00%      21.232ms       1.769ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.930ms        59.23%       8.930ms       4.465ms             2
                             MooreExpertsModule_forward         0.28%     127.056us        19.62%       9.045ms       4.523ms       0.000us         0.00%       8.587ms       4.293ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.650ms        50.74%       7.650ms       7.650ms             1
                                              aten::bmm         0.35%     162.095us        15.40%       7.100ms     443.763us       6.532ms        43.33%       6.551ms     409.425us            16
                                            aten::copy_         0.65%     300.399us        11.88%       5.477ms      44.893us       4.455ms        29.55%       4.455ms      36.513us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.261ms        28.26%       4.261ms     327.750us            13
                                           aten::repeat         0.05%      21.661us         9.37%       4.322ms       1.080ms       0.000us         0.00%       4.227ms       1.057ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.150ms        27.53%       4.150ms       2.075ms             2
                             Torch-Compiled Region: 3/0         0.15%      70.689us        10.61%       4.895ms       1.632ms       0.000us         0.00%       2.784ms     928.089us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.113ms
Self CUDA time total: 15.076ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 146          [34mI:[39m 73,500       [34mR:[39m 22.8         [34mS:[39m 0.0          [34mT:[39m 2:23:33
 [34mtrain[39m   [34mE:[39m 147          [34mI:[39m 74,000       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 2:24:17
[TIME] encode:    7.13 ms
[TIME] td_target:    4.70 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.13 ms
[TIME] compute Q:    7.99 ms
[TIME] reward loss:    3.68 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.98 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    2.75 ms
[TIME] _update total:   51.13 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.10%       2.476ms        61.55%      29.898ms       2.492ms       0.000us         0.00%      22.261ms       1.855ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.432ms        60.47%       9.432ms       4.716ms             2
                             MooreExpertsModule_forward         0.24%     118.079us        19.66%       9.548ms       4.774ms       0.000us         0.00%       9.099ms       4.549ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.722ms        49.51%       7.722ms       7.722ms             1
                                              aten::bmm         0.34%     166.213us        14.94%       7.257ms     453.546us       6.845ms        43.89%       6.864ms     428.987us            16
                                            aten::copy_         0.60%     293.187us        11.53%       5.599ms      45.892us       4.653ms        29.83%       4.653ms      38.142us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.462ms        28.61%       4.462ms       2.231ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.461ms        28.60%       4.461ms     343.130us            13
                                           aten::repeat         0.04%      19.724us         9.30%       4.516ms       1.129ms       0.000us         0.00%       4.427ms       1.107ms             4
                             Torch-Compiled Region: 3/0         0.14%      67.788us         9.87%       4.795ms       1.598ms       0.000us         0.00%       2.809ms     936.247us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.573ms
Self CUDA time total: 15.597ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 148          [34mI:[39m 74,500       [34mR:[39m 23.1         [34mS:[39m 0.0          [34mT:[39m 2:25:37
 [34mtrain[39m   [34mE:[39m 149          [34mI:[39m 75,000       [34mR:[39m 21.3         [34mS:[39m 0.0          [34mT:[39m 2:26:34
[TIME] encode:    6.91 ms
[TIME] td_target:    4.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.04 ms
[TIME] compute Q:    8.16 ms
[TIME] reward loss:    4.09 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.87 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    2.89 ms
[TIME] _update total:   51.35 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.82%       2.350ms        60.46%      29.474ms       2.456ms       0.000us         0.00%      21.419ms       1.785ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.140ms        60.22%       9.140ms       4.570ms             2
                             MooreExpertsModule_forward         0.25%     120.984us        18.97%       9.248ms       4.624ms       0.000us         0.00%       8.676ms       4.338ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.900ms        52.05%       7.900ms       7.900ms             1
                                              aten::bmm         0.34%     164.192us        14.50%       7.068ms     441.757us       6.522ms        42.97%       6.542ms     408.844us            16
                                            aten::copy_         0.62%     301.216us        11.37%       5.545ms      45.449us       4.561ms        30.05%       4.561ms      37.386us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.369ms        28.78%       4.369ms     336.066us            13
                                           aten::repeat         0.04%      20.714us         9.08%       4.425ms       1.106ms       0.000us         0.00%       4.335ms       1.084ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.135ms        27.25%       4.135ms       2.068ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.957ms        19.48%       2.957ms     985.684us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.747ms
Self CUDA time total: 15.178ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 150          [34mI:[39m 75,500       [34mR:[39m 23.8         [34mS:[39m 0.0          [34mT:[39m 2:27:19
 [34mtrain[39m   [34mE:[39m 151          [34mI:[39m 76,000       [34mR:[39m 23.3         [34mS:[39m 0.0          [34mT:[39m 2:28:03
[TIME] encode:    6.90 ms
[TIME] td_target:    4.72 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.18 ms
[TIME] compute Q:    7.89 ms
[TIME] reward loss:    3.77 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.61 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.08 ms
[TIME] _update total:   48.93 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.22%       2.423ms        63.83%      29.643ms       2.470ms       0.000us         0.00%      21.726ms       1.810ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.167ms        59.80%       9.167ms       4.583ms             2
                             MooreExpertsModule_forward         0.27%     124.608us        19.99%       9.282ms       4.641ms       0.000us         0.00%       8.825ms       4.413ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.617ms        49.68%       7.617ms       7.617ms             1
                                              aten::bmm         0.36%     166.941us        14.98%       6.955ms     434.704us       6.561ms        42.80%       6.580ms     411.220us            16
                                            aten::copy_         0.65%     301.649us        13.50%       6.269ms      51.385us       4.701ms        30.66%       4.701ms      38.531us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.508ms        29.41%       4.508ms     346.781us            13
                                           aten::repeat         0.05%      21.695us         9.83%       4.566ms       1.141ms       0.000us         0.00%       4.475ms       1.119ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.141ms        27.01%       4.141ms       2.071ms             2
                             Torch-Compiled Region: 3/0         0.18%      84.473us        10.75%       4.991ms       1.664ms       0.000us         0.00%       2.805ms     934.908us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.438ms
Self CUDA time total: 15.330ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 152          [34mI:[39m 76,500       [34mR:[39m 23.9         [34mS:[39m 0.0          [34mT:[39m 2:28:46
 [34mtrain[39m   [34mE:[39m 153          [34mI:[39m 77,000       [34mR:[39m 39.4         [34mS:[39m 0.0          [34mT:[39m 2:29:55
[TIME] encode:    6.76 ms
[TIME] td_target:    4.67 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.15 ms
[TIME] compute Q:    7.96 ms
[TIME] reward loss:    3.88 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.83 ms
[TIME] grad clipping:    2.62 ms
[TIME] optim.step:    1.18 ms
[TIME] _update total:   51.03 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.75%       2.303ms        60.42%      29.305ms       2.442ms       0.000us         0.00%      21.144ms       1.762ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.057ms        60.23%       9.057ms       4.529ms             2
                             MooreExpertsModule_forward         0.26%     125.543us        18.92%       9.176ms       4.588ms       0.000us         0.00%       8.540ms       4.270ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.703ms        51.23%       7.703ms       7.703ms             1
                                              aten::bmm         0.34%     165.599us        14.34%       6.954ms     434.641us       6.537ms        43.47%       6.556ms     409.751us            16
                                            aten::copy_         0.63%     306.562us        12.97%       6.292ms      51.575us       4.413ms        29.35%       4.413ms      36.170us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.219ms        28.06%       4.219ms     324.505us            13
                                           aten::repeat         0.05%      25.607us         9.16%       4.445ms       1.111ms       0.000us         0.00%       4.185ms       1.046ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.147ms        27.58%       4.147ms       2.074ms             2
                             Torch-Compiled Region: 3/0         0.14%      69.118us        10.19%       4.942ms       1.647ms       0.000us         0.00%       2.786ms     928.625us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.498ms
Self CUDA time total: 15.037ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 154          [34mI:[39m 77,500       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 2:31:01
 [34mtrain[39m   [34mE:[39m 155          [34mI:[39m 78,000       [34mR:[39m 23.4         [34mS:[39m 0.0          [34mT:[39m 2:31:49
[TIME] encode:    7.27 ms
[TIME] td_target:    4.57 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.25 ms
[TIME] compute Q:    7.98 ms
[TIME] reward loss:    3.97 ms
[TIME] value loss:    0.17 ms
[TIME] backward:    9.82 ms
[TIME] grad clipping:    0.86 ms
[TIME] optim.step:    3.00 ms
[TIME] _update total:   51.68 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.06%       2.487ms        61.10%      30.012ms       2.501ms       0.000us         0.00%      21.359ms       1.780ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.034ms        59.71%       9.034ms       4.517ms             2
                             MooreExpertsModule_forward         0.24%     120.165us        18.64%       9.156ms       4.578ms       0.000us         0.00%       8.668ms       4.334ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.707ms        50.94%       7.707ms       7.707ms             1
                                              aten::bmm         0.35%     171.042us        14.34%       7.046ms     440.386us       6.470ms        42.77%       6.489ms     405.553us            16
                                            aten::copy_         0.66%     326.277us        11.48%       5.639ms      46.221us       4.530ms        29.94%       4.530ms      37.127us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.337ms        28.67%       4.337ms     333.605us            13
                                           aten::repeat         0.05%      24.263us         8.96%       4.399ms       1.100ms       0.000us         0.00%       4.303ms       1.076ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.157ms        27.47%       4.157ms       2.078ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.876ms        19.01%       2.876ms     958.810us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.121ms
Self CUDA time total: 15.129ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 156          [34mI:[39m 78,500       [34mR:[39m 23.4         [34mS:[39m 0.0          [34mT:[39m 2:32:34
 [34mtrain[39m   [34mE:[39m 157          [34mI:[39m 79,000       [34mR:[39m 23.9         [34mS:[39m 0.0          [34mT:[39m 2:33:43
[TIME] encode:    7.00 ms
[TIME] td_target:    4.88 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.42 ms
[TIME] compute Q:    8.03 ms
[TIME] reward loss:    4.04 ms
[TIME] value loss:    0.25 ms
[TIME] backward:    9.92 ms
[TIME] grad clipping:    2.58 ms
[TIME] optim.step:    1.24 ms
[TIME] _update total:   52.26 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.99%       2.466ms        61.06%      30.200ms       2.517ms       0.000us         0.00%      21.886ms       1.824ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.339ms        60.74%       9.339ms       4.670ms             2
                             MooreExpertsModule_forward         0.29%     145.796us        19.12%       9.454ms       4.727ms       0.000us         0.00%       8.942ms       4.471ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.750ms        50.41%       7.750ms       7.750ms             1
                                              aten::bmm         0.32%     160.354us        13.89%       6.872ms     429.474us       6.470ms        42.08%       6.489ms     405.536us            16
                                            aten::copy_         0.64%     314.638us        15.34%       7.589ms      62.205us       4.818ms        31.33%       4.818ms      39.488us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.625ms        30.08%       4.625ms     355.789us            13
                                           aten::repeat         0.06%      27.301us         9.53%       4.712ms       1.178ms       0.000us         0.00%       4.592ms       1.148ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.140ms        26.93%       4.140ms       2.070ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.845ms        18.51%       2.845ms     948.463us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.458ms
Self CUDA time total: 15.375ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 158          [34mI:[39m 79,500       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 2:34:49
 [34mtrain[39m   [34mE:[39m 159          [34mI:[39m 80,000       [34mR:[39m 23.6         [34mS:[39m 0.0          [34mT:[39m 2:35:36
[TIME] encode:    6.95 ms
[TIME] td_target:    4.66 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.15 ms
[TIME] compute Q:    8.12 ms
[TIME] reward loss:    4.04 ms
[TIME] value loss:    0.22 ms
[TIME] backward:    9.92 ms
[TIME] grad clipping:    0.83 ms
[TIME] optim.step:    3.07 ms
[TIME] _update total:   51.81 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.90%       2.403ms        59.94%      29.405ms       2.450ms       0.000us         0.00%      21.410ms       1.784ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.015ms        59.47%       9.015ms       4.507ms             2
                             MooreExpertsModule_forward         0.25%     124.290us        18.61%       9.129ms       4.564ms       0.000us         0.00%       8.682ms       4.341ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.835ms        51.69%       7.835ms       7.835ms             1
                                              aten::bmm         0.34%     165.363us        14.22%       6.976ms     435.985us       6.546ms        43.18%       6.565ms     410.290us            16
                                            aten::copy_         0.63%     307.870us        13.75%       6.746ms      55.293us       4.542ms        29.96%       4.542ms      37.230us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.349ms        28.69%       4.349ms     334.575us            13
                                           aten::repeat         0.04%      20.418us         8.98%       4.406ms       1.102ms       0.000us         0.00%       4.316ms       1.079ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.157ms        27.42%       4.157ms       2.078ms             2
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       2.902ms        19.15%       2.902ms     967.395us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.056ms
Self CUDA time total: 15.159ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 160          [34mI:[39m 80,500       [34mR:[39m 23.4         [34mS:[39m 0.0          [34mT:[39m 2:36:20
 [34mtrain[39m   [34mE:[39m 161          [34mI:[39m 81,000       [34mR:[39m 16.1         [34mS:[39m 0.0          [34mT:[39m 2:37:18
[TIME] encode:    6.95 ms
[TIME] td_target:    4.67 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.04 ms
[TIME] compute Q:    7.87 ms
[TIME] reward loss:    3.90 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   10.31 ms
[TIME] grad clipping:    2.61 ms
[TIME] optim.step:    1.22 ms
[TIME] _update total:   51.61 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.73%       2.314ms        60.67%      29.672ms       2.473ms       0.000us         0.00%      21.885ms       1.824ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.308ms        60.46%       9.308ms       4.654ms             2
                             MooreExpertsModule_forward         0.27%     131.434us        19.28%       9.428ms       4.714ms       0.000us         0.00%       8.922ms       4.461ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.604ms        49.40%       7.604ms       7.604ms             1
                                              aten::bmm         0.34%     164.508us        14.73%       7.202ms     450.113us       6.804ms        44.20%       6.822ms     426.406us            16
                                            aten::copy_         0.60%     294.213us        14.58%       7.129ms      58.437us       4.493ms        29.18%       4.493ms      36.824us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.449ms        28.90%       4.449ms       2.224ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.301ms        27.94%       4.301ms     330.816us            13
                                           aten::repeat         0.06%      28.143us         8.98%       4.390ms       1.098ms       0.000us         0.00%       4.267ms       1.067ms             4
                             Torch-Compiled Region: 3/0         0.16%      75.853us         9.89%       4.839ms       1.613ms       0.000us         0.00%       2.795ms     931.799us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.906ms
Self CUDA time total: 15.395ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 162          [34mI:[39m 81,500       [34mR:[39m 26.7         [34mS:[39m 0.0          [34mT:[39m 2:38:32
 [34mtrain[39m   [34mE:[39m 163          [34mI:[39m 82,000       [34mR:[39m 22.5         [34mS:[39m 0.0          [34mT:[39m 2:39:22
[TIME] encode:    6.73 ms
[TIME] td_target:    4.67 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.32 ms
[TIME] compute Q:    8.07 ms
[TIME] reward loss:    3.88 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.80 ms
[TIME] grad clipping:    0.87 ms
[TIME] optim.step:    2.91 ms
[TIME] _update total:   51.29 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.93%       2.396ms        60.60%      29.483ms       2.457ms       0.000us         0.00%      21.542ms       1.795ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.088ms        59.55%       9.088ms       4.544ms             2
                             MooreExpertsModule_forward         0.30%     147.749us        18.91%       9.200ms       4.600ms       0.000us         0.00%       8.728ms       4.364ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.787ms        51.03%       7.787ms       7.787ms             1
                                              aten::bmm         0.33%     161.629us        14.43%       7.019ms     438.665us       6.568ms        43.04%       6.587ms     411.683us            16
                                            aten::copy_         0.67%     327.515us        14.99%       7.293ms      59.779us       4.616ms        30.25%       4.616ms      37.835us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.423ms        28.99%       4.423ms     340.260us            13
                                           aten::repeat         0.04%      19.605us         9.21%       4.482ms       1.121ms       0.000us         0.00%       4.390ms       1.097ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.133ms        27.09%       4.133ms       2.067ms             2
                             Torch-Compiled Region: 3/0         0.15%      71.175us        10.50%       5.108ms       1.703ms       0.000us         0.00%       2.816ms     938.712us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 48.653ms
Self CUDA time total: 15.260ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 164          [34mI:[39m 82,500       [34mR:[39m 14.8         [34mS:[39m 0.0          [34mT:[39m 2:40:06
 [34mtrain[39m   [34mE:[39m 165          [34mI:[39m 83,000       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 2:40:50
[TIME] encode:    6.75 ms
[TIME] td_target:    4.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   13.12 ms
[TIME] compute Q:    8.10 ms
[TIME] reward loss:    3.79 ms
[TIME] value loss:    0.21 ms
[TIME] backward:    9.93 ms
[TIME] grad clipping:    0.82 ms
[TIME] optim.step:    1.15 ms
[TIME] _update total:   49.36 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.02%       2.348ms        62.12%      29.033ms       2.419ms       0.000us         0.00%      21.267ms       1.772ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       8.943ms        59.26%       8.943ms       4.471ms             2
                             MooreExpertsModule_forward         0.26%     123.207us        19.38%       9.056ms       4.528ms       0.000us         0.00%       8.605ms       4.303ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.783ms        51.58%       7.783ms       7.783ms             1
                                              aten::bmm         0.36%     169.209us        14.93%       6.980ms     436.247us       6.565ms        43.50%       6.584ms     411.487us            16
                                            aten::copy_         0.65%     304.581us        11.95%       5.583ms      45.760us       4.464ms        29.58%       4.464ms      36.588us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.271ms        28.30%       4.271ms     328.556us            13
                                           aten::repeat         0.04%      20.313us         9.26%       4.329ms       1.082ms       0.000us         0.00%       4.238ms       1.059ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.158ms        27.55%       4.158ms       2.079ms             2
                             Torch-Compiled Region: 3/0         0.14%      64.173us        10.53%       4.921ms       1.640ms       0.000us         0.00%       2.803ms     934.252us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.736ms
Self CUDA time total: 15.090ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 166          [34mI:[39m 83,500       [34mR:[39m 23.2         [34mS:[39m 0.0          [34mT:[39m 2:42:11
 [34mtrain[39m   [34mE:[39m 167          [34mI:[39m 84,000       [34mR:[39m 22.4         [34mS:[39m 0.0          [34mT:[39m 2:43:11
[TIME] encode:    7.63 ms
[TIME] td_target:    4.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.88 ms
[TIME] compute Q:    7.75 ms
[TIME] reward loss:    3.73 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.82 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.10 ms
[TIME] _update total:   49.22 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.30%       2.947ms        64.12%      29.969ms       2.497ms       0.000us         0.00%      21.885ms       1.824ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.244ms        59.99%       9.244ms       4.622ms             2
                             MooreExpertsModule_forward         0.26%     123.508us        20.02%       9.354ms       4.677ms       0.000us         0.00%       8.909ms       4.455ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.495ms        48.64%       7.495ms       7.495ms             1
                                              aten::bmm         0.35%     162.891us        15.45%       7.221ms     451.324us       6.815ms        44.23%       6.835ms     427.163us            16
                                            aten::copy_         0.65%     305.197us        11.69%       5.463ms      44.776us       4.499ms        29.20%       4.499ms      36.878us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.437ms        28.80%       4.437ms       2.219ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.306ms        27.94%       4.306ms     331.196us            13
                                           aten::repeat         0.04%      20.346us         9.33%       4.362ms       1.091ms       0.000us         0.00%       4.272ms       1.068ms             4
                             Torch-Compiled Region: 3/0         0.14%      64.494us        10.11%       4.726ms       1.575ms       0.000us         0.00%       2.797ms     932.277us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.736ms
Self CUDA time total: 15.408ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 168          [34mI:[39m 84,500       [34mR:[39m 42.0         [34mS:[39m 0.0          [34mT:[39m 2:43:58
 [34mtrain[39m   [34mE:[39m 169          [34mI:[39m 85,000       [34mR:[39m 23.7         [34mS:[39m 0.0          [34mT:[39m 2:44:42
[TIME] encode:    7.52 ms
[TIME] td_target:    4.83 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 6])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 6])
[TIME] rollout:   12.77 ms
[TIME] compute Q:    7.85 ms
[TIME] reward loss:    3.69 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.72 ms
[TIME] grad clipping:    0.75 ms
[TIME] optim.step:    1.11 ms
[TIME] _update total:   49.19 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         6.41%       2.997ms        64.51%      30.175ms       2.515ms       0.000us         0.00%      21.748ms       1.812ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.325ms        60.80%       9.325ms       4.662ms             2
                             MooreExpertsModule_forward         0.25%     118.537us        20.18%       9.438ms       4.719ms       0.000us         0.00%       8.841ms       4.421ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.596ms        49.53%       7.596ms       7.596ms             1
                                              aten::bmm         0.36%     170.450us        15.16%       7.092ms     443.235us       6.522ms        42.53%       6.541ms     408.837us            16
                                            aten::copy_         0.64%     298.649us        12.40%       5.799ms      47.534us       4.723ms        30.80%       4.723ms      38.712us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.530ms        29.54%       4.530ms     348.450us            13
                                           aten::repeat         0.04%      20.508us         9.81%       4.591ms       1.148ms       0.000us         0.00%       4.496ms       1.124ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.135ms        26.96%       4.135ms       2.068ms             2
                             Torch-Compiled Region: 3/0         0.14%      64.358us        10.11%       4.730ms       1.577ms       0.000us         0.00%       2.792ms     930.785us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.776ms
Self CUDA time total: 15.336ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 170          [34mI:[39m 85,500       [34mR:[39m 22.9         [34mS:[39m 0.0          [34mT:[39m 2:46:02
Error executing job with overrides: ['task=walker-walk', 'steps=100000']
Traceback (most recent call last):
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 145, in train
    trainer.train()
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/TDMPC2/algorithms/trainer/online_trainer.py", line 126, in train
    _train_metrics = self.agent.update(self.buffer)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 78, in _patched_update
    return self._update(obs, action, reward, task=task)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/timer.py", line 94, in wrapper
    result = f(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore_agent.py", line 905, in _update
    if do_print:
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_tensor.py", line 624, in backward
    torch.autograd.backward(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
RuntimeError: Function 'ToCopyBackward0' returned nan values in its 0th output.
Set the environment variable HYDRA_FULL_ERROR=1 for a complete stack trace.