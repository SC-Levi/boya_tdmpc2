[34m[1mLogs will be synced with wandb.
Config(env_type='MooreMultiTask', n_contexts=10, obs_dim=24, action_dim=6, hidden_dim=256, n_experts=4, moore_temperature=1.0, use_softmax=True, use_checkpoint=True, use_mixed_precision=True, gamma=0.99, stddev=0.1, actor_updates=1, use_ema=True, ensemble_size=5, update_freq=2, seed=42, device=device(type='cuda', index=0), task='walker-walk', obs='state', multitask=False, steps=100000, batch_size=256, reward_coef=0.1, value_coef=0.1, consistency_coef=20, rho=0.5, lr=0.0003, enc_lr_scale=0.3, grad_clip_norm=20, tau=0.01, discount_denom=5, discount_min=0.95, discount_max=0.995, buffer_size=100000, exp_name='moore-tdmpc2-mt30', eval_freq=50000, eval_episodes=10, moore={'n_experts': 4, 'temperature': 1.0, 'use_softmax': True, 'debug_task_emb': False}, mpc=True, iterations=6, num_samples=512, num_elites=64, num_pi_trajs=24, horizon=3, min_std=0.05, max_std=2, temperature=0.5, log_std_min=-10, log_std_max=2, entropy_coef=0.0001, model_size=5, num_enc_layers=2, enc_dim=256, num_channels=32, mlp_dim=512, latent_dim=512, task_dim=0, num_q=5, dropout=0.01, simnorm_dim=8, num_bins=101, vmin=-10, vmax=10, wandb_project='moore-tdmpc2', wandb_entity='OA-MBRL', wandb_silent=False, enable_wandb=True, save_csv=True, save_video=False, save_agent=True, compile=False, work_dir=PosixPath('/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/logs/walker-walk/42/moore-tdmpc2-mt30'), task_title='Walker Walk', tasks=['walker-walk'], obs_shape={'state': (24,)}, episode_length=500, obs_shapes='???', episode_lengths='???', seed_steps=2500, bin_size=0.2, data_dir='/media/levi/Singe4linux/Moore-TDMPC/TDMPC2/data/mt30')
Architecture: MooreWorldModel(total_params=5260955, latent_dim=512, action_dim=6, n_experts=4, temperature=0.5)
Task Encoder: MooreTaskEncoder(obs_dim=24, latent_dim=512, hidden_dim=256, n_experts=4, temperature=1.0, use_softmax=True)
Transition-Reward Core: MoETransitionRewardModel(latent_dim=512, action_dim=6, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, reward_dim=101, use_mixed_precision=True)
Policy prior: Sequential(
  (0): Linear(in_features=512, out_features=256, bias=True)
  (1): ReLU()
  (2): Linear(in_features=256, out_features=256, bias=True)
  (3): ReLU()
  (4): Linear(in_features=256, out_features=12, bias=True)
)
Q-functions: Ensemble(n_models=5)
[32m[1må¼€å§‹Moore-TDMPC2è®­ç»ƒ...
[32mOnlineTrainer: Starting training loop with profiling enabled
[36mPROFILER STATUS: Enabled=True, Functions=0, Total Calls=0
[36mPROFILER: forward executed in 81.59ms (call 1)
[36mPROFILER: forward executed in 1.10ms (call 2)
[36mPROFILER: forward executed in 2.24ms (call 3)
=== é¦–æ¬¡ eval() é˜¶æ®µçƒ­ç‚¹å‡½æ•° ===
         260486836 function calls (248386661 primitive calls) in 891.470 seconds
   Ordered by: cumulative time
   List reduced from 629 to 20 due to restriction <20>
   ncalls  tottime  percall  cumtime  percall filename:lineno(function)
        1    0.104    0.104  891.470  891.470 /home/levi/Desktop/MOORE-TDMPC/TDMPC2/algorithms/trainer/online_trainer.py:36(eval)
40000/5000    0.258    0.000  888.819    0.178 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/_contextlib.py:113(decorate_context)
     5000    0.023    0.000  888.766    0.178 /home/levi/Desktop/MOORE-TDMPC/TDMPC2/algorithms/tdmpc2.py:92(act)
     5000    6.070    0.001  888.436    0.178 /home/levi/Desktop/MOORE-TDMPC/TDMPC2/algorithms/tdmpc2.py:130(_plan)
    30000    4.338    0.000  856.241    0.029 /home/levi/Desktop/MOORE-TDMPC/TDMPC2/algorithms/tdmpc2.py:117(_estimate_value)
205000/195000    0.152    0.000  820.639    0.004 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_compile.py:22(inner)
205000/195000    0.319    0.000  820.461    0.004 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_dynamo/eval_frame.py:717(_fn)
205000/195000    0.463    0.000  819.213    0.004 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/checkpoint.py:343(checkpoint)
205000/195000    0.560    0.000  817.804    0.004 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/function.py:559(apply)
205000/195000    2.843    0.000  816.345    0.004 {built-in method apply}
3575000/390000    1.764    0.000  790.011    0.002 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/nn/modules/module.py:1736(_wrapped_call_impl)
3575000/390000    3.383    0.000  789.740    0.002 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/nn/modules/module.py:1744(_call_impl)
205000/195000    1.677    0.000  786.429    0.004 /home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/checkpoint.py:226(forward)
   190000   10.459    0.000  759.812    0.004 /home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/world_model_core.py:82(forward)
   195000   24.254    0.000  703.857    0.004 /home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/layers.py:228(forward)
   100000    0.160    0.000  413.930    0.004 /home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/world_model.py:463(next)
   100000    0.391    0.000  413.771    0.004 /home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/world_model.py:216(dynamics_step)
    90000    0.308    0.000  406.074    0.005 /home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/world_model.py:240(reward)
    90000    0.177    0.000  378.188    0.004 /home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/world_model.py:258(_reward_forward)
   390000  351.119    0.001  351.119    0.001 {built-in method torch.bmm}
 [32meval[39m    [34mE:[39m 0            [34mI:[39m 0            [34mR:[39m 35.6         [34mS:[39m 0.0          [34mT:[39m 0:14:51
 [34mtrain[39m   [34mE:[39m 0            [34mI:[39m 500          [34mR:[39m 51.6         [34mS:[39m 0.0          [34mT:[39m 0:14:51
Buffer capacity: 100,000
Storage required: 0.01 GB
Using CUDA:0 memory for storage.
 [34mtrain[39m   [34mE:[39m 1            [34mI:[39m 1,000        [34mR:[39m 50.6         [34mS:[39m 0.0          [34mT:[39m 0:14:51
 [34mtrain[39m   [34mE:[39m 2            [34mI:[39m 1,500        [34mR:[39m 32.8         [34mS:[39m 0.0          [34mT:[39m 0:14:51
 [34mtrain[39m   [34mE:[39m 3            [34mI:[39m 2,000        [34mR:[39m 47.2         [34mS:[39m 0.0          [34mT:[39m 0:14:51
 [34mtrain[39m   [34mE:[39m 4            [34mI:[39m 2,500        [34mR:[39m 39.5         [34mS:[39m 0.0          [34mT:[39m 0:14:52
Pretraining agent on seed data...
 [34mtrain[39m   [34mE:[39m 5            [34mI:[39m 3,000        [34mR:[39m 68.4         [34mS:[39m 0.0          [34mT:[39m 0:18:12
 [34mtrain[39m   [34mE:[39m 6            [34mI:[39m 3,500        [34mR:[39m 57.6         [34mS:[39m 0.0          [34mT:[39m 0:19:57
 [34mtrain[39m   [34mE:[39m 7            [34mI:[39m 4,000        [34mR:[39m 36.3         [34mS:[39m 0.0          [34mT:[39m 0:21:42
 [34mtrain[39m   [34mE:[39m 8            [34mI:[39m 4,500        [34mR:[39m 41.9         [34mS:[39m 0.0          [34mT:[39m 0:23:28
 [34mtrain[39m   [34mE:[39m 9            [34mI:[39m 5,000        [34mR:[39m 34.9         [34mS:[39m 0.0          [34mT:[39m 0:25:13
 [34mtrain[39m   [34mE:[39m 10           [34mI:[39m 5,500        [34mR:[39m 40.2         [34mS:[39m 0.0          [34mT:[39m 0:26:56
 [34mtrain[39m   [34mE:[39m 11           [34mI:[39m 6,000        [34mR:[39m 87.3         [34mS:[39m 0.0          [34mT:[39m 0:28:36
 [34mtrain[39m   [34mE:[39m 12           [34mI:[39m 6,500        [34mR:[39m 33.9         [34mS:[39m 0.0          [34mT:[39m 0:30:21
 [34mtrain[39m   [34mE:[39m 13           [34mI:[39m 7,000        [34mR:[39m 46.1         [34mS:[39m 0.0          [34mT:[39m 0:32:07
 [34mtrain[39m   [34mE:[39m 14           [34mI:[39m 7,500        [34mR:[39m 59.2         [34mS:[39m 0.0          [34mT:[39m 0:33:53
 [34mtrain[39m   [34mE:[39m 15           [34mI:[39m 8,000        [34mR:[39m 32.8         [34mS:[39m 0.0          [34mT:[39m 0:35:39
 [34mtrain[39m   [34mE:[39m 16           [34mI:[39m 8,500        [34mR:[39m 39.8         [34mS:[39m 0.0          [34mT:[39m 0:37:24
 [34mtrain[39m   [34mE:[39m 17           [34mI:[39m 9,000        [34mR:[39m 33.5         [34mS:[39m 0.0          [34mT:[39m 0:39:10
 [34mtrain[39m   [34mE:[39m 18           [34mI:[39m 9,500        [34mR:[39m 70.0         [34mS:[39m 0.0          [34mT:[39m 0:40:56
 [34mtrain[39m   [34mE:[39m 19           [34mI:[39m 10,000       [34mR:[39m 62.7         [34mS:[39m 0.0          [34mT:[39m 0:42:42
 [34mtrain[39m   [34mE:[39m 20           [34mI:[39m 10,500       [34mR:[39m 43.4         [34mS:[39m 0.0          [34mT:[39m 0:44:27
 [34mtrain[39m   [34mE:[39m 21           [34mI:[39m 11,000       [34mR:[39m 50.4         [34mS:[39m 0.0          [34mT:[39m 0:46:13
 [34mtrain[39m   [34mE:[39m 22           [34mI:[39m 11,500       [34mR:[39m 34.5         [34mS:[39m 0.0          [34mT:[39m 0:47:58
 [34mtrain[39m   [34mE:[39m 23           [34mI:[39m 12,000       [34mR:[39m 37.8         [34mS:[39m 0.0          [34mT:[39m 0:49:42
 [34mtrain[39m   [34mE:[39m 24           [34mI:[39m 12,500       [34mR:[39m 48.5         [34mS:[39m 0.0          [34mT:[39m 0:51:25
 [34mtrain[39m   [34mE:[39m 25           [34mI:[39m 13,000       [34mR:[39m 45.7         [34mS:[39m 0.0          [34mT:[39m 0:53:11
 [34mtrain[39m   [34mE:[39m 26           [34mI:[39m 13,500       [34mR:[39m 47.8         [34mS:[39m 0.0          [34mT:[39m 0:54:57
 [34mtrain[39m   [34mE:[39m 27           [34mI:[39m 14,000       [34mR:[39m 46.7         [34mS:[39m 0.0          [34mT:[39m 0:56:38
 [34mtrain[39m   [34mE:[39m 28           [34mI:[39m 14,500       [34mR:[39m 62.9         [34mS:[39m 0.0          [34mT:[39m 0:58:24
 [34mtrain[39m   [34mE:[39m 29           [34mI:[39m 15,000       [34mR:[39m 41.7         [34mS:[39m 0.0          [34mT:[39m 1:00:09
 [34mtrain[39m   [34mE:[39m 30           [34mI:[39m 15,500       [34mR:[39m 50.4         [34mS:[39m 0.0          [34mT:[39m 1:01:53
 [34mtrain[39m   [34mE:[39m 31           [34mI:[39m 16,000       [34mR:[39m 46.8         [34mS:[39m 0.0          [34mT:[39m 1:03:39
 [34mtrain[39m   [34mE:[39m 32           [34mI:[39m 16,500       [34mR:[39m 38.2         [34mS:[39m 0.0          [34mT:[39m 1:05:26
 [34mtrain[39m   [34mE:[39m 33           [34mI:[39m 17,000       [34mR:[39m 31.7         [34mS:[39m 0.0          [34mT:[39m 1:07:13
 [34mtrain[39m   [34mE:[39m 34           [34mI:[39m 17,500       [34mR:[39m 43.2         [34mS:[39m 0.0          [34mT:[39m 1:08:59
 [34mtrain[39m   [34mE:[39m 35           [34mI:[39m 18,000       [34mR:[39m 42.4         [34mS:[39m 0.0          [34mT:[39m 1:10:49
 [34mtrain[39m   [34mE:[39m 36           [34mI:[39m 18,500       [34mR:[39m 45.5         [34mS:[39m 0.0          [34mT:[39m 1:24:50
 [34mtrain[39m   [34mE:[39m 37           [34mI:[39m 19,000       [34mR:[39m 37.1         [34mS:[39m 0.0          [34mT:[39m 1:26:33
 [34mtrain[39m   [34mE:[39m 38           [34mI:[39m 19,500       [34mR:[39m 64.2         [34mS:[39m 0.0          [34mT:[39m 1:28:16
 [34mtrain[39m   [34mE:[39m 39           [34mI:[39m 20,000       [34mR:[39m 34.0         [34mS:[39m 0.0          [34mT:[39m 1:29:59
 [34mtrain[39m   [34mE:[39m 40           [34mI:[39m 20,500       [34mR:[39m 37.7         [34mS:[39m 0.0          [34mT:[39m 1:31:42
 [34mtrain[39m   [34mE:[39m 41           [34mI:[39m 21,000       [34mR:[39m 52.1         [34mS:[39m 0.0          [34mT:[39m 1:33:25
 [34mtrain[39m   [34mE:[39m 42           [34mI:[39m 21,500       [34mR:[39m 56.7         [34mS:[39m 0.0          [34mT:[39m 1:35:08
 [34mtrain[39m   [34mE:[39m 43           [34mI:[39m 22,000       [34mR:[39m 53.4         [34mS:[39m 0.0          [34mT:[39m 1:36:51
 [34mtrain[39m   [34mE:[39m 44           [34mI:[39m 22,500       [34mR:[39m 65.4         [34mS:[39m 0.0          [34mT:[39m 1:38:38
 [34mtrain[39m   [34mE:[39m 45           [34mI:[39m 23,000       [34mR:[39m 58.6         [34mS:[39m 0.0          [34mT:[39m 1:42:58
 [34mtrain[39m   [34mE:[39m 46           [34mI:[39m 23,500       [34mR:[39m 64.4         [34mS:[39m 0.0          [34mT:[39m 1:48:41
 [34mtrain[39m   [34mE:[39m 47           [34mI:[39m 24,000       [34mR:[39m 58.0         [34mS:[39m 0.0          [34mT:[39m 1:54:26
 [34mtrain[39m   [34mE:[39m 48           [34mI:[39m 24,500       [34mR:[39m 38.1         [34mS:[39m 0.0          [34mT:[39m 2:00:11
 [34mtrain[39m   [34mE:[39m 49           [34mI:[39m 25,000       [34mR:[39m 49.9         [34mS:[39m 0.0          [34mT:[39m 2:05:56
 [34mtrain[39m   [34mE:[39m 50           [34mI:[39m 25,500       [34mR:[39m 72.2         [34mS:[39m 0.0          [34mT:[39m 2:11:40
 [34mtrain[39m   [34mE:[39m 51           [34mI:[39m 26,000       [34mR:[39m 37.2         [34mS:[39m 0.0          [34mT:[39m 2:17:24
 [34mtrain[39m   [34mE:[39m 52           [34mI:[39m 26,500       [34mR:[39m 37.8         [34mS:[39m 0.0          [34mT:[39m 2:21:54
 [34mtrain[39m   [34mE:[39m 53           [34mI:[39m 27,000       [34mR:[39m 44.3         [34mS:[39m 0.0          [34mT:[39m 2:26:19
 [34mtrain[39m   [34mE:[39m 54           [34mI:[39m 27,500       [34mR:[39m 41.6         [34mS:[39m 0.0          [34mT:[39m 2:31:46
 [34mtrain[39m   [34mE:[39m 55           [34mI:[39m 28,000       [34mR:[39m 56.4         [34mS:[39m 0.0          [34mT:[39m 2:37:12
 [34mtrain[39m   [34mE:[39m 56           [34mI:[39m 28,500       [34mR:[39m 59.9         [34mS:[39m 0.0          [34mT:[39m 2:42:39
 [34mtrain[39m   [34mE:[39m 57           [34mI:[39m 29,000       [34mR:[39m 49.4         [34mS:[39m 0.0          [34mT:[39m 2:48:05
 [34mtrain[39m   [34mE:[39m 58           [34mI:[39m 29,500       [34mR:[39m 33.9         [34mS:[39m 0.0          [34mT:[39m 2:53:32
 [34mtrain[39m   [34mE:[39m 59           [34mI:[39m 30,000       [34mR:[39m 80.9         [34mS:[39m 0.0          [34mT:[39m 2:58:58
 [34mtrain[39m   [34mE:[39m 60           [34mI:[39m 30,500       [34mR:[39m 42.9         [34mS:[39m 0.0          [34mT:[39m 3:04:24
 [34mtrain[39m   [34mE:[39m 61           [34mI:[39m 31,000       [34mR:[39m 50.6         [34mS:[39m 0.0          [34mT:[39m 3:09:50
 [34mtrain[39m   [34mE:[39m 62           [34mI:[39m 31,500       [34mR:[39m 50.8         [34mS:[39m 0.0          [34mT:[39m 3:15:17
 [34mtrain[39m   [34mE:[39m 63           [34mI:[39m 32,000       [34mR:[39m 47.9         [34mS:[39m 0.0          [34mT:[39m 3:20:42
 [34mtrain[39m   [34mE:[39m 64           [34mI:[39m 32,500       [34mR:[39m 53.2         [34mS:[39m 0.0          [34mT:[39m 3:26:02
 [34mtrain[39m   [34mE:[39m 65           [34mI:[39m 33,000       [34mR:[39m 40.1         [34mS:[39m 0.0          [34mT:[39m 3:31:22
 [34mtrain[39m   [34mE:[39m 66           [34mI:[39m 33,500       [34mR:[39m 42.5         [34mS:[39m 0.0          [34mT:[39m 3:36:45
 [34mtrain[39m   [34mE:[39m 67           [34mI:[39m 34,000       [34mR:[39m 46.2         [34mS:[39m 0.0          [34mT:[39m 3:42:08
 [34mtrain[39m   [34mE:[39m 68           [34mI:[39m 34,500       [34mR:[39m 34.8         [34mS:[39m 0.0          [34mT:[39m 3:47:32
 [34mtrain[39m   [34mE:[39m 69           [34mI:[39m 35,000       [34mR:[39m 39.5         [34mS:[39m 0.0          [34mT:[39m 3:52:48
 [34mtrain[39m   [34mE:[39m 70           [34mI:[39m 35,500       [34mR:[39m 46.8         [34mS:[39m 0.0          [34mT:[39m 3:58:08
 [34mtrain[39m   [34mE:[39m 71           [34mI:[39m 36,000       [34mR:[39m 31.9         [34mS:[39m 0.0          [34mT:[39m 4:03:23
 [34mtrain[39m   [34mE:[39m 72           [34mI:[39m 36,500       [34mR:[39m 33.0         [34mS:[39m 0.0          [34mT:[39m 4:08:43
 [34mtrain[39m   [34mE:[39m 73           [34mI:[39m 37,000       [34mR:[39m 33.6         [34mS:[39m 0.0          [34mT:[39m 4:13:59
 [34mtrain[39m   [34mE:[39m 74           [34mI:[39m 37,500       [34mR:[39m 44.8         [34mS:[39m 0.0          [34mT:[39m 4:19:09
 [34mtrain[39m   [34mE:[39m 75           [34mI:[39m 38,000       [34mR:[39m 42.7         [34mS:[39m 0.0          [34mT:[39m 4:24:19
 [34mtrain[39m   [34mE:[39m 76           [34mI:[39m 38,500       [34mR:[39m 32.7         [34mS:[39m 0.0          [34mT:[39m 4:29:30
 [34mtrain[39m   [34mE:[39m 77           [34mI:[39m 39,000       [34mR:[39m 81.4         [34mS:[39m 0.0          [34mT:[39m 4:34:40
 [34mtrain[39m   [34mE:[39m 78           [34mI:[39m 39,500       [34mR:[39m 39.1         [34mS:[39m 0.0          [34mT:[39m 4:39:50
 [34mtrain[39m   [34mE:[39m 79           [34mI:[39m 40,000       [34mR:[39m 54.3         [34mS:[39m 0.0          [34mT:[39m 4:45:01
 [34mtrain[39m   [34mE:[39m 80           [34mI:[39m 40,500       [34mR:[39m 40.3         [34mS:[39m 0.0          [34mT:[39m 4:50:11
 [34mtrain[39m   [34mE:[39m 81           [34mI:[39m 41,000       [34mR:[39m 33.8         [34mS:[39m 0.0          [34mT:[39m 4:55:21
 [34mtrain[39m   [34mE:[39m 82           [34mI:[39m 41,500       [34mR:[39m 55.4         [34mS:[39m 0.0          [34mT:[39m 5:00:31
 [34mtrain[39m   [34mE:[39m 83           [34mI:[39m 42,000       [34mR:[39m 55.5         [34mS:[39m 0.0          [34mT:[39m 5:05:41
 [34mtrain[39m   [34mE:[39m 84           [34mI:[39m 42,500       [34mR:[39m 51.5         [34mS:[39m 0.0          [34mT:[39m 5:10:51
 [34mtrain[39m   [34mE:[39m 85           [34mI:[39m 43,000       [34mR:[39m 39.4         [34mS:[39m 0.0          [34mT:[39m 5:16:01
 [34mtrain[39m   [34mE:[39m 86           [34mI:[39m 43,500       [34mR:[39m 34.4         [34mS:[39m 0.0          [34mT:[39m 5:21:11
 [34mtrain[39m   [34mE:[39m 87           [34mI:[39m 44,000       [34mR:[39m 40.4         [34mS:[39m 0.0          [34mT:[39m 5:26:21
 [34mtrain[39m   [34mE:[39m 88           [34mI:[39m 44,500       [34mR:[39m 37.1         [34mS:[39m 0.0          [34mT:[39m 5:31:29
 [34mtrain[39m   [34mE:[39m 89           [34mI:[39m 45,000       [34mR:[39m 37.4         [34mS:[39m 0.0          [34mT:[39m 5:36:37
 [34mtrain[39m   [34mE:[39m 90           [34mI:[39m 45,500       [34mR:[39m 54.7         [34mS:[39m 0.0          [34mT:[39m 5:41:44
 [34mtrain[39m   [34mE:[39m 91           [34mI:[39m 46,000       [34mR:[39m 46.4         [34mS:[39m 0.0          [34mT:[39m 5:46:52
 [34mtrain[39m   [34mE:[39m 92           [34mI:[39m 46,500       [34mR:[39m 29.9         [34mS:[39m 0.0          [34mT:[39m 5:51:59
 [34mtrain[39m   [34mE:[39m 93           [34mI:[39m 47,000       [34mR:[39m 62.0         [34mS:[39m 0.0          [34mT:[39m 5:57:07
 [34mtrain[39m   [34mE:[39m 94           [34mI:[39m 47,500       [34mR:[39m 46.1         [34mS:[39m 0.0          [34mT:[39m 6:02:14
 [34mtrain[39m   [34mE:[39m 95           [34mI:[39m 48,000       [34mR:[39m 46.9         [34mS:[39m 0.0          [34mT:[39m 6:07:21
 [34mtrain[39m   [34mE:[39m 96           [34mI:[39m 48,500       [34mR:[39m 49.8         [34mS:[39m 0.0          [34mT:[39m 6:12:29
 [34mtrain[39m   [34mE:[39m 97           [34mI:[39m 49,000       [34mR:[39m 59.0         [34mS:[39m 0.0          [34mT:[39m 6:17:36
 [34mtrain[39m   [34mE:[39m 98           [34mI:[39m 49,500       [34mR:[39m 50.3         [34mS:[39m 0.0          [34mT:[39m 6:22:44
 [32meval[39m    [34mE:[39m 99           [34mI:[39m 50,000       [34mR:[39m 35.0         [34mS:[39m 0.0          [34mT:[39m 7:03:24
 [34mtrain[39m   [34mE:[39m 99           [34mI:[39m 50,000       [34mR:[39m 48.1         [34mS:[39m 0.0          [34mT:[39m 7:03:24
 [34mtrain[39m   [34mE:[39m 100          [34mI:[39m 50,500       [34mR:[39m 44.3         [34mS:[39m 0.0          [34mT:[39m 7:08:31
 [34mtrain[39m   [34mE:[39m 101          [34mI:[39m 51,000       [34mR:[39m 37.8         [34mS:[39m 0.0          [34mT:[39m 7:13:38
 [34mtrain[39m   [34mE:[39m 102          [34mI:[39m 51,500       [34mR:[39m 35.5         [34mS:[39m 0.0          [34mT:[39m 7:18:46
 [34mtrain[39m   [34mE:[39m 103          [34mI:[39m 52,000       [34mR:[39m 37.5         [34mS:[39m 0.0          [34mT:[39m 7:23:53
 [34mtrain[39m   [34mE:[39m 104          [34mI:[39m 52,500       [34mR:[39m 34.8         [34mS:[39m 0.0          [34mT:[39m 7:29:00
 [34mtrain[39m   [34mE:[39m 105          [34mI:[39m 53,000       [34mR:[39m 61.3         [34mS:[39m 0.0          [34mT:[39m 7:34:08
 [34mtrain[39m   [34mE:[39m 106          [34mI:[39m 53,500       [34mR:[39m 60.7         [34mS:[39m 0.0          [34mT:[39m 7:39:16
 [34mtrain[39m   [34mE:[39m 107          [34mI:[39m 54,000       [34mR:[39m 36.1         [34mS:[39m 0.0          [34mT:[39m 7:44:23
 [34mtrain[39m   [34mE:[39m 108          [34mI:[39m 54,500       [34mR:[39m 36.3         [34mS:[39m 0.0          [34mT:[39m 7:49:30
 [34mtrain[39m   [34mE:[39m 109          [34mI:[39m 55,000       [34mR:[39m 46.3         [34mS:[39m 0.0          [34mT:[39m 7:54:38
 [34mtrain[39m   [34mE:[39m 110          [34mI:[39m 55,500       [34mR:[39m 57.7         [34mS:[39m 0.0          [34mT:[39m 7:59:45
 [34mtrain[39m   [34mE:[39m 111          [34mI:[39m 56,000       [34mR:[39m 45.5         [34mS:[39m 0.0          [34mT:[39m 8:04:52
 [34mtrain[39m   [34mE:[39m 112          [34mI:[39m 56,500       [34mR:[39m 60.6         [34mS:[39m 0.0          [34mT:[39m 8:10:00
 [34mtrain[39m   [34mE:[39m 113          [34mI:[39m 57,000       [34mR:[39m 60.2         [34mS:[39m 0.0          [34mT:[39m 8:15:07
 [34mtrain[39m   [34mE:[39m 114          [34mI:[39m 57,500       [34mR:[39m 35.6         [34mS:[39m 0.0          [34mT:[39m 8:20:15
 [34mtrain[39m   [34mE:[39m 115          [34mI:[39m 58,000       [34mR:[39m 60.4         [34mS:[39m 0.0          [34mT:[39m 8:25:22
 [34mtrain[39m   [34mE:[39m 116          [34mI:[39m 58,500       [34mR:[39m 48.5         [34mS:[39m 0.0          [34mT:[39m 8:30:29
 [34mtrain[39m   [34mE:[39m 117          [34mI:[39m 59,000       [34mR:[39m 57.9         [34mS:[39m 0.0          [34mT:[39m 8:35:37
 [34mtrain[39m   [34mE:[39m 118          [34mI:[39m 59,500       [34mR:[39m 47.4         [34mS:[39m 0.0          [34mT:[39m 8:40:45
 [34mtrain[39m   [34mE:[39m 119          [34mI:[39m 60,000       [34mR:[39m 44.9         [34mS:[39m 0.0          [34mT:[39m 8:45:52
 [34mtrain[39m   [34mE:[39m 120          [34mI:[39m 60,500       [34mR:[39m 48.3         [34mS:[39m 0.0          [34mT:[39m 8:51:00
 [34mtrain[39m   [34mE:[39m 121          [34mI:[39m 61,000       [34mR:[39m 43.5         [34mS:[39m 0.0          [34mT:[39m 8:56:07
 [34mtrain[39m   [34mE:[39m 122          [34mI:[39m 61,500       [34mR:[39m 53.2         [34mS:[39m 0.0          [34mT:[39m 9:01:14
 [34mtrain[39m   [34mE:[39m 123          [34mI:[39m 62,000       [34mR:[39m 39.9         [34mS:[39m 0.0          [34mT:[39m 9:06:22
 [34mtrain[39m   [34mE:[39m 124          [34mI:[39m 62,500       [34mR:[39m 53.1         [34mS:[39m 0.0          [34mT:[39m 9:11:29
 [34mtrain[39m   [34mE:[39m 125          [34mI:[39m 63,000       [34mR:[39m 50.2         [34mS:[39m 0.0          [34mT:[39m 9:16:36
 [34mtrain[39m   [34mE:[39m 126          [34mI:[39m 63,500       [34mR:[39m 50.6         [34mS:[39m 0.0          [34mT:[39m 9:21:44
 [34mtrain[39m   [34mE:[39m 127          [34mI:[39m 64,000       [34mR:[39m 58.2         [34mS:[39m 0.0          [34mT:[39m 9:26:51
 [34mtrain[39m   [34mE:[39m 128          [34mI:[39m 64,500       [34mR:[39m 34.5         [34mS:[39m 0.0          [34mT:[39m 9:31:58
 [34mtrain[39m   [34mE:[39m 129          [34mI:[39m 65,000       [34mR:[39m 37.7         [34mS:[39m 0.0          [34mT:[39m 9:37:05
 [34mtrain[39m   [34mE:[39m 130          [34mI:[39m 65,500       [34mR:[39m 37.7         [34mS:[39m 0.0          [34mT:[39m 9:42:13
 [34mtrain[39m   [34mE:[39m 131          [34mI:[39m 66,000       [34mR:[39m 36.7         [34mS:[39m 0.0          [34mT:[39m 9:47:20
 [34mtrain[39m   [34mE:[39m 132          [34mI:[39m 66,500       [34mR:[39m 30.7         [34mS:[39m 0.0          [34mT:[39m 9:52:28
 [34mtrain[39m   [34mE:[39m 133          [34mI:[39m 67,000       [34mR:[39m 31.8         [34mS:[39m 0.0          [34mT:[39m 9:57:35
 [34mtrain[39m   [34mE:[39m 134          [34mI:[39m 67,500       [34mR:[39m 33.4         [34mS:[39m 0.0          [34mT:[39m 10:02:42
 [34mtrain[39m   [34mE:[39m 135          [34mI:[39m 68,000       [34mR:[39m 42.2         [34mS:[39m 0.0          [34mT:[39m 10:07:49
 [34mtrain[39m   [34mE:[39m 136          [34mI:[39m 68,500       [34mR:[39m 48.5         [34mS:[39m 0.0          [34mT:[39m 10:12:56
 [34mtrain[39m   [34mE:[39m 137          [34mI:[39m 69,000       [34mR:[39m 46.2         [34mS:[39m 0.0          [34mT:[39m 10:18:03
 [34mtrain[39m   [34mE:[39m 138          [34mI:[39m 69,500       [34mR:[39m 40.0         [34mS:[39m 0.0          [34mT:[39m 10:23:11
 [34mtrain[39m   [34mE:[39m 139          [34mI:[39m 70,000       [34mR:[39m 38.3         [34mS:[39m 0.0          [34mT:[39m 10:28:18
 [34mtrain[39m   [34mE:[39m 140          [34mI:[39m 70,500       [34mR:[39m 62.2         [34mS:[39m 0.0          [34mT:[39m 10:33:25
 [34mtrain[39m   [34mE:[39m 141          [34mI:[39m 71,000       [34mR:[39m 45.1         [34mS:[39m 0.0          [34mT:[39m 10:38:33
 [34mtrain[39m   [34mE:[39m 142          [34mI:[39m 71,500       [34mR:[39m 46.9         [34mS:[39m 0.0          [34mT:[39m 10:43:47
 [34mtrain[39m   [34mE:[39m 143          [34mI:[39m 72,000       [34mR:[39m 32.9         [34mS:[39m 0.0          [34mT:[39m 10:49:27
 [34mtrain[39m   [34mE:[39m 144          [34mI:[39m 72,500       [34mR:[39m 50.2         [34mS:[39m 0.0          [34mT:[39m 10:55:09
 [34mtrain[39m   [34mE:[39m 145          [34mI:[39m 73,000       [34mR:[39m 44.3         [34mS:[39m 0.0          [34mT:[39m 11:00:51
 [34mtrain[39m   [34mE:[39m 146          [34mI:[39m 73,500       [34mR:[39m 31.7         [34mS:[39m 0.0          [34mT:[39m 11:06:33
 [34mtrain[39m   [34mE:[39m 147          [34mI:[39m 74,000       [34mR:[39m 41.4         [34mS:[39m 0.0          [34mT:[39m 11:12:15
 [34mtrain[39m   [34mE:[39m 148          [34mI:[39m 74,500       [34mR:[39m 48.5         [34mS:[39m 0.0          [34mT:[39m 11:17:57
 [34mtrain[39m   [34mE:[39m 149          [34mI:[39m 75,000       [34mR:[39m 34.8         [34mS:[39m 0.0          [34mT:[39m 11:23:05
 [34mtrain[39m   [34mE:[39m 150          [34mI:[39m 75,500       [34mR:[39m 36.8         [34mS:[39m 0.0          [34mT:[39m 11:28:12
 [34mtrain[39m   [34mE:[39m 151          [34mI:[39m 76,000       [34mR:[39m 49.3         [34mS:[39m 0.0          [34mT:[39m 11:33:20
 [34mtrain[39m   [34mE:[39m 152          [34mI:[39m 76,500       [34mR:[39m 35.5         [34mS:[39m 0.0          [34mT:[39m 11:38:27
 [34mtrain[39m   [34mE:[39m 153          [34mI:[39m 77,000       [34mR:[39m 78.1         [34mS:[39m 0.0          [34mT:[39m 11:43:35
 [34mtrain[39m   [34mE:[39m 154          [34mI:[39m 77,500       [34mR:[39m 46.6         [34mS:[39m 0.0          [34mT:[39m 11:48:42
 [34mtrain[39m   [34mE:[39m 155          [34mI:[39m 78,000       [34mR:[39m 53.4         [34mS:[39m 0.0          [34mT:[39m 11:53:50
 [34mtrain[39m   [34mE:[39m 156          [34mI:[39m 78,500       [34mR:[39m 34.8         [34mS:[39m 0.0          [34mT:[39m 11:58:58
 [34mtrain[39m   [34mE:[39m 157          [34mI:[39m 79,000       [34mR:[39m 60.3         [34mS:[39m 0.0          [34mT:[39m 12:04:05
 [34mtrain[39m   [34mE:[39m 158          [34mI:[39m 79,500       [34mR:[39m 34.2         [34mS:[39m 0.0          [34mT:[39m 12:09:13
 [34mtrain[39m   [34mE:[39m 159          [34mI:[39m 80,000       [34mR:[39m 38.5         [34mS:[39m 0.0          [34mT:[39m 12:14:20
 [34mtrain[39m   [34mE:[39m 160          [34mI:[39m 80,500       [34mR:[39m 33.1         [34mS:[39m 0.0          [34mT:[39m 12:19:28
 [34mtrain[39m   [34mE:[39m 161          [34mI:[39m 81,000       [34mR:[39m 34.2         [34mS:[39m 0.0          [34mT:[39m 12:24:35
 [34mtrain[39m   [34mE:[39m 162          [34mI:[39m 81,500       [34mR:[39m 46.1         [34mS:[39m 0.0          [34mT:[39m 12:29:43
 [34mtrain[39m   [34mE:[39m 163          [34mI:[39m 82,000       [34mR:[39m 48.8         [34mS:[39m 0.0          [34mT:[39m 12:34:51
 [34mtrain[39m   [34mE:[39m 164          [34mI:[39m 82,500       [34mR:[39m 35.5         [34mS:[39m 0.0          [34mT:[39m 12:39:58
 [34mtrain[39m   [34mE:[39m 165          [34mI:[39m 83,000       [34mR:[39m 32.3         [34mS:[39m 0.0          [34mT:[39m 12:45:06
 [34mtrain[39m   [34mE:[39m 166          [34mI:[39m 83,500       [34mR:[39m 50.1         [34mS:[39m 0.0          [34mT:[39m 12:50:13
 [34mtrain[39m   [34mE:[39m 167          [34mI:[39m 84,000       [34mR:[39m 65.3         [34mS:[39m 0.0          [34mT:[39m 12:55:21
 [34mtrain[39m   [34mE:[39m 168          [34mI:[39m 84,500       [34mR:[39m 64.9         [34mS:[39m 0.0          [34mT:[39m 13:00:29
 [34mtrain[39m   [34mE:[39m 169          [34mI:[39m 85,000       [34mR:[39m 53.6         [34mS:[39m 0.0          [34mT:[39m 13:05:36
 [34mtrain[39m   [34mE:[39m 170          [34mI:[39m 85,500       [34mR:[39m 36.1         [34mS:[39m 0.0          [34mT:[39m 13:10:43
 [34mtrain[39m   [34mE:[39m 171          [34mI:[39m 86,000       [34mR:[39m 42.9         [34mS:[39m 0.0          [34mT:[39m 13:15:51
 [34mtrain[39m   [34mE:[39m 172          [34mI:[39m 86,500       [34mR:[39m 43.5         [34mS:[39m 0.0          [34mT:[39m 13:20:58
 [34mtrain[39m   [34mE:[39m 173          [34mI:[39m 87,000       [34mR:[39m 60.9         [34mS:[39m 0.0          [34mT:[39m 13:26:05
 [34mtrain[39m   [34mE:[39m 174          [34mI:[39m 87,500       [34mR:[39m 37.4         [34mS:[39m 0.0          [34mT:[39m 13:31:14
 [34mtrain[39m   [34mE:[39m 175          [34mI:[39m 88,000       [34mR:[39m 37.1         [34mS:[39m 0.0          [34mT:[39m 13:36:23
 [34mtrain[39m   [34mE:[39m 176          [34mI:[39m 88,500       [34mR:[39m 47.3         [34mS:[39m 0.0          [34mT:[39m 13:41:32
 [34mtrain[39m   [34mE:[39m 177          [34mI:[39m 89,000       [34mR:[39m 72.7         [34mS:[39m 0.0          [34mT:[39m 13:46:40
 [34mtrain[39m   [34mE:[39m 178          [34mI:[39m 89,500       [34mR:[39m 49.0         [34mS:[39m 0.0          [34mT:[39m 13:51:48
 [34mtrain[39m   [34mE:[39m 179          [34mI:[39m 90,000       [34mR:[39m 49.2         [34mS:[39m 0.0          [34mT:[39m 13:56:56
 [34mtrain[39m   [34mE:[39m 180          [34mI:[39m 90,500       [34mR:[39m 39.1         [34mS:[39m 0.0          [34mT:[39m 14:02:03
 [34mtrain[39m   [34mE:[39m 181          [34mI:[39m 91,000       [34mR:[39m 47.2         [34mS:[39m 0.0          [34mT:[39m 14:07:11
 [34mtrain[39m   [34mE:[39m 182          [34mI:[39m 91,500       [34mR:[39m 36.2         [34mS:[39m 0.0          [34mT:[39m 14:12:19
 [34mtrain[39m   [34mE:[39m 183          [34mI:[39m 92,000       [34mR:[39m 34.7         [34mS:[39m 0.0          [34mT:[39m 14:17:26
 [34mtrain[39m   [34mE:[39m 184          [34mI:[39m 92,500       [34mR:[39m 36.9         [34mS:[39m 0.0          [34mT:[39m 14:22:36
 [34mtrain[39m   [34mE:[39m 185          [34mI:[39m 93,000       [34mR:[39m 35.2         [34mS:[39m 0.0          [34mT:[39m 14:27:44
 [34mtrain[39m   [34mE:[39m 186          [34mI:[39m 93,500       [34mR:[39m 70.5         [34mS:[39m 0.0          [34mT:[39m 14:32:54
 [34mtrain[39m   [34mE:[39m 187          [34mI:[39m 94,000       [34mR:[39m 45.2         [34mS:[39m 0.0          [34mT:[39m 14:38:02
 [34mtrain[39m   [34mE:[39m 188          [34mI:[39m 94,500       [34mR:[39m 60.2         [34mS:[39m 0.0          [34mT:[39m 14:43:11
 [34mtrain[39m   [34mE:[39m 189          [34mI:[39m 95,000       [34mR:[39m 42.4         [34mS:[39m 0.0          [34mT:[39m 14:48:22
 [34mtrain[39m   [34mE:[39m 190          [34mI:[39m 95,500       [34mR:[39m 49.4         [34mS:[39m 0.0          [34mT:[39m 14:53:35
 [34mtrain[39m   [34mE:[39m 191          [34mI:[39m 96,000       [34mR:[39m 46.9         [34mS:[39m 0.0          [34mT:[39m 14:58:52
Traceback (most recent call last):
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/train_with_cprofile.py", line 174, in <module>
    train()
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/train_with_cprofile.py", line 161, in train
    trainer.train()
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Desktop/MOORE-TDMPC/TDMPC2/algorithms/trainer/online_trainer.py", line 126, in train
    _train_metrics = self.agent.update(self.buffer)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/train_with_cprofile.py", line 106, in _patched_update
    return self._update(obs, action, reward, task=task)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/train_moore_agent.py", line 303, in _update
    v_flat = self.model.encode(obs_next)           # [B*H, D]
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/train_moore_agent.py", line 242, in encode_only
    out = orig_encode(obs, task) if task is not None else orig_encode(obs)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/world_model.py", line 208, in encode
    v_c = checkpoint(self.task_encoder, obs, task)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
    return fn(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/checkpoint.py", line 489, in checkpoint
    return CheckpointFunction.apply(function, preserve, *args)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/checkpoint.py", line 264, in forward
    outputs = run_function(*args)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1740, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/task_encoder.py", line 168, in forward
    expert_out = checkpoint(self._experts_forward, flat_obs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_compile.py", line 32, in inner
    return disable_fn(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_dynamo/eval_frame.py", line 721, in _fn
    return fn(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/checkpoint.py", line 489, in checkpoint
    return CheckpointFunction.apply(function, preserve, *args)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/function.py", line 575, in apply
    return super().apply(*args, **kwargs)  # type: ignore[misc]
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/utils/checkpoint.py", line 264, in forward
    outputs = run_function(*args)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/task_encoder.py", line 61, in _experts_forward
    return self.experts(flat_obs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1740, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1751, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/levi/Desktop/MOORE-TDMPC/moore_tdmpc/layers.py", line 247, in forward
    feat = torch.bmm(h1.reshape(B*E, 1, -1),
KeyboardInterrupt