[34m[1mLogs will be synced with wandb.
Config(env_type='MooreMultiTask', n_contexts=1, obs_dim=39, action_dim=4, hidden_dim=256, n_experts=4, moore_temperature=1.0, use_softmax=True, use_checkpoint=True, use_mixed_precision=True, gamma=0.99, stddev=0.1, actor_updates=1, use_ema=True, ensemble_size=5, update_freq=2, seed=42, device=device(type='cuda', index=0), task='mw-reach', obs='state', multitask=False, steps=10000, batch_size=256, reward_coef=0.1, value_coef=0.1, consistency_coef=20, rho=0.5, lr=0.0003, enc_lr_scale=0.3, grad_clip_norm=20, tau=0.01, discount_denom=5, discount_min=0.95, discount_max=0.995, buffer_size=100000, exp_name='moore-tdmpc2-mt30', eval_freq=50000, eval_episodes=10, moore={'n_experts': 4, 'temperature': 1.0, 'use_softmax': True, 'debug_task_emb': False}, mpc=True, iterations=6, num_samples=512, num_elites=64, num_pi_trajs=24, horizon=3, min_std=0.05, max_std=2, temperature=0.5, log_std_min=-10, log_std_max=2, entropy_coef=0.0001, model_size=5, num_enc_layers=2, enc_dim=256, num_channels=32, mlp_dim=512, latent_dim=512, task_dim=0, num_q=5, dropout=0.01, simnorm_dim=8, num_bins=101, vmin=-10, vmax=10, wandb_project='moore-tdmpc2', wandb_entity='OA-MBRL', wandb_silent=False, enable_wandb=True, save_csv=True, save_video=False, save_agent=True, compile=False, work_dir=PosixPath('/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/logs/mw-reach/42/moore-tdmpc2-mt30'), task_title='Mw Reach', tasks=['mw-reach'], obs_shape={'state': (39,)}, episode_length=100, obs_shapes='???', episode_lengths='???', seed_steps=1000, bin_size=0.2, data_dir='/media/levi/Singe4linux/Moore-TDMPC/TDMPC2/data/mt30')
Architecture: MooreWorldModel(total_params=5138070, latent_dim=512, action_dim=4, n_experts=4, temperature=0.5)
Task Encoder: MooreTaskEncoder(obs_dim=39, latent_dim=512, hidden_dim=256, n_experts=4, temperature=1.0, use_softmax=True)
Transition-Reward Core: MoETransitionRewardModel(latent_dim=512, action_dim=4, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, reward_dim=101, use_mixed_precision=True)
Policy prior: Sequential(
  (0): Linear(in_features=512, out_features=256, bias=True)
  (1): ReLU()
  (2): Linear(in_features=256, out_features=256, bias=True)
  (3): ReLU()
  (4): Linear(in_features=256, out_features=8, bias=True)
)
Q-functions: Ensemble(n_models=5)
[32m[1må¼€å§‹Moore-TDMPC2è®­ç»ƒ...
[36mPROFILER STATUS: Enabled=True, Functions=1, Total Calls=1
[32mOnlineTrainer: Starting training loop with profiling enabled
[36mPROFILER STATUS: Enabled=True, Functions=1, Total Calls=1
[36mPROFILER: forward executed in 1.12ms (call 2)
[36mPROFILER: forward executed in 0.69ms (call 3)
 [32meval[39m    [34mE:[39m 0            [34mI:[39m 0            [34mR:[39m 272.0        [34mS:[39m 0.0          [34mT:[39m 0:00:02
 [34mtrain[39m   [34mE:[39m 0            [34mI:[39m 100          [34mR:[39m 364.9        [34mS:[39m 0.0          [34mT:[39m 0:00:02
Buffer capacity: 10,000
Storage required: 0.00 GB
Using CUDA:0 memory for storage.
 [34mtrain[39m   [34mE:[39m 1            [34mI:[39m 200          [34mR:[39m 315.7        [34mS:[39m 0.0          [34mT:[39m 0:00:02
 [34mtrain[39m   [34mE:[39m 2            [34mI:[39m 300          [34mR:[39m 605.1        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 3            [34mI:[39m 400          [34mR:[39m 347.1        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 4            [34mI:[39m 500          [34mR:[39m 319.2        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 5            [34mI:[39m 600          [34mR:[39m 274.8        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 6            [34mI:[39m 700          [34mR:[39m 276.7        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 7            [34mI:[39m 800          [34mR:[39m 190.2        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 8            [34mI:[39m 900          [34mR:[39m 547.0        [34mS:[39m 0.0          [34mT:[39m 0:00:03
 [34mtrain[39m   [34mE:[39m 9            [34mI:[39m 1,000        [34mR:[39m 361.1        [34mS:[39m 0.0          [34mT:[39m 0:00:03
Pretraining agent on seed data...
[36mPROFILER: _td_target executed in 0.36ms (call 1)
[36mPROFILER: _update executed in 291.57ms (call 1)
[36mPROFILER: _td_target executed in 0.58ms (call 2)
[36mPROFILER: _update executed in 135.47ms (call 2)
[36mPROFILER: _td_target executed in 0.37ms (call 3)
[36mPROFILER: _update executed in 167.94ms (call 3)
[TIME] encode:    7.15 ms
[TIME] td_target:    4.89 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   19.30 ms
[TIME] compute Q:   10.81 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.16 ms
[TIME] backward:    9.87 ms
[TIME] grad clipping:   27.46 ms
[TIME] optim.step:    2.15 ms
[TIME] _update total:   82.96 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         3.35%       1.888ms        62.17%      35.065ms       5.009ms       0.000us         0.00%      26.273ms       3.753ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      20.387ms       104.60%      20.387ms       4.077ms             5
                             MooreExpertsModule_forward         0.55%     307.647us        36.64%      20.666ms       4.133ms       0.000us         0.00%      17.009ms       3.402ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      12.671ms        65.01%      12.671ms      12.671ms             1
                                              aten::bmm         0.24%     133.826us        21.31%      12.018ms     751.096us       6.098ms        31.29%      11.617ms     726.085us            16
                                            aten::copy_         0.64%     359.125us        25.05%      14.131ms      90.581us      11.057ms        56.73%      11.057ms      70.877us           156
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.560ms        54.18%      10.560ms      10.560ms             1
                             WorldModel_core_vectorized         0.08%      46.232us        22.91%      12.920ms      12.920ms       0.000us         0.00%       8.119ms       8.119ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.919ms        35.50%       6.919ms     314.490us            22
                                           aten::repeat         0.11%      64.362us        12.62%       7.120ms     711.963us       0.000us         0.00%       6.878ms     687.762us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 56.400ms
Self CUDA time total: 19.490ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 10           [34mI:[39m 1,100        [34mR:[39m 59.0         [34mS:[39m 0.0          [34mT:[39m 0:02:46
 [34mtrain[39m   [34mE:[39m 11           [34mI:[39m 1,200        [34mR:[39m 55.8         [34mS:[39m 0.0          [34mT:[39m 0:03:02
 [34mtrain[39m   [34mE:[39m 12           [34mI:[39m 1,300        [34mR:[39m 44.7         [34mS:[39m 0.0          [34mT:[39m 0:03:17
 [34mtrain[39m   [34mE:[39m 13           [34mI:[39m 1,400        [34mR:[39m 59.1         [34mS:[39m 0.0          [34mT:[39m 0:03:31
 [34mtrain[39m   [34mE:[39m 14           [34mI:[39m 1,500        [34mR:[39m 46.9         [34mS:[39m 0.0          [34mT:[39m 0:03:45
 [34mtrain[39m   [34mE:[39m 15           [34mI:[39m 1,600        [34mR:[39m 47.5         [34mS:[39m 0.0          [34mT:[39m 0:04:00
 [34mtrain[39m   [34mE:[39m 16           [34mI:[39m 1,700        [34mR:[39m 65.1         [34mS:[39m 0.0          [34mT:[39m 0:04:15
 [34mtrain[39m   [34mE:[39m 17           [34mI:[39m 1,800        [34mR:[39m 62.4         [34mS:[39m 0.0          [34mT:[39m 0:04:29
 [34mtrain[39m   [34mE:[39m 18           [34mI:[39m 1,900        [34mR:[39m 45.8         [34mS:[39m 0.0          [34mT:[39m 0:04:44
 [34mtrain[39m   [34mE:[39m 19           [34mI:[39m 2,000        [34mR:[39m 58.8         [34mS:[39m 0.0          [34mT:[39m 0:04:59
[TIME] encode:    9.85 ms
[TIME] td_target:    6.44 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   32.36 ms
[TIME] compute Q:   12.51 ms
[TIME] reward loss:    0.51 ms
[TIME] value loss:    0.40 ms
[TIME] backward:   41.43 ms
[TIME] grad clipping:    0.84 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:  106.43 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         1.58%       1.640ms        45.74%      47.551ms       6.793ms       0.000us         0.00%      26.692ms       3.813ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      24.227ms       122.52%      24.227ms       4.845ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      17.474ms        88.37%      17.474ms      17.474ms             1
                             MooreExpertsModule_forward         0.28%     285.934us        23.96%      24.912ms       4.982ms       0.000us         0.00%      17.239ms       3.448ms             5
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      12.172ms        61.56%      12.172ms      12.172ms             1
                                              aten::bmm         0.13%     130.850us        14.30%      14.865ms     929.042us       6.362ms        32.18%      11.845ms     740.301us            16
                                            aten::copy_         0.34%     351.582us        22.03%      22.903ms     146.812us      11.028ms        55.77%      11.028ms      70.689us           156
                             WorldModel_core_vectorized         0.03%      35.097us        17.09%      17.765ms      17.765ms       0.000us         0.00%       8.190ms       8.190ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.899ms        34.89%       6.899ms     313.580us            22
                                           aten::repeat         0.06%      59.855us         7.42%       7.715ms     771.546us       0.000us         0.00%       6.856ms     685.633us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 103.965ms
Self CUDA time total: 19.773ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 20           [34mI:[39m 2,100        [34mR:[39m 67.5         [34mS:[39m 0.0          [34mT:[39m 0:05:14
 [34mtrain[39m   [34mE:[39m 21           [34mI:[39m 2,200        [34mR:[39m 68.5         [34mS:[39m 0.0          [34mT:[39m 0:05:30
 [34mtrain[39m   [34mE:[39m 22           [34mI:[39m 2,300        [34mR:[39m 47.8         [34mS:[39m 0.0          [34mT:[39m 0:05:46
 [34mtrain[39m   [34mE:[39m 23           [34mI:[39m 2,400        [34mR:[39m 64.8         [34mS:[39m 0.0          [34mT:[39m 0:06:02
 [34mtrain[39m   [34mE:[39m 24           [34mI:[39m 2,500        [34mR:[39m 56.7         [34mS:[39m 0.0          [34mT:[39m 0:06:18
 [34mtrain[39m   [34mE:[39m 25           [34mI:[39m 2,600        [34mR:[39m 72.4         [34mS:[39m 0.0          [34mT:[39m 0:06:34
 [34mtrain[39m   [34mE:[39m 26           [34mI:[39m 2,700        [34mR:[39m 64.7         [34mS:[39m 0.0          [34mT:[39m 0:06:50
 [34mtrain[39m   [34mE:[39m 27           [34mI:[39m 2,800        [34mR:[39m 82.3         [34mS:[39m 0.0          [34mT:[39m 0:07:06
 [34mtrain[39m   [34mE:[39m 28           [34mI:[39m 2,900        [34mR:[39m 79.7         [34mS:[39m 0.0          [34mT:[39m 0:07:23
 [34mtrain[39m   [34mE:[39m 29           [34mI:[39m 3,000        [34mR:[39m 66.2         [34mS:[39m 0.0          [34mT:[39m 0:07:39
[TIME] encode:   11.50 ms
[TIME] td_target:    7.32 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   36.12 ms
[TIME] compute Q:   11.16 ms
[TIME] reward loss:    0.11 ms
[TIME] value loss:    0.16 ms
[TIME] backward:   11.69 ms
[TIME] grad clipping:    0.79 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   80.76 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         2.12%       1.662ms        72.83%      57.046ms       8.149ms       0.000us         0.00%      26.831ms       3.833ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      25.762ms       130.32%      25.762ms       5.152ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      23.469ms       118.72%      23.469ms      23.469ms             1
                             MooreExpertsModule_forward         0.38%     296.008us        33.69%      26.389ms       5.278ms       0.000us         0.00%      17.274ms       3.455ms             5
                                              aten::bmm         0.16%     124.256us        19.14%      14.989ms     936.802us       6.324ms        31.99%      11.774ms     735.897us            16
                                            aten::copy_         0.45%     354.485us        27.91%      21.859ms     140.122us      11.094ms        56.12%      11.094ms      71.113us           156
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.800ms        54.63%      10.800ms      10.800ms             1
                             WorldModel_core_vectorized         0.07%      57.231us        30.35%      23.775ms      23.775ms       0.000us         0.00%       8.102ms       8.102ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.994ms        35.38%       6.994ms     317.898us            22
                                           aten::repeat         0.07%      57.326us        10.48%       8.210ms     821.003us       0.000us         0.00%       6.953ms     695.286us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 78.326ms
Self CUDA time total: 19.769ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 30           [34mI:[39m 3,100        [34mR:[39m 85.8         [34mS:[39m 0.0          [34mT:[39m 0:07:57
 [34mtrain[39m   [34mE:[39m 31           [34mI:[39m 3,200        [34mR:[39m 65.4         [34mS:[39m 0.0          [34mT:[39m 0:08:14
 [34mtrain[39m   [34mE:[39m 32           [34mI:[39m 3,300        [34mR:[39m 69.9         [34mS:[39m 0.0          [34mT:[39m 0:08:31
 [34mtrain[39m   [34mE:[39m 33           [34mI:[39m 3,400        [34mR:[39m 71.3         [34mS:[39m 0.0          [34mT:[39m 0:08:47
 [34mtrain[39m   [34mE:[39m 34           [34mI:[39m 3,500        [34mR:[39m 77.0         [34mS:[39m 0.0          [34mT:[39m 0:09:01
 [34mtrain[39m   [34mE:[39m 35           [34mI:[39m 3,600        [34mR:[39m 90.3         [34mS:[39m 0.0          [34mT:[39m 0:09:16
 [34mtrain[39m   [34mE:[39m 36           [34mI:[39m 3,700        [34mR:[39m 95.0         [34mS:[39m 0.0          [34mT:[39m 0:09:31
 [34mtrain[39m   [34mE:[39m 37           [34mI:[39m 3,800        [34mR:[39m 83.7         [34mS:[39m 0.0          [34mT:[39m 0:09:45
 [34mtrain[39m   [34mE:[39m 38           [34mI:[39m 3,900        [34mR:[39m 88.0         [34mS:[39m 0.0          [34mT:[39m 0:10:00
 [34mtrain[39m   [34mE:[39m 39           [34mI:[39m 4,000        [34mR:[39m 83.3         [34mS:[39m 0.0          [34mT:[39m 0:10:15
[TIME] encode:    8.58 ms
[TIME] td_target:    5.09 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   41.76 ms
[TIME] compute Q:   14.58 ms
[TIME] reward loss:    0.48 ms
[TIME] value loss:    0.40 ms
[TIME] backward:   22.76 ms
[TIME] grad clipping:    0.81 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   96.62 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         1.85%       1.743ms        51.31%      48.270ms       6.896ms       0.000us         0.00%      27.503ms       3.929ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      23.419ms       116.30%      23.419ms       4.684ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      22.383ms       111.16%      22.383ms      22.383ms             1
                             MooreExpertsModule_forward         0.32%     304.920us        25.28%      23.779ms       4.756ms       0.000us         0.00%      17.596ms       3.519ms             5
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      14.016ms        69.60%      14.016ms      14.016ms             1
                                              aten::bmm         0.14%     131.028us        16.10%      15.147ms     946.671us       6.365ms        31.61%      11.865ms     741.533us            16
                                            aten::copy_         0.38%     353.668us        24.57%      23.116ms     148.177us      11.389ms        56.56%      11.389ms      73.009us           156
                             WorldModel_core_vectorized         0.04%      34.562us        24.11%      22.684ms      22.684ms       0.000us         0.00%       8.083ms       8.083ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       7.234ms        35.92%       7.234ms     328.819us            22
                                           aten::repeat         0.07%      66.498us         8.44%       7.939ms     793.916us       0.000us         0.00%       7.190ms     718.987us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 94.069ms
Self CUDA time total: 20.136ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 40           [34mI:[39m 4,100        [34mR:[39m 71.4         [34mS:[39m 0.0          [34mT:[39m 0:10:30
 [34mtrain[39m   [34mE:[39m 41           [34mI:[39m 4,200        [34mR:[39m 75.9         [34mS:[39m 0.0          [34mT:[39m 0:10:46
 [34mtrain[39m   [34mE:[39m 42           [34mI:[39m 4,300        [34mR:[39m 73.4         [34mS:[39m 0.0          [34mT:[39m 0:11:02
 [34mtrain[39m   [34mE:[39m 43           [34mI:[39m 4,400        [34mR:[39m 89.2         [34mS:[39m 0.0          [34mT:[39m 0:11:18
 [34mtrain[39m   [34mE:[39m 44           [34mI:[39m 4,500        [34mR:[39m 78.1         [34mS:[39m 0.0          [34mT:[39m 0:11:34
 [34mtrain[39m   [34mE:[39m 45           [34mI:[39m 4,600        [34mR:[39m 74.4         [34mS:[39m 0.0          [34mT:[39m 0:11:51
 [34mtrain[39m   [34mE:[39m 46           [34mI:[39m 4,700        [34mR:[39m 82.6         [34mS:[39m 0.0          [34mT:[39m 0:12:08
 [34mtrain[39m   [34mE:[39m 47           [34mI:[39m 4,800        [34mR:[39m 82.7         [34mS:[39m 0.0          [34mT:[39m 0:12:24
 [34mtrain[39m   [34mE:[39m 48           [34mI:[39m 4,900        [34mR:[39m 87.0         [34mS:[39m 0.0          [34mT:[39m 0:12:41
 [34mtrain[39m   [34mE:[39m 49           [34mI:[39m 5,000        [34mR:[39m 87.0         [34mS:[39m 0.0          [34mT:[39m 0:12:57
[TIME] encode:    6.64 ms
[TIME] td_target:    5.24 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   23.99 ms
[TIME] compute Q:   23.60 ms
[TIME] reward loss:    0.78 ms
[TIME] value loss:    0.94 ms
[TIME] backward:   34.38 ms
[TIME] grad clipping:    1.59 ms
[TIME] optim.step:    1.19 ms
[TIME] _update total:   99.37 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         1.87%       1.805ms        36.82%      35.561ms       5.080ms       0.000us         0.00%      25.686ms       3.669ms             7
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      23.265ms       120.45%      23.265ms      23.265ms             1
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      20.685ms       107.09%      20.685ms       4.137ms             5
                             MooreExpertsModule_forward         0.36%     348.310us        22.10%      21.343ms       4.269ms       0.000us         0.00%      16.753ms       3.351ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      13.310ms        68.91%      13.310ms      13.310ms             1
                                              aten::bmm         0.15%     144.051us        12.97%      12.527ms     782.934us       6.119ms        31.68%      11.634ms     727.108us            16
                                            aten::copy_         0.39%     379.446us        28.27%      27.303ms     175.020us      10.794ms        55.88%      10.794ms      69.195us           156
                             WorldModel_core_vectorized         0.05%      45.201us        14.08%      13.595ms      13.595ms       0.000us         0.00%       8.194ms       8.194ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.643ms        34.39%       6.643ms     301.969us            22
                                           aten::repeat         0.08%      73.183us         7.48%       7.224ms     722.409us       0.000us         0.00%       6.601ms     660.139us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 96.570ms
Self CUDA time total: 19.316ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 50           [34mI:[39m 5,100        [34mR:[39m 85.0         [34mS:[39m 0.0          [34mT:[39m 0:13:19
 [34mtrain[39m   [34mE:[39m 51           [34mI:[39m 5,200        [34mR:[39m 100.2        [34mS:[39m 0.0          [34mT:[39m 0:13:40
 [34mtrain[39m   [34mE:[39m 52           [34mI:[39m 5,300        [34mR:[39m 81.3         [34mS:[39m 0.0          [34mT:[39m 0:13:57
 [34mtrain[39m   [34mE:[39m 53           [34mI:[39m 5,400        [34mR:[39m 74.7         [34mS:[39m 0.0          [34mT:[39m 0:14:14
 [34mtrain[39m   [34mE:[39m 54           [34mI:[39m 5,500        [34mR:[39m 74.0         [34mS:[39m 0.0          [34mT:[39m 0:14:29
 [34mtrain[39m   [34mE:[39m 55           [34mI:[39m 5,600        [34mR:[39m 80.0         [34mS:[39m 0.0          [34mT:[39m 0:14:45
 [34mtrain[39m   [34mE:[39m 56           [34mI:[39m 5,700        [34mR:[39m 89.8         [34mS:[39m 0.0          [34mT:[39m 0:15:00
 [34mtrain[39m   [34mE:[39m 57           [34mI:[39m 5,800        [34mR:[39m 74.0         [34mS:[39m 0.0          [34mT:[39m 0:15:15
 [34mtrain[39m   [34mE:[39m 58           [34mI:[39m 5,900        [34mR:[39m 69.3         [34mS:[39m 0.0          [34mT:[39m 0:15:30
 [34mtrain[39m   [34mE:[39m 59           [34mI:[39m 6,000        [34mR:[39m 66.1         [34mS:[39m 0.0          [34mT:[39m 0:15:46
[TIME] encode:    9.02 ms
[TIME] td_target:    8.20 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   45.62 ms
[TIME] compute Q:   15.64 ms
[TIME] reward loss:    0.41 ms
[TIME] value loss:    0.42 ms
[TIME] backward:   73.09 ms
[TIME] grad clipping:    2.80 ms
[TIME] optim.step:    2.47 ms
[TIME] _update total:  158.65 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      29.616ms       150.22%      29.616ms      29.616ms             1
                                     CheckpointFunction         1.15%       1.792ms        40.27%      62.752ms       8.965ms       0.000us         0.00%      26.527ms       3.790ms             7
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      24.193ms       122.71%      24.193ms       4.839ms             5
                             MooreExpertsModule_forward         0.20%     317.923us        15.85%      24.696ms       4.939ms       0.000us         0.00%      17.106ms       3.421ms             5
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      15.290ms        77.55%      15.290ms      15.290ms             1
                                              aten::bmm         0.09%     144.615us         9.68%      15.086ms     942.864us       6.348ms        32.20%      11.818ms     738.643us            16
                                            aten::copy_         0.25%     385.306us        20.89%      32.557ms     208.698us      10.926ms        55.42%      10.926ms      70.036us           156
                             WorldModel_core_vectorized         0.03%      40.504us        20.59%      32.080ms      32.080ms       0.000us         0.00%       8.119ms       8.119ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.790ms        34.44%       6.790ms     308.618us            22
                                           aten::repeat         0.05%      72.460us         4.82%       7.516ms     751.590us       0.000us         0.00%       6.748ms     674.761us            10
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 155.832ms
Self CUDA time total: 19.715ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 60           [34mI:[39m 6,100        [34mR:[39m 90.2         [34mS:[39m 0.0          [34mT:[39m 0:16:02
 [34mtrain[39m   [34mE:[39m 61           [34mI:[39m 6,200        [34mR:[39m 86.4         [34mS:[39m 0.0          [34mT:[39m 0:16:18
 [34mtrain[39m   [34mE:[39m 62           [34mI:[39m 6,300        [34mR:[39m 72.6         [34mS:[39m 0.0          [34mT:[39m 0:16:33
 [34mtrain[39m   [34mE:[39m 63           [34mI:[39m 6,400        [34mR:[39m 84.1         [34mS:[39m 0.0          [34mT:[39m 0:16:50
 [34mtrain[39m   [34mE:[39m 64           [34mI:[39m 6,500        [34mR:[39m 84.5         [34mS:[39m 0.0          [34mT:[39m 0:17:06
 [34mtrain[39m   [34mE:[39m 65           [34mI:[39m 6,600        [34mR:[39m 71.7         [34mS:[39m 0.0          [34mT:[39m 0:17:22
 [34mtrain[39m   [34mE:[39m 66           [34mI:[39m 6,700        [34mR:[39m 81.2         [34mS:[39m 0.0          [34mT:[39m 0:17:38
 [34mtrain[39m   [34mE:[39m 67           [34mI:[39m 6,800        [34mR:[39m 78.5         [34mS:[39m 0.0          [34mT:[39m 0:17:54
 [34mtrain[39m   [34mE:[39m 68           [34mI:[39m 6,900        [34mR:[39m 83.6         [34mS:[39m 0.0          [34mT:[39m 0:18:11
 [34mtrain[39m   [34mE:[39m 69           [34mI:[39m 7,000        [34mR:[39m 69.7         [34mS:[39m 0.0          [34mT:[39m 0:18:30
[TIME] encode:   24.05 ms
[TIME] td_target:   16.08 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   48.09 ms
[TIME] compute Q:   12.49 ms
[TIME] reward loss:    0.13 ms
[TIME] value loss:    0.16 ms
[TIME] backward:   16.97 ms
[TIME] grad clipping:   13.00 ms
[TIME] optim.step:   12.62 ms
[TIME] _update total:  144.75 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      33.198ms       166.06%      33.198ms       6.640ms             5
                             WorldModel_core_vectorized         0.00%       0.000us         0.00%       0.000us       0.000us      30.485ms       152.49%      30.485ms      30.485ms             1
                                     CheckpointFunction        14.92%      18.212ms        70.96%      86.588ms      12.370ms       0.000us         0.00%      27.198ms       3.885ms             7
                             MooreExpertsModule_forward         2.00%       2.445ms        27.69%      33.789ms       6.758ms       0.000us         0.00%      17.422ms       3.484ms             5
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      12.177ms        60.91%      12.177ms      12.177ms             1
                                              aten::bmm         1.89%       2.310ms        14.13%      17.241ms       1.078ms       6.634ms        33.18%      12.080ms     754.970us            16
                                            aten::copy_         0.32%     385.668us        15.97%      19.492ms     124.951us      10.937ms        54.71%      10.937ms      70.110us           156
                               Optimizer.step#Adam.step         0.00%       0.000us         0.00%       0.000us       0.000us       9.707ms        48.56%       9.707ms       9.707ms             1
                             WorldModel_core_vectorized         0.04%      52.909us        26.97%      32.906ms      32.906ms       0.000us         0.00%       8.050ms       8.050ms             1
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       6.804ms        34.03%       6.804ms     309.279us            22
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 122.030ms
Self CUDA time total: 19.992ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 70           [34mI:[39m 7,100        [34mR:[39m 87.2         [34mS:[39m 0.0          [34mT:[39m 0:18:50
 [34mtrain[39m   [34mE:[39m 71           [34mI:[39m 7,200        [34mR:[39m 74.7         [34mS:[39m 0.0          [34mT:[39m 0:19:11
 [34mtrain[39m   [34mE:[39m 72           [34mI:[39m 7,300        [34mR:[39m 79.8         [34mS:[39m 0.0          [34mT:[39m 0:19:31
 [34mtrain[39m   [34mE:[39m 73           [34mI:[39m 7,400        [34mR:[39m 82.8         [34mS:[39m 0.0          [34mT:[39m 0:19:48
 [34mtrain[39m   [34mE:[39m 74           [34mI:[39m 7,500        [34mR:[39m 75.9         [34mS:[39m 0.0          [34mT:[39m 0:20:03
 [34mtrain[39m   [34mE:[39m 75           [34mI:[39m 7,600        [34mR:[39m 81.3         [34mS:[39m 0.0          [34mT:[39m 0:20:19
 [34mtrain[39m   [34mE:[39m 76           [34mI:[39m 7,700        [34mR:[39m 77.5         [34mS:[39m 0.0          [34mT:[39m 0:20:34
 [34mtrain[39m   [34mE:[39m 77           [34mI:[39m 7,800        [34mR:[39m 80.5         [34mS:[39m 0.0          [34mT:[39m 0:20:48
 [34mtrain[39m   [34mE:[39m 78           [34mI:[39m 7,900        [34mR:[39m 85.0         [34mS:[39m 0.0          [34mT:[39m 0:21:02
Traceback (most recent call last):
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 165, in <module>
    train()
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 119, in run
    ret = run_job(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 145, in train
    trainer.train()
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/TDMPC2/algorithms/trainer/online_trainer.py", line 126, in train
    _train_metrics = self.agent.update(self.buffer)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore.py", line 78, in _patched_update
    return self._update(obs, action, reward, task=task)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/profiler.py", line 28, in wrapper
    result = func(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/utils/timer.py", line 94, in wrapper
    result = f(*args, **kwargs)
  File "/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/train_moore_agent.py", line 912, in _update
    value_loss = F.mse_loss(q_value, td_target)
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/_tensor.py", line 624, in backward
    torch.autograd.backward(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/__init__.py", line 347, in backward
    _engine_run_backward(
  File "/home/levi/anaconda3/envs/tdmpc2/lib/python3.9/site-packages/torch/autograd/graph.py", line 825, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt