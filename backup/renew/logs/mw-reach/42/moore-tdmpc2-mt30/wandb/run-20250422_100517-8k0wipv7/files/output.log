[34m[1mLogs will be synced with wandb.
Config(env_type='MooreMultiTask', n_contexts=1, obs_dim=39, action_dim=4, hidden_dim=256, n_experts=4, moore_temperature=1.0, use_softmax=True, use_checkpoint=True, use_mixed_precision=True, gamma=0.99, stddev=0.1, actor_updates=1, use_ema=True, ensemble_size=5, update_freq=2, seed=42, device=device(type='cuda', index=0), task='mw-reach', obs='state', multitask=False, steps=10000, batch_size=256, reward_coef=0.1, value_coef=0.1, consistency_coef=20, rho=0.5, lr=0.0003, enc_lr_scale=0.3, grad_clip_norm=20, tau=0.01, discount_denom=5, discount_min=0.95, discount_max=0.995, buffer_size=100000, exp_name='moore-tdmpc2-mt30', eval_freq=50000, eval_episodes=10, moore={'n_experts': 4, 'temperature': 1.0, 'use_softmax': True, 'debug_task_emb': False}, mpc=True, iterations=6, num_samples=512, num_elites=64, num_pi_trajs=24, horizon=3, min_std=0.05, max_std=2, temperature=0.5, log_std_min=-10, log_std_max=2, entropy_coef=0.0001, model_size=5, num_enc_layers=2, enc_dim=256, num_channels=32, mlp_dim=512, latent_dim=512, task_dim=0, num_q=5, dropout=0.01, simnorm_dim=8, num_bins=101, vmin=-10, vmax=10, wandb_project='moore-tdmpc2', wandb_entity='OA-MBRL', wandb_silent=False, enable_wandb=True, save_csv=True, save_video=False, save_agent=True, compile=False, work_dir=PosixPath('/home/levi/Documents/MOORE-TDMPC/moore_tdmpc/logs/mw-reach/42/moore-tdmpc2-mt30'), task_title='Mw Reach', tasks=['mw-reach'], obs_shape={'state': (39,)}, episode_length=100, obs_shapes='???', episode_lengths='???', seed_steps=1000, bin_size=0.2, data_dir='/media/levi/Singe4linux/Moore-TDMPC/TDMPC2/data/mt30')
Architecture: TD-MPC2 Moore World Model
Task Encoder: MooreTaskEncoder(obs_dim=39, latent_dim=512, hidden_dim=256, n_experts=4, temperature=1.0, use_softmax=True)
Dynamics: MoEDynamicsModel(latent_dim=512, action_dim=4, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, use_mixed_precision=True)
Reward: MoERewardModel(latent_dim=512, action_dim=4, hidden_dim=256, n_experts=4, temperature=0.5, use_softmax=True, reward_dim=101, top_k=1)
Policy prior: Sequential(
  (0): Linear(in_features=512, out_features=256, bias=True)
  (1): ReLU()
  (2): Linear(in_features=256, out_features=256, bias=True)
  (3): ReLU()
  (4): Linear(in_features=256, out_features=8, bias=True)
)
Q-functions: Ensemble(n_models=5)
Learnable parameters: 5,217,221
[32m[1må¼€å§‹Moore-TDMPC2è®­ç»ƒ...
[36mPROFILER STATUS: Enabled=True, Functions=3, Total Calls=7
[32mOnlineTrainer: Starting training loop with profiling enabled
[36mPROFILER STATUS: Enabled=True, Functions=3, Total Calls=7
[36mPROFILER: forward executed in 1.10ms (call 3)
 [32meval[39m    [34mE:[39m 0            [34mI:[39m 0            [34mR:[39m 242.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 0            [34mI:[39m 100          [34mR:[39m 364.9        [34mS:[39m 0.0          [34mT:[39m 0:00:01
Buffer capacity: 10,000
Storage required: 0.00 GB
Using CUDA:0 memory for storage.
 [34mtrain[39m   [34mE:[39m 1            [34mI:[39m 200          [34mR:[39m 315.7        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 2            [34mI:[39m 300          [34mR:[39m 605.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 3            [34mI:[39m 400          [34mR:[39m 347.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 4            [34mI:[39m 500          [34mR:[39m 319.2        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 5            [34mI:[39m 600          [34mR:[39m 274.8        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 6            [34mI:[39m 700          [34mR:[39m 276.7        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 7            [34mI:[39m 800          [34mR:[39m 190.2        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 8            [34mI:[39m 900          [34mR:[39m 547.0        [34mS:[39m 0.0          [34mT:[39m 0:00:01
 [34mtrain[39m   [34mE:[39m 9            [34mI:[39m 1,000        [34mR:[39m 361.1        [34mS:[39m 0.0          [34mT:[39m 0:00:01
Pretraining agent on seed data...
[36mPROFILER: _td_target executed in 0.08ms (call 1)
[36mPROFILER: _update executed in 840.80ms (call 1)
[36mPROFILER: _td_target executed in 0.06ms (call 2)
[36mPROFILER: _update executed in 78.42ms (call 2)
[36mPROFILER: _td_target executed in 0.06ms (call 3)
[36mPROFILER: _update executed in 78.16ms (call 3)
[TIME] encode:    6.72 ms
[TIME] td_target:    4.75 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   14.06 ms
[TIME] compute Q:    7.88 ms
[TIME] reward loss:    6.79 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.99 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    1.05 ms
[TIME] _update total:   52.98 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.78%       2.412ms        63.95%      32.253ms       2.688ms       0.000us         0.00%      21.518ms       1.793ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.039ms        59.40%       9.039ms       4.520ms             2
                             MooreExpertsModule_forward         0.24%     120.281us        18.14%       9.148ms       4.574ms       0.000us         0.00%       8.716ms       4.358ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.616ms        50.05%       7.616ms       7.616ms             1
                                              aten::bmm         0.33%     165.645us        14.25%       7.185ms     449.082us       6.775ms        44.52%       6.794ms     424.596us            16
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       5.573ms        36.62%       5.573ms       1.858ms             3
                                            aten::copy_         0.57%     286.216us        10.84%       5.465ms      44.791us       4.354ms        28.61%       4.354ms      35.689us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.160ms        27.34%       4.160ms     320.003us            13
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.140ms        27.20%       4.140ms       2.070ms             2
                                           aten::repeat         0.04%      20.021us         8.35%       4.212ms       1.053ms       0.000us         0.00%       4.125ms       1.031ms             4
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.432ms
Self CUDA time total: 15.218ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 10           [34mI:[39m 1,100        [34mR:[39m 49.1         [34mS:[39m 0.0          [34mT:[39m 0:01:36
 [34mtrain[39m   [34mE:[39m 11           [34mI:[39m 1,200        [34mR:[39m 57.0         [34mS:[39m 0.0          [34mT:[39m 0:01:45
 [34mtrain[39m   [34mE:[39m 12           [34mI:[39m 1,300        [34mR:[39m 54.8         [34mS:[39m 0.0          [34mT:[39m 0:01:54
 [34mtrain[39m   [34mE:[39m 13           [34mI:[39m 1,400        [34mR:[39m 72.4         [34mS:[39m 0.0          [34mT:[39m 0:02:03
 [34mtrain[39m   [34mE:[39m 14           [34mI:[39m 1,500        [34mR:[39m 57.6         [34mS:[39m 0.0          [34mT:[39m 0:02:11
 [34mtrain[39m   [34mE:[39m 15           [34mI:[39m 1,600        [34mR:[39m 79.0         [34mS:[39m 0.0          [34mT:[39m 0:02:20
 [34mtrain[39m   [34mE:[39m 16           [34mI:[39m 1,700        [34mR:[39m 64.7         [34mS:[39m 0.0          [34mT:[39m 0:02:29
 [34mtrain[39m   [34mE:[39m 17           [34mI:[39m 1,800        [34mR:[39m 77.7         [34mS:[39m 0.0          [34mT:[39m 0:02:38
 [34mtrain[39m   [34mE:[39m 18           [34mI:[39m 1,900        [34mR:[39m 61.8         [34mS:[39m 0.0          [34mT:[39m 0:02:46
 [34mtrain[39m   [34mE:[39m 19           [34mI:[39m 2,000        [34mR:[39m 44.5         [34mS:[39m 0.0          [34mT:[39m 0:02:57
[TIME] encode:    7.06 ms
[TIME] td_target:    5.24 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.49 ms
[TIME] compute Q:    7.88 ms
[TIME] reward loss:    4.14 ms
[TIME] value loss:    0.20 ms
[TIME] backward:    9.64 ms
[TIME] grad clipping:    0.76 ms
[TIME] optim.step:    3.38 ms
[TIME] _update total:   52.64 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.89%       2.447ms        61.63%      30.828ms       2.569ms       0.000us         0.00%      22.202ms       1.850ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.396ms        60.40%       9.396ms       4.698ms             2
                             MooreExpertsModule_forward         0.24%     122.270us        19.16%       9.585ms       4.793ms       0.000us         0.00%       9.058ms       4.529ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.604ms        48.88%       7.604ms       7.604ms             1
                                              aten::bmm         0.32%     161.013us        14.37%       7.188ms     449.275us       6.750ms        43.39%       6.769ms     423.039us            16
                                            aten::copy_         0.62%     310.698us        15.27%       7.638ms      62.610us       4.740ms        30.47%       4.740ms      38.849us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.545ms        29.22%       4.545ms     349.577us            13
                                           aten::repeat         0.04%      19.609us         9.20%       4.604ms       1.151ms       0.000us         0.00%       4.510ms       1.127ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.145ms        26.65%       4.145ms       2.072ms             2
                               Optimizer.step#Adam.step         0.00%       0.000us         0.00%       0.000us       0.000us       3.101ms        19.94%       3.101ms       3.101ms             1
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.024ms
Self CUDA time total: 15.555ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 20           [34mI:[39m 2,100        [34mR:[39m 57.7         [34mS:[39m 0.0          [34mT:[39m 0:03:08
 [34mtrain[39m   [34mE:[39m 21           [34mI:[39m 2,200        [34mR:[39m 46.5         [34mS:[39m 0.0          [34mT:[39m 0:03:18
 [34mtrain[39m   [34mE:[39m 22           [34mI:[39m 2,300        [34mR:[39m 70.8         [34mS:[39m 0.0          [34mT:[39m 0:03:28
 [34mtrain[39m   [34mE:[39m 23           [34mI:[39m 2,400        [34mR:[39m 69.0         [34mS:[39m 0.0          [34mT:[39m 0:03:37
 [34mtrain[39m   [34mE:[39m 24           [34mI:[39m 2,500        [34mR:[39m 71.7         [34mS:[39m 0.0          [34mT:[39m 0:03:46
 [34mtrain[39m   [34mE:[39m 25           [34mI:[39m 2,600        [34mR:[39m 69.1         [34mS:[39m 0.0          [34mT:[39m 0:03:55
 [34mtrain[39m   [34mE:[39m 26           [34mI:[39m 2,700        [34mR:[39m 62.4         [34mS:[39m 0.0          [34mT:[39m 0:04:04
 [34mtrain[39m   [34mE:[39m 27           [34mI:[39m 2,800        [34mR:[39m 69.9         [34mS:[39m 0.0          [34mT:[39m 0:04:13
 [34mtrain[39m   [34mE:[39m 28           [34mI:[39m 2,900        [34mR:[39m 45.0         [34mS:[39m 0.0          [34mT:[39m 0:04:22
 [34mtrain[39m   [34mE:[39m 29           [34mI:[39m 3,000        [34mR:[39m 72.8         [34mS:[39m 0.0          [34mT:[39m 0:04:30
[TIME] encode:    7.19 ms
[TIME] td_target:    5.39 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.61 ms
[TIME] compute Q:    8.19 ms
[TIME] reward loss:    3.72 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   10.05 ms
[TIME] grad clipping:    2.69 ms
[TIME] optim.step:    1.09 ms
[TIME] _update total:   52.98 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.70%       2.366ms        61.63%      31.018ms       2.585ms       0.000us         0.00%      22.324ms       1.860ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.852ms        63.08%       9.852ms       4.926ms             2
                             MooreExpertsModule_forward         0.24%     120.027us        19.83%       9.980ms       4.990ms       0.000us         0.00%       9.120ms       4.560ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.936ms        50.81%       7.936ms       7.936ms             1
                                              aten::bmm         0.31%     157.097us        14.29%       7.194ms     449.617us       6.807ms        43.58%       6.826ms     426.598us            16
                                            aten::copy_         0.62%     313.879us        14.26%       7.178ms      58.839us       4.744ms        30.38%       4.744ms      38.888us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.550ms        29.13%       4.550ms     349.971us            13
                                           aten::repeat         0.04%      19.235us         9.15%       4.603ms       1.151ms       0.000us         0.00%       4.514ms       1.129ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.154ms        26.60%       4.154ms       2.077ms             2
                             Torch-Compiled Region: 3/0         0.14%      72.194us         9.47%       4.765ms       1.588ms       0.000us         0.00%       2.811ms     936.979us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.333ms
Self CUDA time total: 15.618ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 30           [34mI:[39m 3,100        [34mR:[39m 66.7         [34mS:[39m 0.0          [34mT:[39m 0:04:39
 [34mtrain[39m   [34mE:[39m 31           [34mI:[39m 3,200        [34mR:[39m 70.8         [34mS:[39m 0.0          [34mT:[39m 0:04:48
 [34mtrain[39m   [34mE:[39m 32           [34mI:[39m 3,300        [34mR:[39m 71.2         [34mS:[39m 0.0          [34mT:[39m 0:04:57
 [34mtrain[39m   [34mE:[39m 33           [34mI:[39m 3,400        [34mR:[39m 74.4         [34mS:[39m 0.0          [34mT:[39m 0:05:06
 [34mtrain[39m   [34mE:[39m 34           [34mI:[39m 3,500        [34mR:[39m 82.2         [34mS:[39m 0.0          [34mT:[39m 0:05:15
 [34mtrain[39m   [34mE:[39m 35           [34mI:[39m 3,600        [34mR:[39m 55.9         [34mS:[39m 0.0          [34mT:[39m 0:05:23
 [34mtrain[39m   [34mE:[39m 36           [34mI:[39m 3,700        [34mR:[39m 66.5         [34mS:[39m 0.0          [34mT:[39m 0:05:35
 [34mtrain[39m   [34mE:[39m 37           [34mI:[39m 3,800        [34mR:[39m 75.7         [34mS:[39m 0.0          [34mT:[39m 0:05:46
 [34mtrain[39m   [34mE:[39m 38           [34mI:[39m 3,900        [34mR:[39m 64.5         [34mS:[39m 0.0          [34mT:[39m 0:05:57
 [34mtrain[39m   [34mE:[39m 39           [34mI:[39m 4,000        [34mR:[39m 73.9         [34mS:[39m 0.0          [34mT:[39m 0:06:08
[TIME] encode:    7.58 ms
[TIME] td_target:    4.77 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   14.17 ms
[TIME] compute Q:    8.14 ms
[TIME] reward loss:    3.93 ms
[TIME] value loss:    0.21 ms
[TIME] backward:   11.78 ms
[TIME] grad clipping:    0.85 ms
[TIME] optim.step:    1.51 ms
[TIME] _update total:   53.80 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.76%       2.437ms        61.27%      31.333ms       2.611ms       0.000us         0.00%      22.699ms       1.892ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.883ms        62.50%       9.883ms       4.942ms             2
                             MooreExpertsModule_forward         0.24%     122.991us        19.55%       9.997ms       4.998ms       0.000us         0.00%       9.301ms       4.651ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.870ms        49.77%       7.870ms       7.870ms             1
                                              aten::bmm         0.33%     166.965us        15.23%       7.789ms     486.789us       7.145ms        45.19%       7.164ms     447.772us            16
                                            aten::copy_         0.58%     297.584us        12.76%       6.525ms      53.482us       4.575ms        28.93%       4.575ms      37.499us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.505ms        28.49%       4.505ms       2.253ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.380ms        27.70%       4.380ms     336.907us            13
                                           aten::repeat         0.09%      45.102us         8.73%       4.462ms       1.116ms       0.000us         0.00%       4.345ms       1.086ms             4
                             Torch-Compiled Region: 3/0         0.13%      68.265us        10.16%       5.197ms       1.732ms       0.000us         0.00%       2.813ms     937.603us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 51.139ms
Self CUDA time total: 15.813ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 40           [34mI:[39m 4,100        [34mR:[39m 80.1         [34mS:[39m 0.0          [34mT:[39m 0:06:19
 [34mtrain[39m   [34mE:[39m 41           [34mI:[39m 4,200        [34mR:[39m 78.8         [34mS:[39m 0.0          [34mT:[39m 0:06:28
 [34mtrain[39m   [34mE:[39m 42           [34mI:[39m 4,300        [34mR:[39m 72.7         [34mS:[39m 0.0          [34mT:[39m 0:06:38
 [34mtrain[39m   [34mE:[39m 43           [34mI:[39m 4,400        [34mR:[39m 58.6         [34mS:[39m 0.0          [34mT:[39m 0:06:47
 [34mtrain[39m   [34mE:[39m 44           [34mI:[39m 4,500        [34mR:[39m 87.2         [34mS:[39m 0.0          [34mT:[39m 0:06:57
 [34mtrain[39m   [34mE:[39m 45           [34mI:[39m 4,600        [34mR:[39m 89.8         [34mS:[39m 0.0          [34mT:[39m 0:07:06
 [34mtrain[39m   [34mE:[39m 46           [34mI:[39m 4,700        [34mR:[39m 70.3         [34mS:[39m 0.0          [34mT:[39m 0:07:15
 [34mtrain[39m   [34mE:[39m 47           [34mI:[39m 4,800        [34mR:[39m 73.8         [34mS:[39m 0.0          [34mT:[39m 0:07:24
 [34mtrain[39m   [34mE:[39m 48           [34mI:[39m 4,900        [34mR:[39m 69.2         [34mS:[39m 0.0          [34mT:[39m 0:07:33
 [34mtrain[39m   [34mE:[39m 49           [34mI:[39m 5,000        [34mR:[39m 82.6         [34mS:[39m 0.0          [34mT:[39m 0:07:42
[TIME] encode:    7.94 ms
[TIME] td_target:    5.59 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   12.16 ms
[TIME] compute Q:   10.38 ms
[TIME] reward loss:    4.36 ms
[TIME] value loss:    0.18 ms
[TIME] backward:   13.25 ms
[TIME] grad clipping:    1.34 ms
[TIME] optim.step:    1.12 ms
[TIME] _update total:   57.28 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.62%       2.515ms        62.05%      33.811ms       2.818ms       0.000us         0.00%      22.763ms       1.897ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us      10.728ms        67.68%      10.728ms       5.364ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us      10.111ms        63.79%      10.111ms      10.111ms             1
                             MooreExpertsModule_forward         0.27%     147.068us        19.94%      10.864ms       5.432ms       0.000us         0.00%       9.347ms       4.673ms             2
                                              aten::bmm         0.30%     164.779us        14.25%       7.765ms     485.340us       7.194ms        45.38%       7.212ms     450.746us            16
                                            aten::copy_         0.61%     329.920us        15.55%       8.472ms      69.446us       4.576ms        28.87%       4.576ms      37.505us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.551ms        28.72%       4.551ms       2.276ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.377ms        27.62%       4.377ms     336.724us            13
                                           aten::repeat         0.04%      21.926us         8.16%       4.448ms       1.112ms       0.000us         0.00%       4.344ms       1.086ms             4
                                      WorldModel_reward         0.00%       0.000us         0.00%       0.000us       0.000us       3.197ms        20.17%       3.197ms       1.066ms             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 54.489ms
Self CUDA time total: 15.850ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 50           [34mI:[39m 5,100        [34mR:[39m 63.3         [34mS:[39m 0.0          [34mT:[39m 0:07:51
 [34mtrain[39m   [34mE:[39m 51           [34mI:[39m 5,200        [34mR:[39m 58.7         [34mS:[39m 0.0          [34mT:[39m 0:08:00
 [34mtrain[39m   [34mE:[39m 52           [34mI:[39m 5,300        [34mR:[39m 59.7         [34mS:[39m 0.0          [34mT:[39m 0:08:12
 [34mtrain[39m   [34mE:[39m 53           [34mI:[39m 5,400        [34mR:[39m 54.7         [34mS:[39m 0.0          [34mT:[39m 0:08:24
 [34mtrain[39m   [34mE:[39m 54           [34mI:[39m 5,500        [34mR:[39m 97.9         [34mS:[39m 0.0          [34mT:[39m 0:08:35
 [34mtrain[39m   [34mE:[39m 55           [34mI:[39m 5,600        [34mR:[39m 82.4         [34mS:[39m 0.0          [34mT:[39m 0:08:46
 [34mtrain[39m   [34mE:[39m 56           [34mI:[39m 5,700        [34mR:[39m 58.5         [34mS:[39m 0.0          [34mT:[39m 0:08:56
 [34mtrain[39m   [34mE:[39m 57           [34mI:[39m 5,800        [34mR:[39m 51.8         [34mS:[39m 0.0          [34mT:[39m 0:09:06
 [34mtrain[39m   [34mE:[39m 58           [34mI:[39m 5,900        [34mR:[39m 81.3         [34mS:[39m 0.0          [34mT:[39m 0:09:15
 [34mtrain[39m   [34mE:[39m 59           [34mI:[39m 6,000        [34mR:[39m 67.6         [34mS:[39m 0.0          [34mT:[39m 0:09:24
[TIME] encode:    7.40 ms
[TIME] td_target:    5.28 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.25 ms
[TIME] compute Q:    8.43 ms
[TIME] reward loss:    3.76 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   10.20 ms
[TIME] grad clipping:    2.53 ms
[TIME] optim.step:    1.06 ms
[TIME] _update total:   52.94 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.99%       2.513ms        61.78%      31.135ms       2.595ms       0.000us         0.00%      22.461ms       1.872ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.818ms        62.55%       9.818ms       4.909ms             2
                             MooreExpertsModule_forward         0.27%     133.816us        19.73%       9.945ms       4.972ms       0.000us         0.00%       9.186ms       4.593ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       8.157ms        51.97%       8.157ms       8.157ms             1
                                              aten::bmm         0.32%     158.926us        14.81%       7.463ms     466.413us       6.764ms        43.09%       6.782ms     423.904us            16
                                            aten::copy_         0.59%     296.410us        18.51%       9.327ms      76.453us       4.844ms        30.86%       4.844ms      39.703us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.649ms        29.62%       4.649ms     357.621us            13
                                           aten::repeat         0.04%      20.343us         9.35%       4.711ms       1.178ms       0.000us         0.00%       4.616ms       1.154ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.120ms        26.25%       4.120ms       2.060ms             2
                             Torch-Compiled Region: 3/0         0.14%      68.088us         9.52%       4.796ms       1.599ms       0.000us         0.00%       2.812ms     937.451us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 50.396ms
Self CUDA time total: 15.697ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 60           [34mI:[39m 6,100        [34mR:[39m 48.7         [34mS:[39m 0.0          [34mT:[39m 0:09:33
 [34mtrain[39m   [34mE:[39m 61           [34mI:[39m 6,200        [34mR:[39m 51.1         [34mS:[39m 0.0          [34mT:[39m 0:09:42
 [34mtrain[39m   [34mE:[39m 62           [34mI:[39m 6,300        [34mR:[39m 62.6         [34mS:[39m 0.0          [34mT:[39m 0:09:51
 [34mtrain[39m   [34mE:[39m 63           [34mI:[39m 6,400        [34mR:[39m 72.6         [34mS:[39m 0.0          [34mT:[39m 0:10:00
 [34mtrain[39m   [34mE:[39m 64           [34mI:[39m 6,500        [34mR:[39m 61.1         [34mS:[39m 0.0          [34mT:[39m 0:10:09
 [34mtrain[39m   [34mE:[39m 65           [34mI:[39m 6,600        [34mR:[39m 70.1         [34mS:[39m 0.0          [34mT:[39m 0:10:18
 [34mtrain[39m   [34mE:[39m 66           [34mI:[39m 6,700        [34mR:[39m 78.2         [34mS:[39m 0.0          [34mT:[39m 0:10:27
 [34mtrain[39m   [34mE:[39m 67           [34mI:[39m 6,800        [34mR:[39m 54.1         [34mS:[39m 0.0          [34mT:[39m 0:10:36
 [34mtrain[39m   [34mE:[39m 68           [34mI:[39m 6,900        [34mR:[39m 75.8         [34mS:[39m 0.0          [34mT:[39m 0:10:45
 [34mtrain[39m   [34mE:[39m 69           [34mI:[39m 7,000        [34mR:[39m 95.2         [34mS:[39m 0.0          [34mT:[39m 0:10:54
[TIME] encode:    7.02 ms
[TIME] td_target:    4.90 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.40 ms
[TIME] compute Q:    8.11 ms
[TIME] reward loss:    3.66 ms
[TIME] value loss:    0.19 ms
[TIME] backward:    9.67 ms
[TIME] grad clipping:    0.77 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   49.64 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.39%       2.542ms        64.04%      30.173ms       2.514ms       0.000us         0.00%      22.400ms       1.867ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.487ms        60.65%       9.487ms       4.743ms             2
                             MooreExpertsModule_forward         0.26%     120.386us        20.38%       9.601ms       4.801ms       0.000us         0.00%       9.158ms       4.579ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.829ms        50.05%       7.829ms       7.829ms             1
                                              aten::bmm         0.34%     160.611us        15.26%       7.192ms     449.504us       6.807ms        43.52%       6.826ms     426.599us            16
                                            aten::copy_         0.61%     289.518us        12.21%       5.751ms      47.137us       4.791ms        30.63%       4.791ms      39.272us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.596ms        29.39%       4.596ms     353.573us            13
                                           aten::repeat         0.04%      19.583us         9.87%       4.652ms       1.163ms       0.000us         0.00%       4.563ms       1.141ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.144ms        26.50%       4.144ms       2.072ms             2
                             Torch-Compiled Region: 3/0         0.24%     111.165us        10.58%       4.986ms       1.662ms       0.000us         0.00%       2.812ms     937.409us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 47.117ms
Self CUDA time total: 15.642ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 70           [34mI:[39m 7,100        [34mR:[39m 63.8         [34mS:[39m 0.0          [34mT:[39m 0:11:08
 [34mtrain[39m   [34mE:[39m 71           [34mI:[39m 7,200        [34mR:[39m 68.6         [34mS:[39m 0.0          [34mT:[39m 0:11:20
 [34mtrain[39m   [34mE:[39m 72           [34mI:[39m 7,300        [34mR:[39m 88.0         [34mS:[39m 0.0          [34mT:[39m 0:11:32
 [34mtrain[39m   [34mE:[39m 73           [34mI:[39m 7,400        [34mR:[39m 73.1         [34mS:[39m 0.0          [34mT:[39m 0:11:44
 [34mtrain[39m   [34mE:[39m 74           [34mI:[39m 7,500        [34mR:[39m 74.8         [34mS:[39m 0.0          [34mT:[39m 0:11:54
 [34mtrain[39m   [34mE:[39m 75           [34mI:[39m 7,600        [34mR:[39m 65.6         [34mS:[39m 0.0          [34mT:[39m 0:12:04
 [34mtrain[39m   [34mE:[39m 76           [34mI:[39m 7,700        [34mR:[39m 78.0         [34mS:[39m 0.0          [34mT:[39m 0:12:13
 [34mtrain[39m   [34mE:[39m 77           [34mI:[39m 7,800        [34mR:[39m 74.4         [34mS:[39m 0.0          [34mT:[39m 0:12:22
 [34mtrain[39m   [34mE:[39m 78           [34mI:[39m 7,900        [34mR:[39m 75.7         [34mS:[39m 0.0          [34mT:[39m 0:12:32
 [34mtrain[39m   [34mE:[39m 79           [34mI:[39m 8,000        [34mR:[39m 69.2         [34mS:[39m 0.0          [34mT:[39m 0:12:41
[TIME] encode:    6.87 ms
[TIME] td_target:    4.84 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.30 ms
[TIME] compute Q:    8.07 ms
[TIME] reward loss:    3.59 ms
[TIME] value loss:    0.20 ms
[TIME] backward:    9.73 ms
[TIME] grad clipping:    0.72 ms
[TIME] optim.step:    1.31 ms
[TIME] _update total:   49.48 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.06%       2.371ms        63.51%      29.772ms       2.481ms       0.000us         0.00%      22.051ms       1.838ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.339ms        60.29%       9.339ms       4.670ms             2
                             MooreExpertsModule_forward         0.29%     136.449us        20.16%       9.453ms       4.727ms       0.000us         0.00%       8.963ms       4.482ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.822ms        50.50%       7.822ms       7.822ms             1
                                              aten::bmm         0.45%     210.149us        15.37%       7.208ms     450.482us       6.758ms        43.63%       6.776ms     423.501us            16
                                            aten::copy_         0.61%     285.829us        16.22%       7.605ms      62.340us       4.616ms        29.80%       4.616ms      37.834us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.420ms        28.54%       4.420ms     340.023us            13
                                           aten::repeat         0.04%      19.997us         9.56%       4.480ms       1.120ms       0.000us         0.00%       4.387ms       1.097ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.135ms        26.70%       4.135ms       2.068ms             2
                             Torch-Compiled Region: 3/0         0.14%      66.621us        10.66%       4.998ms       1.666ms       0.000us         0.00%       2.851ms     950.354us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 46.882ms
Self CUDA time total: 15.490ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 80           [34mI:[39m 8,100        [34mR:[39m 56.8         [34mS:[39m 0.0          [34mT:[39m 0:12:51
 [34mtrain[39m   [34mE:[39m 81           [34mI:[39m 8,200        [34mR:[39m 69.7         [34mS:[39m 0.0          [34mT:[39m 0:12:59
 [34mtrain[39m   [34mE:[39m 82           [34mI:[39m 8,300        [34mR:[39m 68.2         [34mS:[39m 0.0          [34mT:[39m 0:13:10
 [34mtrain[39m   [34mE:[39m 83           [34mI:[39m 8,400        [34mR:[39m 75.1         [34mS:[39m 0.0          [34mT:[39m 0:13:18
 [34mtrain[39m   [34mE:[39m 84           [34mI:[39m 8,500        [34mR:[39m 55.6         [34mS:[39m 0.0          [34mT:[39m 0:13:27
 [34mtrain[39m   [34mE:[39m 85           [34mI:[39m 8,600        [34mR:[39m 54.8         [34mS:[39m 0.0          [34mT:[39m 0:13:36
 [34mtrain[39m   [34mE:[39m 86           [34mI:[39m 8,700        [34mR:[39m 82.5         [34mS:[39m 0.0          [34mT:[39m 0:13:45
 [34mtrain[39m   [34mE:[39m 87           [34mI:[39m 8,800        [34mR:[39m 59.8         [34mS:[39m 0.0          [34mT:[39m 0:13:54
 [34mtrain[39m   [34mE:[39m 88           [34mI:[39m 8,900        [34mR:[39m 75.4         [34mS:[39m 0.0          [34mT:[39m 0:14:02
 [34mtrain[39m   [34mE:[39m 89           [34mI:[39m 9,000        [34mR:[39m 60.9         [34mS:[39m 0.0          [34mT:[39m 0:14:11
[TIME] encode:    6.96 ms
[TIME] td_target:    5.17 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.57 ms
[TIME] compute Q:    8.01 ms
[TIME] reward loss:    3.57 ms
[TIME] value loss:    0.18 ms
[TIME] backward:    9.63 ms
[TIME] grad clipping:    0.70 ms
[TIME] optim.step:    3.06 ms
[TIME] _update total:   51.65 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         4.72%       2.323ms        62.62%      30.834ms       2.570ms       0.000us         0.00%      22.393ms       1.866ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.782ms        62.56%       9.782ms       4.891ms             2
                             MooreExpertsModule_forward         0.25%     123.728us        20.10%       9.894ms       4.947ms       0.000us         0.00%       9.162ms       4.581ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.750ms        49.56%       7.750ms       7.750ms             1
                                              aten::bmm         0.40%     195.582us        14.67%       7.224ms     451.501us       6.794ms        43.46%       6.813ms     425.817us            16
                                            aten::copy_         0.60%     295.060us        11.97%       5.893ms      48.304us       4.791ms        30.64%       4.791ms      39.269us           122
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.597ms        29.40%       4.597ms     353.599us            13
                                           aten::repeat         0.04%      19.227us         9.45%       4.652ms       1.163ms       0.000us         0.00%       4.563ms       1.141ms             4
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.149ms        26.53%       4.149ms       2.074ms             2
                             Torch-Compiled Region: 3/0         0.14%      67.308us        10.65%       5.244ms       1.748ms       0.000us         0.00%       2.797ms     932.455us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.237ms
Self CUDA time total: 15.636ms
----------------------------------------------
 [34mtrain[39m   [34mE:[39m 90           [34mI:[39m 9,100        [34mR:[39m 75.4         [34mS:[39m 0.0          [34mT:[39m 0:14:25
 [34mtrain[39m   [34mE:[39m 91           [34mI:[39m 9,200        [34mR:[39m 63.9         [34mS:[39m 0.0          [34mT:[39m 0:14:39
 [34mtrain[39m   [34mE:[39m 92           [34mI:[39m 9,300        [34mR:[39m 66.1         [34mS:[39m 0.0          [34mT:[39m 0:14:51
 [34mtrain[39m   [34mE:[39m 93           [34mI:[39m 9,400        [34mR:[39m 52.6         [34mS:[39m 0.0          [34mT:[39m 0:15:03
 [34mtrain[39m   [34mE:[39m 94           [34mI:[39m 9,500        [34mR:[39m 82.3         [34mS:[39m 0.0          [34mT:[39m 0:15:15
 [34mtrain[39m   [34mE:[39m 95           [34mI:[39m 9,600        [34mR:[39m 52.7         [34mS:[39m 0.0          [34mT:[39m 0:15:26
 [34mtrain[39m   [34mE:[39m 96           [34mI:[39m 9,700        [34mR:[39m 80.1         [34mS:[39m 0.0          [34mT:[39m 0:15:36
 [34mtrain[39m   [34mE:[39m 97           [34mI:[39m 9,800        [34mR:[39m 53.0         [34mS:[39m 0.0          [34mT:[39m 0:15:45
 [34mtrain[39m   [34mE:[39m 98           [34mI:[39m 9,900        [34mR:[39m 88.3         [34mS:[39m 0.0          [34mT:[39m 0:15:55
 [34mtrain[39m   [34mE:[39m 99           [34mI:[39m 10,000       [34mR:[39m 74.6         [34mS:[39m 0.0          [34mT:[39m 0:16:04
[TIME] encode:    6.83 ms
[TIME] td_target:    5.02 ms
[DEBUG] dynamics_vectorized inputs: z0=torch.Size([256, 512]), action_seq=torch.Size([256, 3, 4])
[DEBUG] Tensor formats: z_roll=torch.Size([256, 3, 512]), all_mu=torch.Size([256, 3, 4])
[TIME] rollout:   13.08 ms
[TIME] compute Q:    8.19 ms
[TIME] reward loss:    3.81 ms
[TIME] value loss:    0.19 ms
[TIME] backward:   11.95 ms
[TIME] grad clipping:    0.87 ms
[TIME] optim.step:    1.13 ms
[TIME] _update total:   51.91 ms
----- Profiler Summary for _update method -----
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                                   Name    Self CPU %      Self CPU   CPU total %     CPU total  CPU time avg     Self CUDA   Self CUDA %    CUDA total  CUDA time avg    # of Calls
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
                                     CheckpointFunction         5.14%       2.527ms        64.09%      31.524ms       2.627ms       0.000us         0.00%      21.623ms       1.802ms            12
                             MooreExpertsModule_forward         0.00%       0.000us         0.00%       0.000us       0.000us       9.275ms        60.81%       9.275ms       4.638ms             2
                             MooreExpertsModule_forward         0.25%     121.159us        19.09%       9.388ms       4.694ms       0.000us         0.00%       8.775ms       4.387ms             2
                                           WorldModel_Q         0.00%       0.000us         0.00%       0.000us       0.000us       7.917ms        51.91%       7.917ms       7.917ms             1
                                              aten::bmm         0.38%     188.886us        14.78%       7.269ms     454.318us       6.834ms        44.80%       6.852ms     428.264us            16
                                            aten::copy_         0.62%     304.642us        11.07%       5.445ms      44.629us       4.352ms        28.54%       4.352ms      35.676us           122
void gemv2N_kernel<int, int, float, float, float, fl...         0.00%       0.000us         0.00%       0.000us       0.000us       4.199ms        27.53%       4.199ms       2.099ms             2
void at::native::elementwise_kernel<128, 2, at::nati...         0.00%       0.000us         0.00%       0.000us       0.000us       4.159ms        27.27%       4.159ms     319.912us            13
                                           aten::repeat         0.04%      20.340us         8.58%       4.220ms       1.055ms       0.000us         0.00%       4.125ms       1.031ms             4
                             Torch-Compiled Region: 3/0         0.14%      70.842us        13.39%       6.588ms       2.196ms       0.000us         0.00%       2.797ms     932.424us             3
-------------------------------------------------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------  ------------
Self CPU time total: 49.189ms
Self CUDA time total: 15.252ms
----------------------------------------------